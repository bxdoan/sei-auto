(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{1129:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1130),t),n(i(1131),t),n(i(517),t),n(i(1132),t),n(i(1133),t),n(i(1134),t)},1130:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1131:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtensionKVStore=void 0;const r=i(517);class n extends r.BaseKVStore{constructor(e){if(n.KVStoreProvider||("undefined"==typeof browser?console.log("You should use ExtensionKVStore on the extension environment."):browser.storage&&browser.storage.local?n.KVStoreProvider={get:browser.storage.local.get,set:browser.storage.local.set}:console.log("The 'browser' exists, but it doesn't seem to be an extension environment. This can happen in Safari browser.")),!n.KVStoreProvider)throw new Error("Can't initialize kv store for browser extension");super(n.KVStoreProvider,e)}}t.ExtensionKVStore=n},1132:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MemoryKVStore=void 0;const r=i(517);class n{constructor(){this.store={}}get(){return Promise.resolve(this.store)}set(e){return this.store=Object.assign(Object.assign({},this.store),e),Promise.resolve()}}class s extends r.BaseKVStore{constructor(e){super(new n,e)}}t.MemoryKVStore=s},1133:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalKVStore=void 0;t.LocalKVStore=class{constructor(e){this._prefix=e}get(e){const t=this.prefix()+"/"+e,i=localStorage.getItem(t);return null===i?Promise.resolve(void 0):Promise.resolve(JSON.parse(i))}set(e,t){const i=this.prefix()+"/"+e;return null===t?Promise.resolve(localStorage.removeItem(i)):Promise.resolve(localStorage.setItem(i,JSON.stringify(t)))}prefix(){return this._prefix}}},1134:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDBKVStore=void 0;t.IndexedDBKVStore=class{constructor(e){this._prefix=e}get(e){return r(this,void 0,void 0,(function*(){const t=(yield this.getDB()).transaction([this.prefix()],"readonly").objectStore(this.prefix());return new Promise((i,r)=>{const n=t.get(e);n.onerror=e=>{e.stopPropagation(),r(e.target)},n.onsuccess=()=>{n.result?i(n.result.data):i(void 0)}})}))}set(e,t){return r(this,void 0,void 0,(function*(){if(null===t){const t=(yield this.getDB()).transaction([this.prefix()],"readwrite").objectStore(this.prefix());return new Promise((i,r)=>{const n=t.delete(e);n.onerror=e=>{e.stopPropagation(),r(e.target)},n.onsuccess=()=>{i()}})}{const i=(yield this.getDB()).transaction([this.prefix()],"readwrite").objectStore(this.prefix());return new Promise((r,n)=>{const s=i.put({key:e,data:t});s.onerror=e=>{e.stopPropagation(),n(e.target)},s.onsuccess=()=>{r()}})}}))}prefix(){return this._prefix}getDB(){return r(this,void 0,void 0,(function*(){return this.cachedDB?this.cachedDB:new Promise((e,t)=>{const i=window.indexedDB.open(this.prefix());i.onerror=e=>{e.stopPropagation(),t(e.target)},i.onupgradeneeded=e=>{e.target.result.createObjectStore(this.prefix(),{keyPath:"key"})},i.onsuccess=()=>{this.cachedDB=i.result,e(i.result)}})}))}}},1135:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DenomHelper=void 0;const r=i(2),n=i(69);t.DenomHelper=class{constructor(e){this._denom=e;const t=this.denom.split(/(\w+):(\w+):(.+)/).filter(Boolean);if(1!==t.length&&3!==t.length)throw new Error("Invalid denom: "+this.denom);this._type=3===t.length?t[0]:"",this._contractAddress=3===t.length?t[1]:""}static ibcDenom(e,t){const i=[];for(const t of e)i.push(`${t.portId}/${t.channelId}`);const s=`${i.join("/")}/${t}`;return"ibc/"+r.Buffer.from(n.Hash.sha256(r.Buffer.from(s))).toString("hex").toUpperCase()}get denom(){return this._denom}get type(){return this._type||"native"}get contractAddress(){return this._contractAddress}}},1136:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Mnemonic=void 0;const n=i(295),s=i(1169),o=i(236),a=i(2);class c{static generateWallet(e,t="m/44'/118'/0'/0/0",i="",n=256){return r(this,void 0,void 0,(function*(){const r=yield c.generateSeed(e,n);return{privKey:c.generateWalletFromMnemonic(r,t,i),mnemonic:r}}))}static validateMnemonic(e){return n.validateMnemonic(e)}static generateSeed(e,t=128){return r(this,void 0,void 0,(function*(){if(t%32!=0)throw new TypeError("invalid entropy");let i=new Uint8Array(t/8);return i=yield e(i),n.entropyToMnemonic(a.Buffer.from(i).toString("hex"))}))}static generateWalletFromMnemonic(e,t="m/44'/118'/0'/0/0",i=""){const r=n.mnemonicToSeedSync(e,i),o=s.fromSeed(r).derivePath(t).privateKey;if(!o)throw new Error("null hd key");return o}static generateMasterSeedFromMnemonic(e,t=""){const i=n.mnemonicToSeedSync(e,t),r=s.fromSeed(i);return a.Buffer.from(o.decode(r.toBase58()))}static generatePrivateKeyFromMasterSeed(e,t="m/44'/118'/0'/0/0"){const i=s.fromBase58(o.encode(e)).derivePath(t).privateKey;if(!i)throw new Error("null hd key");return i}}t.Mnemonic=c},1200:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PubKeySecp256k1=t.PrivKeySecp256k1=void 0;const n=i(237),s=r(i(1201)),o=i(2),a=i(742);class c{constructor(e){this.privKey=e}static generateRandomKey(){const e=new n.ec("secp256k1");return new c(o.Buffer.from(e.genKeyPair().getPrivate().toArray()))}toBytes(){return new Uint8Array(this.privKey)}getPubKey(){const e=new n.ec("secp256k1").keyFromPrivate(this.privKey);return new d(new Uint8Array(e.getPublic().encodeCompressed("array")))}sign(e){return this.signDigest32(a.Hash.sha256(e))}signDigest32(e){if(32!==e.length)throw new Error("Invalid length of digest to sign: "+e.length);const t=new n.ec("secp256k1").keyFromPrivate(this.privKey).sign(e,{canonical:!0});return new Uint8Array(t.r.toArray("be",32).concat(t.s.toArray("be",32)))}}t.PrivKeySecp256k1=c;class d{constructor(e){this.pubKey=e}toBytes(e){if(e){const e=this.toKeyPair();return new Uint8Array(o.Buffer.from(e.getPublic().encode("hex",!1),"hex"))}return new Uint8Array(this.pubKey)}getAddress(){let e=s.default.SHA256(s.default.lib.WordArray.create(this.pubKey)).toString();return e=s.default.RIPEMD160(s.default.enc.Hex.parse(e)).toString(),new Uint8Array(o.Buffer.from(e,"hex"))}getEthAddress(){return a.Hash.keccak256(this.toBytes(!0).slice(1)).slice(-20)}toKeyPair(){return new n.ec("secp256k1").keyFromPublic(o.Buffer.from(this.pubKey).toString("hex"),"hex")}verify(e,t){return this.verifyDigest32(a.Hash.sha256(e),t)}verifyDigest32(e,t){if(32!==e.length)throw new Error("Invalid length of digest to verify: "+e.length);if(64!==t.length)throw new Error("Invalid length of signature: "+t.length);const i=new n.ec("secp256k1"),r=t.slice(0,32),s=t.slice(32);return i.verify(e,{r:o.Buffer.from(r).toString("hex"),s:o.Buffer.from(s).toString("hex")},this.toKeyPair())}}t.PubKeySecp256k1=d},1272:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toGenerator=void 0,t.toGenerator=function*(e){return yield e}},1273:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1274),t)},1274:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Debouncer=void 0;t.Debouncer=class{static promise(e){let t;return(...i)=>r(this,void 0,void 0,(function*(){if(t)return t;try{return t=e.apply(this,i),yield t}finally{t=void 0}}))}}},1275:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unescapeHTML=t.escapeHTML=void 0,t.escapeHTML=function(e){return e.replace(/</g,"\\u003c").replace(/>/g,"\\u003e").replace(/&/g,"\\u0026")},t.unescapeHTML=function(e){return e.replace(/\\u003c/g,"<").replace(/\\u003e/g,">").replace(/\\u0026/g,"&")}},1276:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1277),t)},1277:function(e,t,i){"use strict";function r(e){if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map(r);const t=Object.keys(e).sort(),i={};return t.forEach(t=>{i[t]=r(e[t])}),i}Object.defineProperty(t,"__esModule",{value:!0}),t.sortedJsonByKeyStringify=t.sortObjectByKey=void 0,t.sortObjectByKey=r,t.sortedJsonByKeyStringify=function(e){return JSON.stringify(r(e))}},1278:function(e,t,i){"use strict";function r(e){const t=e.split(".");if(2===t.length&&t[0].length>0&&t[1].length>0)return[t[0],t[1]]}Object.defineProperty(t,"__esModule",{value:!0}),t.validateICNSName=t.parseICNSName=void 0,t.parseICNSName=r,t.validateICNSName=function(e,t){const i=r(e);return!!i&&i[1]===t}},1279:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(743),t),n(i(1280),t)},1280:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(539),n=i(744),s=i(1281);t.init=function(e,t){e.registerMessage(r.SetPersistentMemoryMsg),e.registerMessage(r.GetPersistentMemoryMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1281:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(539);t.getHandler=e=>(t,i)=>{switch(i.constructor){case r.SetPersistentMemoryMsg:return n(e)(t,i);case r.GetPersistentMemoryMsg:return e.get();default:throw new Error("Unknown msg type")}};const n=e=>(t,i)=>(e.set(i.data),{success:!0})},1282:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(745),t),n(i(1339),t)},1283:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAccount=void 0;const n=i(20);class s{constructor(e,t,i,r){this.type=e,this.address=t,this.accountNumber=i,this.sequence=r}static fetchFromRest(e,t,i=!1){return r(this,void 0,void 0,(function*(){const r=yield e.get("/cosmos/auth/v1beta1/accounts/"+t,{validateStatus:function(e){return e>=200&&e<300||404===e}});return s.fromProtoJSON(r.data,i?t:"")}))}static fromProtoJSON(e,t=""){if(!e.account){if(!t)throw new Error("Account's address is unknown: "+JSON.stringify(e));return new s("",t,new n.Int(0),new n.Int(0))}let i=e.account;const r=i["@type"]||"",o=i.BaseAccount||i.baseAccount||i.base_account;o&&(i=o);const a=i.account;a&&(i=a);const c=i.BaseVestingAccount||i.baseVestingAccount||i.base_vesting_account;if(c){i=c;const e=i.BaseAccount||i.baseAccount||i.base_account;e&&(i=e)}let d=i.address;if(!d){if(!t)throw new Error("Account's address is unknown: "+JSON.stringify(e));d=t}const u=i.account_number,h=i.sequence;return new s(r,d,new n.Int(u||"0"),new n.Int(h||"0"))}getType(){return this.type}getAddress(){return this.address}getAccountNumber(){return this.accountNumber}getSequence(){return this.sequence}}t.BaseAccount=s},1287:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(751),t),n(i(1288),t)},1288:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EthermintChainIdHelper=void 0;const r=i(751);t.EthermintChainIdHelper=class{static parse(e){const t=r.ChainIdHelper.parse(e);if(e.startsWith("injective")){return["injective-777","injective-888"].includes(e)?Object.assign({ethChainId:5},t):Object.assign({ethChainId:1},t)}const i=e.match("^([a-z]{1,})_{1}([1-9][0-9]*)-{1}([1-9][0-9]*)$");if(!i||4!==i.length||""===i[1]||Number.isNaN(parseFloat(i[2]))||!Number.isInteger(parseFloat(i[2])))throw new Error("Invalid chainId for ethermint: "+e);return Object.assign(Object.assign({},t),{ethChainId:parseFloat(i[2])})}}},1289:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TendermintTxTracer=void 0;const r=i(1290),n=i(2);t.TendermintTxTracer=class{constructor(e,t,i={}){this.url=e,this.wsEndpoint=t,this.options=i,this.newBlockSubscribes=[],this.txSubscribes=new Map,this.pendingQueries=new Map,this.listeners={},this.onOpen=e=>{var t;this.newBlockSubscribes.length>0&&this.sendSubscribeBlockRpc();for(const[e,t]of this.txSubscribes)this.sendSubscribeTxRpc(e,t.hash);for(const[e,t]of this.pendingQueries)this.sendQueryRpc(e,t.method,t.params);for(const i of null!==(t=this.listeners.open)&&void 0!==t?t:[])i(e)},this.onMessage=e=>{var t,i,r,n,s,o;for(const i of null!==(t=this.listeners.message)&&void 0!==t?t:[])i(e);if(e.data)try{const t=JSON.parse(e.data);if((null==t?void 0:t.id)&&this.pendingQueries.has(t.id)&&(t.error?this.pendingQueries.get(t.id).rejector(new Error(t.error.data||t.error.message)):(null===(i=t.result)||void 0===i?void 0:i.tx_result)?this.pendingQueries.get(t.id).resolver(t.result.tx_result):this.pendingQueries.get(t.id).resolver(t.result),this.pendingQueries.delete(t.id)),"tendermint/event/NewBlock"===(null===(n=null===(r=null==t?void 0:t.result)||void 0===r?void 0:r.data)||void 0===n?void 0:n.type))for(const e of this.newBlockSubscribes)e.handler(t.result.data.value);"tendermint/event/Tx"===(null===(o=null===(s=null==t?void 0:t.result)||void 0===s?void 0:s.data)||void 0===o?void 0:o.type)&&(null==t?void 0:t.id)&&this.txSubscribes.has(t.id)&&(t.error?this.txSubscribes.get(t.id).rejector(new Error(t.error.data||t.error.message)):this.txSubscribes.get(t.id).resolver(t.result.data.value.TxResult.result),this.txSubscribes.delete(t.id))}catch(e){console.log("Tendermint websocket jsonrpc response is not JSON: "+(e.message||e.toString()))}},this.onClose=e=>{var t;for(const i of null!==(t=this.listeners.close)&&void 0!==t?t:[])i(e)},this.ws=this.options.wsObject?new this.options.wsObject(this.getWsEndpoint()):new WebSocket(this.getWsEndpoint()),this.ws.onopen=this.onOpen,this.ws.onmessage=this.onMessage,this.ws.onclose=this.onClose}getWsEndpoint(){let e=this.url;if(e.startsWith("http")&&(e=e.replace("http","ws")),!e.endsWith(this.wsEndpoint)){const t=this.wsEndpoint.startsWith("/")?this.wsEndpoint:"/"+this.wsEndpoint;e=e.endsWith("/")?e+t.slice(1):e+t}return e}close(){this.ws.close()}get readyState(){switch(this.ws.readyState){case 0:return r.WsReadyState.CONNECTING;case 1:return r.WsReadyState.OPEN;case 2:return r.WsReadyState.CLOSING;case 3:return r.WsReadyState.CLOSED;default:return r.WsReadyState.NONE}}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}subscribeBlock(e){this.newBlockSubscribes.push({handler:e}),1===this.newBlockSubscribes.length&&this.sendSubscribeBlockRpc()}sendSubscribeBlockRpc(){this.readyState===r.WsReadyState.OPEN&&this.ws.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe",params:["tm.event='NewBlock'"],id:1}))}traceTx(e){return new Promise(t=>{this.queryTx(e).then(t).catch(()=>{}),this.subscribeTx(e).then(t)}).then(e=>new Promise(t=>{setTimeout(()=>t(e),100)}))}subscribeTx(e){const t=this.createRandomId();return new Promise((i,r)=>{this.txSubscribes.set(t,{hash:e,resolver:i,rejector:r}),this.sendSubscribeTxRpc(t,e)})}sendSubscribeTxRpc(e,t){this.readyState===r.WsReadyState.OPEN&&this.ws.send(JSON.stringify({jsonrpc:"2.0",method:"subscribe",params:[`tm.event='Tx' AND tx.hash='${n.Buffer.from(t).toString("hex").toUpperCase()}'`],id:e}))}queryTx(e){return this.query("tx",[n.Buffer.from(e).toString("base64"),!1])}query(e,t){const i=this.createRandomId();return new Promise((r,n)=>{this.pendingQueries.set(i,{method:e,params:t,resolver:r,rejector:n}),this.sendQueryRpc(i,e,t)})}sendQueryRpc(e,t,i){this.readyState===r.WsReadyState.OPEN&&this.ws.send(JSON.stringify({jsonrpc:"2.0",method:t,params:i,id:e}))}createRandomId(){return parseInt(Array.from({length:6}).map(()=>Math.floor(100*Math.random())).join(""))}}},1290:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WsReadyState=void 0,function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED",e[e.NONE=4]="NONE"}(t.WsReadyState||(t.WsReadyState={}))},1291:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(752),t),n(i(765),t),n(i(1316),t)},1316:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignDocWrapper=void 0;const r=i(765),n=i(147),s=i(768);class o{constructor(e){this.signDoc=e,this.mode="msgs"in e?"amino":"direct","amino"===this.mode?this.isADR36SignDoc=s.checkAndValidateADR36AminoSignDoc(this.aminoSignDoc):this.isADR36SignDoc=!1}static fromAminoSignDoc(e){return new o(e)}static fromDirectSignDoc(e){return new o(e)}static fromDirectSignDocBytes(e){return new o(n.SignDoc.decode(e))}clone(){return new o(this.signDoc)}get protoSignDoc(){if("amino"===this.mode)throw new Error("Sign doc is encoded as Amino Json");if("msgs"in this.signDoc)throw new Error("Unexpected error");return this._protoSignDoc||(this._protoSignDoc=new r.ProtoSignDocDecoder(this.signDoc)),this._protoSignDoc}get aminoSignDoc(){if("direct"===this.mode)throw new Error("Sign doc is encoded as Protobuf");if(!("msgs"in this.signDoc))throw new Error("Unexpected error");return this.signDoc}get chainId(){return"direct"===this.mode?this.protoSignDoc.chainId:this.aminoSignDoc.chain_id}get memo(){return"direct"===this.mode?this.protoSignDoc.txBody.memo:this.aminoSignDoc.memo}get fees(){var e,t;if("direct"===this.mode){const i=[];for(const r of null!==(t=null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.amount)&&void 0!==t?t:[]){if(null==r.denom||null==r.amount)throw new Error("Invalid fee");i.push({denom:r.denom,amount:r.amount})}return i}return this.aminoSignDoc.fee.amount}get granter(){var e;return"direct"===this.mode?null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.granter:this.aminoSignDoc.fee.granter}get gas(){var e;return"direct"===this.mode?(null===(e=this.protoSignDoc.authInfo.fee)||void 0===e?void 0:e.gasLimit)?parseInt(this.protoSignDoc.authInfo.fee.gasLimit):0:parseInt(this.aminoSignDoc.fee.gas)}}t.SignDocWrapper=o},1317:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyADR36Amino=t.verifyADR36AminoSignDoc=t.makeADR36AminoSignDoc=t.checkAndValidateADR36AminoSignDoc=void 0;const r=i(769),n=i(750),s=i(2),o=i(69);function a(e,t){if(!(()=>{if(e&&e.msgs&&Array.isArray(e.msgs)&&1===e.msgs.length){return"sign/MsgSignData"===e.msgs[0].type}return!1})())return!1;if(""!==e.chain_id)throw new Error("Chain id should be empty string for ADR-36 signing");if(""!==e.memo)throw new Error("Memo should be empty string for ADR-36 signing");if("0"!==e.account_number)throw new Error('Account number should be "0" for ADR-36 signing');if("0"!==e.sequence)throw new Error('Sequence should be "0" for ADR-36 signing');if("0"!==e.fee.gas)throw new Error('Gas should be "0" for ADR-36 signing');if(0!==e.fee.amount.length)throw new Error("Fee amount should be empty array for ADR-36 signing");const i=e.msgs[0];if("sign/MsgSignData"!==i.type)throw new Error("Invalid type of ADR-36 sign msg: "+i.type);if(!i.value)throw new Error("Empty value in the msg");const r=i.value.signer;if(!r)throw new Error("Empty signer in the ADR-36 msg");n.Bech32Address.validate(r,t);const o=i.value.data;if(!o)throw new Error("Empty data in the ADR-36 msg");const a=s.Buffer.from(o,"base64");if(a.toString("base64")!==o)throw new Error("Data is not encoded by base64");if(0===a.length)throw new Error("Empty data in the ADR-36 msg");return!0}function c(e,t){return{chain_id:"",account_number:"0",sequence:"0",fee:{gas:"0",amount:[]},msgs:[{type:"sign/MsgSignData",value:{signer:e,data:t=s.Buffer.from(t).toString("base64")}}],memo:""}}function d(e,t,i,s,c="secp256k1"){if(!a(t,e))throw new Error("Invalid sign doc for ADR-36");const d=new o.PubKeySecp256k1(i);if(("ethsecp256k1"===c?new n.Bech32Address(d.getEthAddress()).toBech32(e):new n.Bech32Address(d.getAddress()).toBech32(e))!==t.msgs[0].value.signer)throw new Error("Unmatched signer");const u=r.serializeSignDoc(t);return d.verifyDigest32("ethsecp256k1"===c?o.Hash.keccak256(u):o.Hash.sha256(u),s)}t.checkAndValidateADR36AminoSignDoc=a,t.makeADR36AminoSignDoc=c,t.verifyADR36AminoSignDoc=d,t.verifyADR36Amino=function(e,t,i,r,n,s="secp256k1"){return d(e,c(t,i),r,n,s)}},1318:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeSignDoc=t.encodeSecp256k1Signature=t.encodeSecp256k1Pubkey=void 0;const r=i(2),n=i(21);function s(e){if(33!==e.length||2!==e[0]&&3!==e[0])throw new Error("Public key must be compressed secp256k1, i.e. 33 bytes starting with 0x02 or 0x03");return{type:"tendermint/PubKeySecp256k1",value:r.Buffer.from(e).toString("base64")}}t.encodeSecp256k1Pubkey=s,t.encodeSecp256k1Signature=function(e,t){if(64!==t.length)throw new Error("Signature must be 64 bytes long. Cosmos SDK uses a 2x32 byte fixed length encoding for the secp256k1 signature integers r and s.");return{pub_key:s(e),signature:r.Buffer.from(t).toString("base64")}},t.serializeSignDoc=function(e){return r.Buffer.from(n.escapeHTML(n.sortedJsonByKeyStringify(e)))}},1337:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.validateBasicChainInfoType=void 0;const n=i(770);t.validateBasicChainInfoType=function(e,t=!0){return r(this,void 0,void 0,(function*(){return yield n.ChainInfoSchema.validateAsync(e,{stripUnknown:t})}))}},1338:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.checkRestConnectivity=t.checkRPCConnectivity=t.DifferentChainVersionError=void 0;const s=n(i(89)),o=i(9);class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}t.DifferentChainVersionError=a,t.checkRPCConnectivity=function(e,t,i){return r(this,void 0,void 0,(function*(){const r=s.default.create({baseURL:t});let n;try{n=yield r.get("/status")}catch(e){throw console.log(e),new Error("Failed to get response /status from rpc endpoint")}const c=o.ChainIdHelper.parse(e),d="result"in n.data?n.data.result:n.data,u=o.ChainIdHelper.parse(d.node_info.network);if(u.identifier!==c.identifier)throw new Error(`RPC endpoint has different chain id (expected: ${e}, actual: ${d.node_info.network})`);if(u.version!==c.version)throw new a(`RPC endpoint has different chain id (expected: ${e}, actual: ${d.node_info.network})`);let h=t;h.startsWith("http")&&(h=h.replace("http","ws")),h=h.endsWith("/")?h+"websocket":h+"/websocket";const l=i?i(h):new WebSocket(h);l.onerror=()=>{};let p=!1;for(let e=0;e<15;e++){if(0!==l.readyState){if(1===l.readyState){p=!0;break}throw new Error("Failed to connect websocket to /websocket rpc")}yield new Promise(e=>setTimeout(e,1e3))}if(l.close(),!p)throw new Error("Failed to connect websocket to /websocket rpc")}))},t.checkRestConnectivity=function(e,t){return r(this,void 0,void 0,(function*(){const i=s.default.create({baseURL:t});let r;try{r=yield i.get("/cosmos/base/tendermint/v1beta1/node_info")}catch(e){throw console.log(e),new Error("Failed to get response /cosmos/base/tendermint/v1beta1/node_info from lcd endpoint")}const n=o.ChainIdHelper.parse(e),c=o.ChainIdHelper.parse(r.data.default_node_info.network);if(c.identifier!==n.identifier)throw new Error(`LCD endpoint has different chain id (expected: ${e}, actual: ${r.data.default_node_info.network})`);if(c.version!==n.version)throw new a(`LCD endpoint has different chain id (expected: ${e}, actual: ${r.data.default_node_info.network})`)}))}},1339:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(421),n=i(746),s=i(1340);t.init=function(e,t){e.registerMessage(r.GetChainInfosMsg),e.registerMessage(r.GetChainInfosWithoutEndpointsMsg),e.registerMessage(r.SuggestChainInfoMsg),e.registerMessage(r.RemoveSuggestedChainInfoMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1340:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(421);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.GetChainInfosMsg:return o(e)(t,i);case s.GetChainInfosWithoutEndpointsMsg:return a(e)(t,i);case s.SuggestChainInfoMsg:return c(e)(t,i);case s.RemoveSuggestedChainInfoMsg:return d(e)(t,i);default:throw new n.KeplrError("chains",110,"Unknown msg type")}};const o=e=>()=>r(void 0,void 0,void 0,(function*(){return{chainInfos:yield e.getChainInfos()}})),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.permissionService.checkOrGrantGlobalPermission(t,"/permissions/grant/get-chain-infos","get-chain-infos",i.origin);return{chainInfos:yield e.getChainInfosWithoutEndpoints()}})),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){if(yield e.hasChainInfo(i.chainInfo.chainId))return;const r=i.chainInfo;r.beta=!0,yield e.suggestChainInfo(t,r,i.origin)})),d=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.removeChainInfo(i.chainId),yield e.getChainInfos()}))},1341:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(785),t),n(i(1387),t)},1381:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Crypto=void 0;const c=s(i(224)),d=i(69),u=a(i(481)),h=i(2),l=i(3);t.Crypto=class{static encrypt(e,t,i,r,n,s,a){return o(this,void 0,void 0,(function*(){let p=new Uint8Array(32);const g=h.Buffer.from(yield e.rng(p)).toString("hex"),f={salt:g,dklen:32,n:131072,r:8,p:1},y=yield(()=>o(this,void 0,void 0,(function*(){switch(t){case"scrypt":return yield e.scrypt(n,f);case"sha256":return d.Hash.sha256(h.Buffer.from(`${g}/${n}`));case"pbkdf2":return new Promise((e,t)=>{u.default.pbkdf2(n,g,4e3,32,"sha256",(i,r)=>{i?t(i):e(new Uint8Array(r))})});default:throw new l.KeplrError("keyring",220,"Unknown kdf")}})))(),v=h.Buffer.from(r);p=new Uint8Array(16);const m=h.Buffer.from(yield e.rng(p)),w=new c.Counter(0);w.setBytes(m);const S=new c.default.ModeOfOperation.ctr(y,w),b=h.Buffer.from(S.encrypt(v)),k=d.Hash.sha256(h.Buffer.concat([h.Buffer.from(y.slice(y.length/2)),b]));return{version:"1.2",type:i,coinTypeForChain:{},bip44HDPath:a,meta:s,crypto:{cipher:"aes-128-ctr",cipherparams:{iv:m.toString("hex")},ciphertext:b.toString("hex"),kdf:t,kdfparams:f,mac:h.Buffer.from(k).toString("hex")}}}))}static decrypt(e,t,i){return o(this,void 0,void 0,(function*(){const r=yield(()=>o(this,void 0,void 0,(function*(){switch(t.crypto.kdf){case"scrypt":return yield e.scrypt(i,t.crypto.kdfparams);case"sha256":return d.Hash.sha256(h.Buffer.from(`${t.crypto.kdfparams.salt}/${i}`));case"pbkdf2":return new Promise((e,r)=>{u.default.pbkdf2(i,t.crypto.kdfparams.salt,4e3,32,"sha256",(t,i)=>{t?r(t):e(new Uint8Array(i))})});default:throw new l.KeplrError("keyring",220,"Unknown kdf")}})))(),n=new c.Counter(0);n.setBytes(h.Buffer.from(t.crypto.cipherparams.iv,"hex"));const s=new c.default.ModeOfOperation.ctr(r,n),a=d.Hash.sha256(h.Buffer.concat([h.Buffer.from(r.slice(r.length/2)),h.Buffer.from(t.crypto.ciphertext,"hex")]));if(!h.Buffer.from(a).equals(h.Buffer.from(t.crypto.mac,"hex")))throw new l.KeplrError("keyring",222,"Unmatched mac");return h.Buffer.from(s.decrypt(h.Buffer.from(t.crypto.ciphertext,"hex")))}))}}},1382:function(e,t,i){(function(t){var r,n,s=i(50).Buffer,o=i(790),a=i(791),c=i(792),d=i(793),u=t.crypto&&t.crypto.subtle,h={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},l=[];function p(){return n||(n=t.process&&t.process.nextTick?t.process.nextTick:t.queueMicrotask?t.queueMicrotask:t.setImmediate?t.setImmediate:t.setTimeout)}function g(e,t,i,r,n){return u.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then((function(e){return u.deriveBits({name:"PBKDF2",salt:t,iterations:i,hash:{name:n}},e,r<<3)})).then((function(e){return s.from(e)}))}e.exports=function(e,i,n,f,y,v){"function"==typeof y&&(v=y,y=void 0);var m=h[(y=y||"sha1").toLowerCase()];if(m&&"function"==typeof t.Promise){if(o(n,f),e=d(e,a,"Password"),i=d(i,a,"Salt"),"function"!=typeof v)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then((function(e){p()((function(){t(null,e)}))}),(function(e){p()((function(){t(e)}))}))}(function(e){if(t.process&&!t.process.browser)return Promise.resolve(!1);if(!u||!u.importKey||!u.deriveBits)return Promise.resolve(!1);if(void 0!==l[e])return l[e];var i=g(r=r||s.alloc(8),r,10,128,e).then((function(){return!0})).catch((function(){return!1}));return l[e]=i,i}(m).then((function(t){return t?g(e,i,n,f,m):c(e,i,n,f,y)})),v)}else p()((function(){var t;try{t=c(e,i,n,f,y)}catch(e){return v(e)}v(null,t)}))}}).call(this,i(30))},1384:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.trimAminoSignDoc=void 0;const n=r(i(49)),s=n.default.object({chain_id:n.default.string().allow(""),account_number:n.default.string().allow(""),sequence:n.default.string().allow(""),fee:n.default.object({amount:n.default.array().items(n.default.object({denom:n.default.string().allow(""),amount:n.default.string().allow("")})),gas:n.default.string().allow(""),payer:n.default.string().allow(""),granter:n.default.string().allow(""),feePayer:n.default.string().allow("")}),msgs:n.default.array().items(n.default.any()),memo:n.default.string().allow(""),timeout_height:n.default.string().allow("")});t.trimAminoSignDoc=function(e){const t=s.validate(e,{stripUnknown:!0});if(t.error)throw t.error;return t.value}},1385:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CosmosApp=void 0;const r=i(2),n=i(1386),s=i(799),o=i(555);class a{constructor(e,t){if(this.app=e,this.transport=t,!t)throw new Error("Transport has not been defined");if("Cosmos"!==e&&"Terra"!==e)throw new Error("Unknown app: "+this.app)}static serializeHRP(e){if(null==e||e.length<3||e.length>83)throw new Error("Invalid HRP");const t=r.Buffer.alloc(1+e.length);return t.writeUInt8(e.length,0),t.write(e,1),t}static openApp(e,t){return e.send(224,216,0,0,r.Buffer.from(t,"ascii"))}getAppInfo(){return n.getAppInfo(this.transport)}getVersion(){return n.getVersion(this.transport)}getDeviceInfo(){return n.getDeviceInfo(this.transport)}getPublicKey(e,t,i){const c=s.AppCoinType[this.app];if(!c)throw new Error("Unknown app: "+this.app);const d=[44,c,e,t,i],u=n.serializePath(d),h=s.AppHRP[this.app];if(!h)throw new Error("Unknown app: "+this.app);const l=r.Buffer.concat([a.serializeHRP(h),u]);return this.transport.send(o.CLA,o.INS.GET_ADDR_SECP256K1,0,0,l,[o.ERROR_CODE.NoError]).then(e=>{const t=e.slice(-2),i=256*t[0]+t[1];return{compressed_pk:e?r.Buffer.from(e.slice(0,33)):null,return_code:i,error_message:n.errorCodeToString(i)}}).catch(n.processErrorResponse)}sign(e,t,i,r){const o=s.AppCoinType[this.app];if(!o)throw new Error("Unknown app: "+this.app);return n.sign(this.transport,[44,o,e,t,i],r)}}t.CosmosApp=a},1386:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.sign=t.getDeviceInfo=t.openApp=t.getAppInfo=t.getVersion=t.serializePath=t.processErrorResponse=t.errorCodeToString=void 0;const n=i(555),s=i(2);function o(e){const t=n.ERROR_DESCRIPTION[e];return t||"Unknown Status Code: "+e}function a(e){if(e){if(!("object"!=typeof(t=e)||null===t||t instanceof Array||t instanceof Date)){if(Object.prototype.hasOwnProperty.call(e,"statusCode"))return{return_code:e.statusCode,error_message:o(e.statusCode)};if(Object.prototype.hasOwnProperty.call(e,"return_code")&&Object.prototype.hasOwnProperty.call(e,"error_message"))return e}return{return_code:65535,error_message:e.toString()}}var t;return{return_code:65535,error_message:e.toString()}}function c(e){if(!e||5!==e.length)throw new TypeError("Invalid path.");const t=s.Buffer.alloc(20);return t.writeUInt32LE(2147483648+e[0],0),t.writeUInt32LE(2147483648+e[1],4),t.writeUInt32LE(2147483648+e[2],8),t.writeUInt32LE(e[3],12),t.writeUInt32LE(e[4],16),t}function d(e,t,i,r){let s=n.PAYLOAD_TYPE.ADD;return 1===t&&(s=n.PAYLOAD_TYPE.INIT),t===i&&(s=n.PAYLOAD_TYPE.LAST),e.send(n.CLA,n.INS.SIGN_SECP256K1,s,0,r,[n.ERROR_CODE.NoError,27012,27264]).then(e=>{const t=e.slice(-2),i=256*t[0]+t[1];let r=o(i);27264!==i&&27012!==i||(r=`${r} : ${e.slice(0,e.length-2).toString("ascii")}`);let n=new Uint8Array(0);return e.length>2&&(n=e.slice(0,e.length-2)),{signature:n,return_code:i,error_message:r}}).catch(a)}t.errorCodeToString=o,t.processErrorResponse=a,t.serializePath=c,t.getVersion=function(e){return e.send(n.CLA,n.INS.GET_VERSION,0,0).then(e=>{const t=e.slice(-2),i=256*t[0]+t[1];let r=0;return e.length>=9&&(r=(e[5]<<24)+(e[6]<<16)+(e[7]<<8)+(e[8]<<0)),{return_code:i,error_message:o(i),test_mode:0!==e[0],major:e[1],minor:e[2],patch:e[3],device_locked:1===e[4],target_id:r.toString(16)}}).catch(a)},t.getAppInfo=function(e){return e.send(176,1,0,0).then(e=>{const t=e.slice(-2);let i,r=256*t[0]+t[1],n="",s="",o=0,a=0;if(1!==e[0])i="response format ID not recognized",r=36865;else{i="No errors";const t=e[1];n=e.slice(2,2+t).toString("ascii");let r=2+t;const c=e[r];r+=1,s=e.slice(r,r+c).toString("ascii"),r+=c;const d=e[r];r+=1,o=d,a=e[r]}return{return_code:r,error_message:i,app_name:n,app_version:s,flag_len:o,flags_value:a,flag_recovery:0!=(1&a),flag_signed_mcu_code:0!=(2&a),flag_onboarded:0!=(4&a),flag_pin_validated:0!=(128&a)}}).catch(a)},t.openApp=function(e,t){return r(this,void 0,void 0,(function*(){yield e.send(224,216,0,0,s.Buffer.from(t,"ascii"))}))},t.getDeviceInfo=function(e){return r(this,void 0,void 0,(function*(){return e.send(224,1,0,0,s.Buffer.from([]),[n.ERROR_CODE.NoError,28160]).then(e=>{const t=e.slice(-2),i=256*t[0]+t[1];if(28160===i)return{return_code:i,error_message:"This command is only available in the Dashboard"};const r=e.slice(0,4).toString("hex");let n=4;const s=e[n];n+=1;const a=e.slice(n,n+s).toString();n+=s;const c=e[n];n+=1;const d=e.slice(n,n+c).toString("hex");n+=c;const u=e[n];n+=1;let h=e.slice(n,n+u);0===h[u-1]&&(h=e.slice(n,n+u-1));const l=h.toString();return{return_code:i,error_message:o(i),target_id:r,se_version:a,flag:d,mcu_version:l}}).catch(a)}))},t.sign=function(e,t,i){const o=function(e,t){const i=c(e),r=[];r.push(i);const o=s.Buffer.from(t);for(let e=0;e<o.length;e+=n.CHUNK_SIZE){let t=e+n.CHUNK_SIZE;e>o.length&&(t=o.length),r.push(o.slice(e,t))}return r}(t,i);return d(e,1,o.length,o[0]).then(t=>r(this,void 0,void 0,(function*(){let i={return_code:t.return_code,error_message:t.error_message,signature:new Uint8Array(0)};for(let t=1;t<o.length&&(i=yield d(e,1+t,o.length,o[t]),i.return_code===n.ERROR_CODE.NoError);t+=1);return{return_code:i.return_code,error_message:i.error_message,signature:i.signature}}))).catch(a)}},1387:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(552),n=i(795),s=i(1388);t.init=function(e,t){e.registerMessage(r.LedgerGetWebHIDFlagMsg),e.registerMessage(r.LedgerSetWebHIDFlagMsg),e.registerMessage(r.TryLedgerInitMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1388:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(552);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.LedgerGetWebHIDFlagMsg:return o(e)(t,i);case s.LedgerSetWebHIDFlagMsg:return a(e)(t,i);case s.TryLedgerInitMsg:return c(e)(t,i);default:throw new n.KeplrError("ledger",111,"Unknown msg type")}};const o=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.getWebHIDFlag()})),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.setWebHIDFlag(i.flag)})),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.tryLedgerInit(t,i.ledgerApp,i.cosmosLikeApp)}))},1389:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(800),t)},1390:function(e,t,i){"use strict";(function(e){var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.useKeystoneCosmosKeyring=t.KeystoneCosmosKeyring=t.KeystoneCosmosInteractionProvider=void 0;const n=i(801),s=i(1405),o=i(264),a=i(1434);class c{constructor(){this.readUR=()=>r(this,void 0,void 0,(function*(){throw new Error("KeystoneError#readUR function is not set.")})),this.playUR=()=>r(this,void 0,void 0,(function*(){throw new Error("KeystoneError#playUR function is not set.")})),this.readCryptoMultiAccounts=()=>r(this,void 0,void 0,(function*(){const t=yield this.readUR();return o.CryptoMultiAccounts.fromCBOR(e.from(t.cbor,"hex"))})),this.requestSignature=(t,i,s)=>r(this,void 0,void 0,(function*(){const r=t.toUR();yield this.playUR({type:r.type,cbor:r.cbor.toString("hex")},{title:i,description:s});const o=yield this.readUR();return n.CosmosSignature.fromCBOR(e.from(o.cbor,"hex"))}))}onReadUR(e){this.readUR=e}onPlayUR(e){this.playUR=e}}t.KeystoneCosmosInteractionProvider=c;class d extends s.BaseKeyring{constructor(){super(),this.getInteraction=()=>this.interaction,this.interaction=new c}static getEmptyKeyring(){return new d}getKeyringData(){return{xfp:this.xfp,device:this.device,name:this.name,keys:this.getPubKeys().map(e=>{const t=a.parseHDPath("m/"+e.hdPath);return{coinType:t.coinType,bip44HDPath:t.bip44HDPath,pubKey:e.pubKey,index:e.index}})}}}t.KeystoneCosmosKeyring=d,d.type=s.BaseKeyring.type,t.useKeystoneCosmosKeyring=function({readUR:e,playUR:t,keyringData:i}){const r=d.getEmptyKeyring();if(i){const e=Object.assign(Object.assign({},i),{keys:i.keys.map(e=>({hdPath:`44'/${e.coinType}'/${e.bip44HDPath.account}'/${e.bip44HDPath.change}/${e.bip44HDPath.addressIndex}`,index:e.index,pubKey:e.pubKey}))});r.syncKeyringData(e)}return e&&r.getInteraction().onReadUR(e),t&&r.getInteraction().onPlayUR(t),r}}).call(this,i(2).Buffer)},1434:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseHDPath=t.toNumber=void 0;t.toNumber=e=>/'$/.test(e)?+e.slice(0,-1):+e;t.parseHDPath=e=>{const i=e.split(/\//);return{coinType:t.toNumber(i[2]),bip44HDPath:{account:t.toNumber(i[3]),change:t.toNumber(i[4]),addressIndex:t.toNumber(i[5])}}}},1435:function(e,t,i){"use strict";(function(e){var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.useKeystoneEthereumKeyring=t.KeystoneEthereumKeyring=t.KeystoneEthereumInteractionProvider=void 0;const n=i(832),s=i(1467),o=i(264),a=i(189),c=i(100);class d{constructor(){this.readUR=()=>r(this,void 0,void 0,(function*(){throw new Error("KeystoneError#readUR function is not set.")})),this.playUR=()=>r(this,void 0,void 0,(function*(){throw new Error("KeystoneError#playUR function is not set.")})),this.readCryptoHDKeyOrCryptoAccount=()=>r(this,void 0,void 0,(function*(){const t=yield this.readUR();return"crypto-hdkey"===t.type?o.CryptoHDKey.fromCBOR(e.from(t.cbor,"hex")):o.CryptoAccount.fromCBOR(e.from(t.cbor,"hex"))})),this.requestSignature=(t,i,s)=>r(this,void 0,void 0,(function*(){const r=t.toUR();yield this.playUR({type:r.type,cbor:r.cbor.toString("hex")},{title:i,description:s});const o=yield this.readUR();return n.ETHSignature.fromCBOR(e.from(o.cbor,"hex"))}))}onReadUR(e){this.readUR=e}onPlayUR(e){this.playUR=e}}t.KeystoneEthereumInteractionProvider=d;class u extends s.BaseKeyring{constructor(){super(),this.getInteraction=()=>this.interaction,this.interaction=new d}static getEmptyKeyring(){return new u}syncKeyringData(t){const i=t.keys.find(e=>60===e.coinType);if(this.xfp=t.xfp,i){const t=e.from(a.publicKeyConvert(e.from(i.pubKey,"hex"),!0));this.hdPath=`m/44'/${i.coinType}'/${i.bip44HDPath.account}'`,this.indexes[c.computeAddress(t)]=i.bip44HDPath.addressIndex}}checkKeyring(){if(!this.xfp||!this.hdPath)throw new Error("KeystoneError#invalid_keyring: keyring not fulfilled, please call function `readKeyring` firstly")}}t.KeystoneEthereumKeyring=u,u.type=s.BaseKeyring.type,t.useKeystoneEthereumKeyring=function({readUR:e,playUR:t,keyringData:i}){const r=u.getEmptyKeyring();return i&&r.syncKeyringData(i),e&&r.getInteraction().onReadUR(e),t&&r.getInteraction().onPlayUR(t),r}}).call(this,i(2).Buffer)},1533:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(789),t),n(i(1534),t)},1534:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(430),n=i(798),s=i(1535);t.init=function(e,t){e.registerMessage(r.RestoreKeyRingMsg),e.registerMessage(r.DeleteKeyRingMsg),e.registerMessage(r.UpdateNameKeyRingMsg),e.registerMessage(r.ShowKeyRingMsg),e.registerMessage(r.CreateMnemonicKeyMsg),e.registerMessage(r.AddMnemonicKeyMsg),e.registerMessage(r.CreatePrivateKeyMsg),e.registerMessage(r.AddPrivateKeyMsg),e.registerMessage(r.CreateKeystoneKeyMsg),e.registerMessage(r.CreateLedgerKeyMsg),e.registerMessage(r.AddKeystoneKeyMsg),e.registerMessage(r.AddLedgerKeyMsg),e.registerMessage(r.LockKeyRingMsg),e.registerMessage(r.UnlockKeyRingMsg),e.registerMessage(r.GetKeyMsg),e.registerMessage(r.RequestSignAminoMsg),e.registerMessage(r.RequestVerifyADR36AminoSignDoc),e.registerMessage(r.RequestSignDirectMsg),e.registerMessage(r.GetMultiKeyStoreInfoMsg),e.registerMessage(r.ChangeKeyRingMsg),e.registerMessage(r.GetIsKeyStoreCoinTypeSetMsg),e.registerMessage(r.SetKeyStoreCoinTypeMsg),e.registerMessage(r.CheckPasswordMsg),e.registerMessage(r.ExportKeyRingDatasMsg),e.registerMessage(r.RequestSignEIP712CosmosTxMsg_v0),e.registerMessage(r.InitNonDefaultLedgerAppMsg),e.registerMessage(r.RequestICNSAdr36SignaturesMsg),e.registerMessage(r.ChangeKeyRingNameMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1535:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(430),o=i(9),a=i(147);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.RestoreKeyRingMsg:return c(e)(t,i);case s.DeleteKeyRingMsg:return d(e)(t,i);case s.UpdateNameKeyRingMsg:return u(e)(t,i);case s.ShowKeyRingMsg:return h(e)(t,i);case s.CreateMnemonicKeyMsg:return l(e)(t,i);case s.AddMnemonicKeyMsg:return p(e)(t,i);case s.CreatePrivateKeyMsg:return g(e)(t,i);case s.AddPrivateKeyMsg:return f(e)(t,i);case s.CreateKeystoneKeyMsg:return y(e)(t,i);case s.CreateLedgerKeyMsg:return v(e)(t,i);case s.AddKeystoneKeyMsg:return m(e)(t,i);case s.AddLedgerKeyMsg:return w(e)(t,i);case s.LockKeyRingMsg:return S(e)(t,i);case s.UnlockKeyRingMsg:return b(e)(t,i);case s.GetKeyMsg:return k(e)(t,i);case s.RequestSignAminoMsg:return _(e)(t,i);case s.RequestSignEIP712CosmosTxMsg_v0:return E(e)(t,i);case s.RequestVerifyADR36AminoSignDoc:return P(e)(t,i);case s.RequestSignDirectMsg:return M(e)(t,i);case s.RequestICNSAdr36SignaturesMsg:return K(e)(t,i);case s.GetMultiKeyStoreInfoMsg:return I(e)(t,i);case s.ChangeKeyRingMsg:return O(e)(t,i);case s.GetIsKeyStoreCoinTypeSetMsg:return C(e)(t,i);case s.SetKeyStoreCoinTypeMsg:return T(e)(t,i);case s.CheckPasswordMsg:return A(e)(t,i);case s.ExportKeyRingDatasMsg:return R(e)(t,i);case s.InitNonDefaultLedgerAppMsg:return x(e)(t,i);case s.ChangeKeyRingNameMsg:return D(e)(t,i);default:throw new n.KeplrError("keyring",221,"Unknown msg type")}};const c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.restore()})),d=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.deleteKeyRing(i.index,i.password)})),u=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.updateNameKeyRing(i.index,i.name)})),h=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.showKeyRing(i.index,i.password)})),l=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.createMnemonicKey(i.kdf,i.mnemonic,i.password,i.meta,i.bip44HDPath)})),p=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.addMnemonicKey(i.kdf,i.mnemonic,i.meta,i.bip44HDPath)})),g=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.createPrivateKey(i.kdf,i.privateKey,i.password,i.meta)})),f=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.addPrivateKey(i.kdf,i.privateKey,i.meta)})),y=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.createKeystoneKey(t,i.kdf,i.password,i.meta,i.bip44HDPath)})),v=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.createLedgerKey(t,i.kdf,i.password,i.meta,i.bip44HDPath,i.cosmosLikeApp)})),m=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.addKeystoneKey(t,i.kdf,i.meta,i.bip44HDPath)})),w=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.addLedgerKey(t,i.kdf,i.meta,i.bip44HDPath,i.cosmosLikeApp)})),S=e=>()=>({status:e.lock()}),b=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{status:yield e.unlock(i.password)}})),k=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin);const r=yield e.getKey(i.chainId);return{name:e.getKeyStoreMeta("name"),algo:"secp256k1",pubKey:r.pubKey,address:r.address,bech32Address:new o.Bech32Address(r.address).toBech32((yield e.chainsService.getChainInfo(i.chainId)).bech32Config.bech32PrefixAccAddr),isNanoLedger:r.isNanoLedger,isKeystone:r.isKeystone}})),_=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.requestSignAmino(t,i.origin,i.chainId,i.signer,i.signDoc,i.signOptions)})),E=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.requestSignEIP712CosmosTx_v0(t,i.origin,i.chainId,i.signer,i.eip712,i.signDoc,i.signOptions)})),P=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.verifyADR36AminoSignDoc(i.chainId,i.signer,i.data,i.signature)})),M=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin);const r=a.SignDoc.fromPartial({bodyBytes:i.signDoc.bodyBytes,authInfoBytes:i.signDoc.authInfoBytes,chainId:i.signDoc.chainId,accountNumber:i.signDoc.accountNumber}),n=yield e.requestSignDirect(t,i.origin,i.chainId,i.signer,r,i.signOptions);return{signed:{bodyBytes:n.signed.bodyBytes,authInfoBytes:n.signed.authInfoBytes,chainId:n.signed.chainId,accountNumber:n.signed.accountNumber.toString()},signature:n.signature}})),K=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),e.requestICNSAdr36Signatures(t,i.chainId,i.contractAddress,i.owner,i.username,i.addressChainIds)})),I=e=>()=>({multiKeyStoreInfo:e.getMultiKeyStoreInfo()}),O=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.changeKeyStoreFromMultiKeyStore(i.index)})),C=e=>(t,i)=>e.getKeyStoreBIP44Selectables(i.chainId,i.paths),T=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.setKeyStoreCoinType(i.chainId,i.coinType),e.keyRingStatus})),A=e=>(t,i)=>e.checkPassword(i.password),R=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.exportKeyRingDatas(i.password)})),x=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.initializeNonDefaultLedgerApp(t,i.ledgerApp)})),D=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.enable(t);let r=-1;if(e.getMultiKeyStoreInfo().forEach(({selected:e},t)=>{e&&(r=t)}),-1===r)throw new Error("No account selected");return yield e.changeKeyRingName(t,r,{defaultName:i.defaultName,editable:i.editable})}))},1536:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(846),t),n(i(1622),t)},1622:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(601),n=i(872),s=i(1623);t.init=function(e,t){e.registerMessage(r.GetPubkeyMsg),e.registerMessage(r.ReqeustEncryptMsg),e.registerMessage(r.RequestDecryptMsg),e.registerMessage(r.GetTxEncryptionKeyMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1623:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(601);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.GetPubkeyMsg:return o(e)(t,i);case s.ReqeustEncryptMsg:return a(e)(t,i);case s.RequestDecryptMsg:return c(e)(t,i);case s.GetTxEncryptionKeyMsg:return d(e)(t,i);default:throw new n.KeplrError("secret-wasm",120,"Unknown msg type")}};const o=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.getPubkey(t,i.chainId)})),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.encrypt(t,i.chainId,i.contractCodeHash,i.msg)})),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.decrypt(t,i.chainId,i.cipherText,i.nonce)})),d=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.getTxEncryptionKey(t,i.chainId,i.nonce)}))},1624:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(873),t),n(i(1625),t)},1625:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(602),n=i(874),s=i(1626);t.init=function(e,t){e.registerMessage(r.SendTxMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1626:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(602);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.SendTxMsg:return o(e)(t,i);default:throw new n.KeplrError("tx",110,"Unknown msg type")}};const o=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.sendTx(i.chainId,i.tx,i.mode)}))},1627:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(875),t),n(i(1628),t)},1628:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(603),n=i(876),s=i(1629);t.init=function(e,t){e.registerMessage(r.TryUpdateChainMsg),e.registerMessage(r.SetChainEndpointsMsg),e.registerMessage(r.ResetChainEndpointsMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1629:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(603);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.TryUpdateChainMsg:return o(e)(t,i);case s.SetChainEndpointsMsg:return a(e)(t,i);case s.ResetChainEndpointsMsg:return c(e)(t,i);default:throw new n.KeplrError("updater",110,"Unknown msg type")}};const o=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return{updated:yield e.tryUpdateChainInfo(i.chainId),afterChainInfos:yield e.chainsService.getChainInfos()}})),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.setChainEndpoints(i.chainId,i.rpc,i.rest)})),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.resetChainEndpoints(i.chainId)}))},1630:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(877),t),n(i(1631),t)},1631:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(441),n=i(878),s=i(1632);t.init=function(e,t){e.registerMessage(r.GetTokensMsg),e.registerMessage(r.SuggestTokenMsg),e.registerMessage(r.AddTokenMsg),e.registerMessage(r.RemoveTokenMsg),e.registerMessage(r.GetSecret20ViewingKey),e.addHandler(n.ROUTE,s.getHandler(t))}},1632:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(3),s=i(441);t.getHandler=e=>(t,i)=>{switch(i.constructor){case s.GetTokensMsg:return o(e)(t,i);case s.SuggestTokenMsg:return a(e)(t,i);case s.AddTokenMsg:return c(e)(t,i);case s.RemoveTokenMsg:return d(e)(t,i);case s.GetSecret20ViewingKey:return u(e)(t,i);default:throw new n.KeplrError("tokens",120,"Unknown msg type")}};const o=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.getTokens(i.chainId)})),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.suggestToken(t,i.chainId,i.contractAddress,i.viewingKey)})),c=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.addToken(i.chainId,i.currency)})),d=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.removeToken(i.chainId,i.currency)})),u=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.permissionService.checkOrGrantBasicAccessPermission(t,i.chainId,i.origin),yield e.getSecret20ViewingKey(i.chainId,i.contractAddress)}))},1633:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(880),t),n(i(1638),t)},1634:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionForegroundService=void 0;t.InteractionForegroundService=class{constructor(e){this.handler=e}pushData(e){this.handler.onInteractionDataReceived(e)}pushEvent(e){this.handler.onEventDataReceived(e)}}},1635:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1636:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.interactionForegroundInit=void 0;const r=i(604),n=i(882),s=i(1637);t.interactionForegroundInit=function(e,t){e.registerMessage(r.PushInteractionDataMsg),e.registerMessage(r.PushEventDataMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1637:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(3),n=i(604);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.PushInteractionDataMsg:return s(e)(t,i);case n.PushEventDataMsg:return o(e)(t,i);default:throw new r.KeplrError("interaction",110,"Unknown msg type")}};const s=e=>(t,i)=>e.pushData(i.data),o=e=>(t,i)=>e.pushEvent(i.data)},1638:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(605),n=i(883),s=i(1639);t.init=function(e,t){e.registerMessage(r.ApproveInteractionMsg),e.registerMessage(r.RejectInteractionMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1639:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(3),n=i(605);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.ApproveInteractionMsg:return s(e)(t,i);case n.RejectInteractionMsg:return o(e)(t,i);default:throw new r.KeplrError("interaction",100,"Unknown msg type")}};const s=e=>(t,i)=>e.approve(i.id,i.result),o=e=>(t,i)=>e.reject(i.id)},1640:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(782),t),n(i(1641),t)},1641:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(543),n=i(784),s=i(1642);t.init=function(e,t){e.registerMessage(r.EnableAccessMsg),e.registerMessage(r.DisableAccessMsg),e.registerMessage(r.GetPermissionOriginsMsg),e.registerMessage(r.GetOriginPermittedChainsMsg),e.registerMessage(r.AddPermissionOrigin),e.registerMessage(r.RemovePermissionOrigin),e.registerMessage(r.GetGlobalPermissionOriginsMsg),e.registerMessage(r.RemoveGlobalPermissionOriginMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1642:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const n=i(543),s=i(3);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.EnableAccessMsg:return o(e)(t,i);case n.DisableAccessMsg:return a(e)(t,i);case n.GetPermissionOriginsMsg:return c(e)(t,i);case n.GetOriginPermittedChainsMsg:return d(e)(t,i);case n.AddPermissionOrigin:return u(e)(t,i);case n.RemovePermissionOrigin:return h(e)(t,i);case n.GetGlobalPermissionOriginsMsg:return l(e)(t,i);case n.RemoveGlobalPermissionOriginMsg:return p(e)(t,i);default:throw new s.KeplrError("permission",120,"Unknown msg type")}};const o=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.checkOrGrantBasicAccessPermission(t,i.chainIds,i.origin)})),a=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return yield e.disable(t,i.chainIds,i.origin)})),c=e=>(t,i)=>e.getPermissionOrigins(i.chainId,i.permissionType),d=e=>(t,i)=>e.getOriginPermittedChains(i.permissionOrigin,i.permissionType),u=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.addPermission([i.chainId],i.permissionType,[i.permissionOrigin])})),h=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){yield e.removePermission(i.chainId,i.permissionType,[i.permissionOrigin])})),l=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return e.getGlobalPermissionOrigins(i.permissionType)})),p=e=>(t,i)=>r(void 0,void 0,void 0,(function*(){return e.removeGlobalPermission(i.permissionType,[i.permissionOrigin])}))},1643:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(884),t),n(i(1644),t)},1644:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(886),n=i(1645),s=i(606);t.init=function(e,t){e.registerMessage(s.CheckURLIsPhishingMsg),e.registerMessage(s.URLTempAllowMsg),e.registerMessage(s.CheckBadTwitterIdMsg),e.addHandler(r.ROUTE,n.getHandler(t))}},1645:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(606);t.getHandler=e=>(t,i)=>{switch(i.constructor){case r.CheckURLIsPhishingMsg:return n(e)(t,i);case r.URLTempAllowMsg:return s(e)(t,i);case r.CheckBadTwitterIdMsg:return o(e)(t,i);default:throw new Error("Unknown msg type")}};const n=e=>(t,i)=>e.checkURLIsPhishing(i.origin),s=e=>(t,i)=>{e.allowUrlTemp(i.url)},o=e=>(t,i)=>e.checkBadTwitterId(i.id)},1646:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(887),t),n(i(1647),t)},1647:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(607),n=i(888),s=i(1648);t.init=function(e,t){e.registerMessage(r.GetAutoLockAccountDurationMsg),e.registerMessage(r.UpdateAutoLockAccountDurationMsg),e.registerMessage(r.StartAutoLockMonitoringMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1648:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(3),n=i(607);t.getHandler=e=>(t,i)=>{switch(i.constructor){case n.GetAutoLockAccountDurationMsg:return s(e)(t,i);case n.UpdateAutoLockAccountDurationMsg:return o(e)(t,i);case n.StartAutoLockMonitoringMsg:return a(e)(t,i);default:throw new r.KeplrError("auto-lock-account",100,"Unknown msg type")}};const s=e=>()=>e.getAutoLockDuration(),o=e=>(t,i)=>{if(!e.keyRingIsUnlocked)throw new Error("Keyring is not unlocked");return e.setDuration(i.duration)},a=e=>()=>e.startAppStateCheckTimer()},1649:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(889),t),n(i(1650),t)},1650:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const r=i(609),n=i(608),s=i(1651);t.init=function(e,t){e.registerMessage(r.GetAnalyticsIdMsg),e.addHandler(n.ROUTE,s.getHandler(t))}},1651:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHandler=void 0;const r=i(609);t.getHandler=e=>(t,i)=>{switch(i.constructor){case r.GetAnalyticsIdMsg:return n(e)(t,i);default:throw new Error("Unknown msg type")}};const n=e=>(t,i)=>e.getAnalyticsIdOnlyIfPrivileged(t,i.origin)},1652:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(743),t),n(i(539),t)},1653:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(745),t),n(i(421),t),n(i(1654),t)},1654:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1655:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(800),t)},1656:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(846),t),n(i(601),t)},1657:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(873),t),n(i(602),t),n(i(1658),t)},1658:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1659:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(875),t),n(i(603),t)},1660:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(877),t),n(i(441),t),n(i(879),t)},1661:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(880),t),n(i(605),t),n(i(1662),t),n(i(881),t)},1662:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1663:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(884),t),n(i(606),t)},1664:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(887),t),n(i(607),t)},1665:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(889),t),n(i(609),t)},206:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(799),t),n(i(555),t),n(i(1385),t)},21:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1129),t),n(i(1135),t),n(i(1272),t),n(i(1273),t),n(i(1275),t),n(i(1276),t),n(i(1278),t)},2155:function(e,t,i){"use strict";i.r(t),i.d(t,"keccak256",(function(){return k}));var r=i(191),n=i.n(r);let s=!1,o=!1;const a={debug:1,default:2,info:2,warning:3,error:4,off:5};let c=a.default,d=null;const u=function(){try{const e=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test"!=="test".normalize(t))throw new Error("bad normalize")}catch(i){e.push(t)}}),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(e){return e.message}return null}();var h,l;!function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.OFF="OFF"}(h||(h={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.TIMEOUT="TIMEOUT",e.BUFFER_OVERRUN="BUFFER_OVERRUN",e.NUMERIC_FAULT="NUMERIC_FAULT",e.MISSING_NEW="MISSING_NEW",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.MISSING_ARGUMENT="MISSING_ARGUMENT",e.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",e.CALL_EXCEPTION="CALL_EXCEPTION",e.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",e.NONCE_EXPIRED="NONCE_EXPIRED",e.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",e.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",e.TRANSACTION_REPLACED="TRANSACTION_REPLACED"}(l||(l={}));const p="0123456789abcdef";class g{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const i=e.toLowerCase();null==a[i]&&this.throwArgumentError("invalid log level name","logLevel",e),c>a[i]||console.log.apply(console,t)}debug(...e){this._log(g.levels.DEBUG,e)}info(...e){this._log(g.levels.INFO,e)}warn(...e){this._log(g.levels.WARNING,e)}makeError(e,t,i){if(o)return this.makeError("censored error",t,{});t||(t=g.errors.UNKNOWN_ERROR),i||(i={});const r=[];Object.keys(i).forEach(e=>{const t=i[e];try{if(t instanceof Uint8Array){let i="";for(let e=0;e<t.length;e++)i+=p[t[e]>>4],i+=p[15&t[e]];r.push(e+"=Uint8Array(0x"+i+")")}else r.push(e+"="+JSON.stringify(t))}catch(t){r.push(e+"="+JSON.stringify(i[e].toString()))}}),r.push("code="+t),r.push("version="+this.version);const n=e;r.length&&(e+=" ("+r.join(", ")+")");const s=new Error(e);return s.reason=n,s.code=t,Object.keys(i).forEach((function(e){s[e]=i[e]})),s}throwError(e,t,i){throw this.makeError(e,t,i)}throwArgumentError(e,t,i){return this.throwError(e,g.errors.INVALID_ARGUMENT,{argument:t,value:i})}assert(e,t,i,r){e||this.throwError(t,i,r)}assertArgument(e,t,i,r){e||this.throwArgumentError(t,i,r)}checkNormalize(e){null==e&&(e="platform missing String.prototype.normalize"),u&&this.throwError("platform missing String.prototype.normalize",g.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:u})}checkSafeUint53(e,t){"number"==typeof e&&(null==t&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,g.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,g.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,i){i=i?": "+i:"",e<t&&this.throwError("missing argument"+i,g.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+i,g.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){e!==Object&&null!=e||this.throwError("missing new",g.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",g.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):e!==Object&&null!=e||this.throwError("missing new",g.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return d||(d=new g("logger/5.5.0")),d}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",g.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),s){if(!e)return;this.globalLogger().throwError("error censorship permanent",g.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}o=!!e,s=!!t}static setLogLevel(e){const t=a[e.toLowerCase()];null!=t?c=t:g.globalLogger().warn("invalid log level - "+e)}static from(e){return new g(e)}}g.errors=l,g.levels=h;const f=new g("bytes/5.5.0");function y(e){return!!e.toHexString}function v(e){return e.slice||(e.slice=function(){const t=Array.prototype.slice.call(arguments);return v(new Uint8Array(Array.prototype.slice.apply(e,t)))}),e}function m(e){return"number"==typeof e&&e==e&&e%1==0}function w(e){if(null==e)return!1;if(e.constructor===Uint8Array)return!0;if("string"==typeof e)return!1;if(!m(e.length)||e.length<0)return!1;for(let t=0;t<e.length;t++){const i=e[t];if(!m(i)||i<0||i>=256)return!1}return!0}function S(e,t){if(t||(t={}),"number"==typeof e){f.checkSafeUint53(e,"invalid arrayify value");const t=[];for(;e;)t.unshift(255&e),e=parseInt(String(e/256));return 0===t.length&&t.push(0),v(new Uint8Array(t))}if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),y(e)&&(e=e.toHexString()),b(e)){let i=e.substring(2);i.length%2&&("left"===t.hexPad?i="0x0"+i.substring(2):"right"===t.hexPad?i+="0":f.throwArgumentError("hex data is odd-length","value",e));const r=[];for(let e=0;e<i.length;e+=2)r.push(parseInt(i.substring(e,e+2),16));return v(new Uint8Array(r))}return w(e)?v(new Uint8Array(e)):f.throwArgumentError("invalid arrayify value","value",e)}function b(e,t){return!("string"!=typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}function k(e){return"0x"+n.a.keccak_256(S(e))}},272:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(770),t),n(i(1337),t),n(i(1338),t),n(i(771),t)},365:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(789),t),n(i(430),t),n(i(553),t),n(i(551),t),n(i(796),t)},37:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const a=s(i(1279)),c=s(i(1282)),d=s(i(1341)),u=s(i(1389)),h=s(i(1533)),l=s(i(1536)),p=s(i(1624)),g=s(i(1627)),f=s(i(1630)),y=s(i(1633)),v=s(i(1640)),m=s(i(1643)),w=s(i(1646)),S=s(i(1649));o(i(1652),t),o(i(1653),t),o(i(794),t),o(i(1655),t),o(i(365),t),o(i(1656),t),o(i(1657),t),o(i(1659),t),o(i(1660),t),o(i(1661),t),o(i(781),t),o(i(1663),t),o(i(1664),t),o(i(1665),t),t.init=function(e,t,i,r,n,s,o,b,k,_={},E={}){var P;const M=new y.InteractionService(i,b.rng),K=new a.PersistentMemoryService,I=new v.PermissionService(t("permission"),n),O=new g.ChainUpdaterService(t("updator"),o),C=new f.TokensService(t("tokens")),T=new c.ChainsService(t("chains"),r,{useMemoryKVStoreForSuggestChain:null===(P=E.suggestChain)||void 0===P?void 0:P.useMemoryKVStore}),A=new d.LedgerService(t("ledger"),_),R=new u.KeystoneService(t("keystone")),x=new h.KeyRingService(t("keyring"),r,b),D=new l.SecretWasmService(t("secretwasm")),B=new p.BackgroundTxService(k),j=new m.PhishingListService({blockListUrl:"https://raw.githubusercontent.com/chainapsis/phishing-block-list/main/block-list.txt",twitterListUrl:"https://raw.githubusercontent.com/chainapsis/phishing-block-list/main/twitter-scammer-list.txt",fetchingIntervalMs:108e5,retryIntervalMs:6e5,allowTimeoutMs:6e5}),U=new w.AutoLockAccountService(t("auto-lock-account")),N=new S.AnalyticsService(t("background.analytics"),b.rng,s);K.init(),I.init(M,T,x),O.init(T),C.init(M,I,T,x),T.init(O,M,I),A.init(M),R.init(M),x.init(M,T,I,A,R,N),D.init(T,x,I),B.init(T,I),j.init(),U.init(x),N.init(),y.init(e,M),a.init(e,K),v.init(e,I),g.init(e,O),f.init(e,C),c.init(e,T),d.init(e,A),h.init(e,x),l.init(e,D),p.init(e,B),m.init(e,j),w.init(e,U),S.init(e,N)}},421:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveSuggestedChainInfoMsg=t.SuggestChainInfoMsg=t.GetChainInfosWithoutEndpointsMsg=t.GetChainInfosMsg=void 0;const r=i(3),n=i(746);class s extends r.Message{static type(){return"get-chain-infos"}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.GetChainInfosMsg=s;class o extends r.Message{static type(){return"get-chain-infos-without-endpoints"}validateBasic(){}approveExternal(){return!0}route(){return n.ROUTE}type(){return o.type()}}t.GetChainInfosWithoutEndpointsMsg=o;class a extends r.Message{constructor(e){super(),this.chainInfo=e}static type(){return"suggest-chain-info"}validateBasic(){if(!this.chainInfo)throw new r.KeplrError("chains",100,"Chain info not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return a.type()}}t.SuggestChainInfoMsg=a;class c extends r.Message{constructor(e){super(),this.chainId=e}static type(){return"remove-suggested-chain-info"}validateBasic(){if(!this.chainId)throw new r.KeplrError("chains",101,"Chain id not set")}route(){return n.ROUTE}type(){return c.type()}}t.RemoveSuggestedChainInfoMsg=c},430:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeKeyRingNameMsg=t.InitNonDefaultLedgerAppMsg=t.ExportKeyRingDatasMsg=t.CheckPasswordMsg=t.SetKeyStoreCoinTypeMsg=t.GetIsKeyStoreCoinTypeSetMsg=t.ChangeKeyRingMsg=t.GetMultiKeyStoreInfoMsg=t.RequestSignDirectMsg=t.RequestVerifyADR36AminoSignDoc=t.RequestICNSAdr36SignaturesMsg=t.RequestSignEIP712CosmosTxMsg_v0=t.RequestSignAminoMsg=t.GetKeyMsg=t.UnlockKeyRingMsg=t.LockKeyRingMsg=t.AddLedgerKeyMsg=t.AddKeystoneKeyMsg=t.AddPrivateKeyMsg=t.CreateLedgerKeyMsg=t.CreateKeystoneKeyMsg=t.CreatePrivateKeyMsg=t.AddMnemonicKeyMsg=t.CreateMnemonicKeyMsg=t.ShowKeyRingMsg=t.UpdateNameKeyRingMsg=t.DeleteKeyRingMsg=t.RestoreKeyRingMsg=void 0;const r=i(3),n=i(798),s=i(551),o=i(9),a=i(97),c=i(295),d=i(147),u=i(2),h=i(116);class l extends r.Message{static type(){return"restore-keyring"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return l.type()}}t.RestoreKeyRingMsg=l;class p extends r.Message{constructor(e,t){super(),this.index=e,this.password=t}static type(){return"delete-keyring"}validateBasic(){if(!Number.isInteger(this.index))throw new r.KeplrError("keyring",201,"Invalid index");if(!this.password)throw new r.KeplrError("keyring",274,"password not set")}route(){return n.ROUTE}type(){return p.type()}}t.DeleteKeyRingMsg=p;class g extends r.Message{constructor(e,t){super(),this.index=e,this.name=t}static type(){return"update-name-keyring"}validateBasic(){if(!Number.isInteger(this.index))throw new r.KeplrError("keyring",201,"Invalid index");if(!this.name)throw new r.KeplrError("keyring",273,"name not set")}route(){return n.ROUTE}type(){return g.type()}}t.UpdateNameKeyRingMsg=g;class f extends r.Message{constructor(e,t){super(),this.index=e,this.password=t}static type(){return"show-keyring"}validateBasic(){if(!Number.isInteger(this.index))throw new r.KeplrError("keyring",201,"Invalid index");if(!this.password)throw new r.KeplrError("keyring",274,"password not set")}route(){return n.ROUTE}type(){return f.type()}}t.ShowKeyRingMsg=f;class y extends r.Message{constructor(e,t,i,r,n){super(),this.kdf=e,this.mnemonic=t,this.password=i,this.meta=r,this.bip44HDPath=n}static type(){return"create-mnemonic-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");if(!this.mnemonic)throw new r.KeplrError("keyring",272,"mnemonic not set");if(!this.password)throw new r.KeplrError("keyring",274,"password not set");try{c.mnemonicToEntropy(this.mnemonic)}catch(e){if("Invalid mnemonic checksum"!==e.message)throw e}s.KeyRing.validateBIP44Path(this.bip44HDPath)}route(){return n.ROUTE}type(){return y.type()}}t.CreateMnemonicKeyMsg=y;class v extends r.Message{constructor(e,t,i,r){super(),this.kdf=e,this.mnemonic=t,this.meta=i,this.bip44HDPath=r}static type(){return"add-mnemonic-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");if(!this.mnemonic)throw new r.KeplrError("keyring",272,"mnemonic not set");try{c.mnemonicToEntropy(this.mnemonic)}catch(e){if("Invalid mnemonic checksum"!==e.message)throw e}s.KeyRing.validateBIP44Path(this.bip44HDPath)}route(){return n.ROUTE}type(){return v.type()}}t.AddMnemonicKeyMsg=v;class m extends r.Message{constructor(e,t,i,r){super(),this.kdf=e,this.privateKey=t,this.password=i,this.meta=r}static type(){return"create-private-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");if(!this.privateKey||0===this.privateKey.length)throw new r.KeplrError("keyring",275,"private key not set");if(32!==this.privateKey.length)throw new r.KeplrError("keyring",260,"invalid length of private key");if(!this.password)throw new r.KeplrError("keyring",274,"password not set")}route(){return n.ROUTE}type(){return m.type()}}t.CreatePrivateKeyMsg=m;class w extends r.Message{constructor(e,t,i,r){super(),this.kdf=e,this.password=t,this.meta=i,this.bip44HDPath=r}static type(){return"create-keystone-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");if(!this.password)throw new r.KeplrError("keyring",274,"password not set");s.KeyRing.validateBIP44Path(this.bip44HDPath)}route(){return n.ROUTE}type(){return w.type()}}t.CreateKeystoneKeyMsg=w;class S extends r.Message{constructor(e,t,i,r,n){super(),this.kdf=e,this.password=t,this.meta=i,this.bip44HDPath=r,this.cosmosLikeApp=n}static type(){return"create-ledger-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");if(!this.password)throw new r.KeplrError("keyring",274,"password not set");s.KeyRing.validateBIP44Path(this.bip44HDPath)}route(){return n.ROUTE}type(){return S.type()}}t.CreateLedgerKeyMsg=S;class b extends r.Message{constructor(e,t,i){super(),this.kdf=e,this.privateKey=t,this.meta=i}static type(){return"add-private-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");if(!this.privateKey||0===this.privateKey.length)throw new r.KeplrError("keyring",275,"private key not set");if(32!==this.privateKey.length)throw new r.KeplrError("keyring",260,"invalid length of private key")}route(){return n.ROUTE}type(){return b.type()}}t.AddPrivateKeyMsg=b;class k extends r.Message{constructor(e,t,i){super(),this.kdf=e,this.meta=t,this.bip44HDPath=i}static type(){return"add-keystone-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");s.KeyRing.validateBIP44Path(this.bip44HDPath)}route(){return n.ROUTE}type(){return k.type()}}t.AddKeystoneKeyMsg=k;class _ extends r.Message{constructor(e,t,i,r){super(),this.kdf=e,this.meta=t,this.bip44HDPath=i,this.cosmosLikeApp=r}static type(){return"add-ledger-key"}validateBasic(){if("scrypt"!==this.kdf&&"sha256"!==this.kdf&&"pbkdf2"!==this.kdf)throw new r.KeplrError("keyring",202,"Invalid kdf");s.KeyRing.validateBIP44Path(this.bip44HDPath)}route(){return n.ROUTE}type(){return _.type()}}t.AddLedgerKeyMsg=_;class E extends r.Message{static type(){return"lock-keyring"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return E.type()}}t.LockKeyRingMsg=E;class P extends r.Message{constructor(e=""){super(),this.password=e}static type(){return"unlock-keyring"}validateBasic(){if(!this.password)throw new r.KeplrError("keyring",274,"password not set")}route(){return n.ROUTE}type(){return P.type()}}t.UnlockKeyRingMsg=P;class M extends r.Message{constructor(e){super(),this.chainId=e}static type(){return"get-key"}validateBasic(){if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return M.type()}}t.GetKeyMsg=M;class K extends r.Message{constructor(e,t,i,r={}){super(),this.chainId=e,this.signer=t,this.signDoc=i,this.signOptions=r}static type(){return"request-sign-amino"}validateBasic(){var e,t;if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new r.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),o.checkAndValidateADR36AminoSignDoc(this.signDoc)){if(this.signDoc.msgs[0].value.signer!==this.signer)throw new r.KeplrError("keyring",233,"Unmatched signer in sign doc");if(this.signOptions.ethSignType)switch(this.signOptions.ethSignType){case a.EthSignType.EIP712:{const i=JSON.parse(u.Buffer.from(this.signDoc.msgs[0].value.data,"base64").toString()),{ethChainId:r}=o.EthermintChainIdHelper.parse(this.chainId);if(parseFloat(null===(e=i.domain)||void 0===e?void 0:e.chainId)!==r)throw new Error(`Unmatched chain id for eth (expected: ${r}, actual: ${null===(t=i.domain)||void 0===t?void 0:t.chainId})`)}}}else{if(this.signOptions.ethSignType)throw new Error("Eth sign type can be requested with only ADR-36 amino sign doc");if(this.signDoc.chain_id!==this.chainId)throw new r.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id")}if(!this.signOptions)throw new r.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return n.ROUTE}type(){return K.type()}}t.RequestSignAminoMsg=K;class I extends r.Message{constructor(e,t,i,r,n){super(),this.chainId=e,this.signer=t,this.eip712=i,this.signDoc=r,this.signOptions=n}static type(){return"request-sign-eip-712-cosmos-tx-v0"}validateBasic(){if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new r.KeplrError("keyring",230,"signer not set");if(o.Bech32Address.validate(this.signer),o.checkAndValidateADR36AminoSignDoc(this.signDoc))throw new Error("Can't sign ADR-36 with EIP-712");{if(this.signDoc.chain_id!==this.chainId)throw new r.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id");const{ethChainId:e}=o.EthermintChainIdHelper.parse(this.chainId);if(!h.BigNumber.from(this.eip712.domain.chainId).eq(e))throw new Error(`Unmatched chain id for eth (expected: ${e}, actual: ${this.eip712.domain.chainId})`)}if(!this.signOptions)throw new r.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return n.ROUTE}type(){return I.type()}}t.RequestSignEIP712CosmosTxMsg_v0=I;class O extends r.Message{constructor(e,t,i,r,n){super(),this.chainId=e,this.contractAddress=t,this.owner=i,this.username=r,this.addressChainIds=n}static type(){return"request-icns-adr-36-signatures"}validateBasic(){if(!this.chainId)throw new Error("chain id not set");if(!this.contractAddress)throw new Error("contract address not set");if(o.Bech32Address.validate(this.contractAddress),!this.owner)throw new Error("signer not set");if(o.Bech32Address.validate(this.owner),!this.username)throw new Error("username not set");if(!this.addressChainIds||0===this.addressChainIds.length)throw new Error("address chain ids not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return O.type()}}t.RequestICNSAdr36SignaturesMsg=O;class C extends r.Message{constructor(e,t,i,r){super(),this.chainId=e,this.signer=t,this.data=i,this.signature=r}static type(){return"request-verify-adr-36-amino-doc"}validateBasic(){if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new r.KeplrError("keyring",230,"signer not set");if(!this.signature)throw new r.KeplrError("keyring",271,"Signature not set");o.Bech32Address.validate(this.signer)}approveExternal(){return!0}route(){return n.ROUTE}type(){return C.type()}}t.RequestVerifyADR36AminoSignDoc=C;class T extends r.Message{constructor(e,t,i,r={}){super(),this.chainId=e,this.signer=t,this.signDoc=i,this.signOptions=r}static type(){return"request-sign-direct"}validateBasic(){if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set");if(!this.signer)throw new r.KeplrError("keyring",230,"signer not set");o.Bech32Address.validate(this.signer);if(d.SignDoc.fromPartial({bodyBytes:this.signDoc.bodyBytes,authInfoBytes:this.signDoc.authInfoBytes,chainId:this.signDoc.chainId,accountNumber:this.signDoc.accountNumber}).chainId!==this.chainId)throw new r.KeplrError("keyring",234,"Chain id in the message is not matched with the requested chain id");if(!this.signOptions)throw new r.KeplrError("keyring",235,"Sign options are null")}approveExternal(){return!0}route(){return n.ROUTE}type(){return T.type()}}t.RequestSignDirectMsg=T;class A extends r.Message{static type(){return"get-multi-key-store-info"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return A.type()}}t.GetMultiKeyStoreInfoMsg=A;class R extends r.Message{constructor(e){super(),this.index=e}static type(){return"change-keyring"}validateBasic(){if(this.index<0)throw new r.KeplrError("keyring",200,"Index is negative");if(!Number.isInteger(this.index))throw new r.KeplrError("keyring",201,"Invalid index")}route(){return n.ROUTE}type(){return R.type()}}t.ChangeKeyRingMsg=R;class x extends r.Message{constructor(e,t){super(),this.chainId=e,this.paths=t}static type(){return"get-is-keystore-coin-type-set"}validateBasic(){if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set");if(0===this.paths.length)throw new r.KeplrError("keyring",250,"empty bip44 path list")}route(){return n.ROUTE}type(){return x.type()}}t.GetIsKeyStoreCoinTypeSetMsg=x;class D extends r.Message{constructor(e,t){super(),this.chainId=e,this.coinType=t}static type(){return"set-keystore-coin-type"}validateBasic(){if(!this.chainId)throw new r.KeplrError("keyring",270,"chain id not set");if(this.coinType<0)throw new r.KeplrError("keyring",240,"coin type can not be negative");if(!Number.isInteger(this.coinType))throw new r.KeplrError("keyring",241,"coin type should be integer")}route(){return n.ROUTE}type(){return D.type()}}t.SetKeyStoreCoinTypeMsg=D;class B extends r.Message{constructor(e){super(),this.password=e}static type(){return"check-keyring-password"}validateBasic(){if(!this.password)throw new r.KeplrError("keyring",274,"password not set")}route(){return n.ROUTE}type(){return B.type()}}t.CheckPasswordMsg=B;class j extends r.Message{constructor(e){super(),this.password=e}static type(){return"export-keyring-datas"}validateBasic(){if(!this.password)throw new r.KeplrError("keyring",274,"password not set")}route(){return n.ROUTE}type(){return j.type()}}t.ExportKeyRingDatasMsg=j;class U extends r.Message{constructor(e){super(),this.ledgerApp=e}static type(){return"init-non-default-ledger-app"}validateBasic(){if(!this.ledgerApp)throw new Error("ledger app not set")}route(){return n.ROUTE}type(){return U.type()}}t.InitNonDefaultLedgerAppMsg=U;class N extends r.Message{constructor(e,t){super(),this.defaultName=e,this.editable=t}static type(){return"change-keyring-name-msg"}validateBasic(){if(!this.defaultName)throw new Error("default name not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return N.type()}}t.ChangeKeyRingNameMsg=N},441:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetSecret20ViewingKey=t.RemoveTokenMsg=t.AddTokenMsg=t.SuggestTokenMsg=t.GetTokensMsg=void 0;const r=i(3),n=i(878);class s extends r.Message{constructor(e){super(),this.chainId=e}static type(){return"get-tokens"}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return s.type()}}t.GetTokensMsg=s;class o extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.contractAddress=t,this.viewingKey=i}static type(){return"suggest-token"}approveExternal(){return!0}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty");if(!this.contractAddress)throw new r.KeplrError("tokens",101,"Contract address is empty")}route(){return n.ROUTE}type(){return o.type()}}t.SuggestTokenMsg=o;class a extends r.Message{constructor(e,t){super(),this.chainId=e,this.currency=t}static type(){return"add-token"}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return a.type()}}t.AddTokenMsg=a;class c extends r.Message{constructor(e,t){super(),this.chainId=e,this.currency=t}static type(){return"remove-token"}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty")}route(){return n.ROUTE}type(){return c.type()}}t.RemoveTokenMsg=c;class d extends r.Message{constructor(e,t){super(),this.chainId=e,this.contractAddress=t}static type(){return"get-secret20-viewing-key"}validateBasic(){if(!this.chainId)throw new r.KeplrError("tokens",100,"Chain id is empty");if(!this.contractAddress)throw new r.KeplrError("tokens",101,"Contract address is empty")}approveExternal(){return!0}route(){return n.ROUTE}type(){return d.type()}}t.GetSecret20ViewingKey=d},481:function(e,t,i){t.pbkdf2=i(1382),t.pbkdf2Sync=i(792)},517:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseKVStore=void 0;t.BaseKVStore=class{constructor(e,t){this.provider=e,this._prefix=t}get(e){return r(this,void 0,void 0,(function*(){const t=this.prefix()+"/"+e;return(yield this.provider.get())[t]}))}set(e,t){const i=this.prefix()+"/"+e;return this.provider.set({[i]:t})}prefix(){return this._prefix}}},539:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetPersistentMemoryMsg=t.SetPersistentMemoryMsg=void 0;const r=i(3),n=i(744);class s extends r.Message{constructor(e){super(),this.data=e}static type(){return"set-persistent-memory"}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.SetPersistentMemoryMsg=s;class o extends r.Message{static type(){return"get-persistent-memory"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return o.type()}}t.GetPersistentMemoryMsg=o},543:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveGlobalPermissionOriginMsg=t.RemovePermissionOrigin=t.AddPermissionOrigin=t.GetGlobalPermissionOriginsMsg=t.GetOriginPermittedChainsMsg=t.GetPermissionOriginsMsg=t.DisableAccessMsg=t.EnableAccessMsg=void 0;const r=i(3),n=i(784);class s extends r.Message{constructor(e){super(),this.chainIds=e}static type(){return"enable-access"}validateBasic(){if(!this.chainIds||0===this.chainIds.length)throw new r.KeplrError("permission",100,"chain id not set")}route(){return n.ROUTE}approveExternal(){return!0}type(){return s.type()}}t.EnableAccessMsg=s;class o extends r.Message{constructor(e){super(),this.chainIds=e}static type(){return"disable-access"}validateBasic(){if(!this.chainIds)throw new r.KeplrError("permission",100,"chain id not set")}route(){return n.ROUTE}approveExternal(){return!0}type(){return o.type()}}t.DisableAccessMsg=o;class a extends r.Message{constructor(e,t){super(),this.chainId=e,this.permissionType=t}static type(){return"get-permission-origins"}validateBasic(){if(!this.chainId)throw new r.KeplrError("permission",100,"chain id not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type")}route(){return n.ROUTE}type(){return a.type()}}t.GetPermissionOriginsMsg=a;class c extends r.Message{constructor(e,t){super(),this.permissionOrigin=e,this.permissionType=t}static type(){return"get-origin-permitted-chains"}validateBasic(){if(!this.permissionOrigin)throw new r.KeplrError("permission",101,"origin not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type")}route(){return n.ROUTE}type(){return c.type()}}t.GetOriginPermittedChainsMsg=c;class d extends r.Message{constructor(e){super(),this.permissionType=e}static type(){return"get-global-permission-origins"}validateBasic(){if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type")}route(){return n.ROUTE}type(){return d.type()}}t.GetGlobalPermissionOriginsMsg=d;class u extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.permissionType=t,this.permissionOrigin=i}static type(){return"add-permission-origin"}validateBasic(){if(!this.chainId)throw new r.KeplrError("permission",100,"chain id not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type");if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return u.type()}}t.AddPermissionOrigin=u;class h extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.permissionType=t,this.permissionOrigin=i}static type(){return"remove-permission-origin"}validateBasic(){if(!this.chainId)throw new r.KeplrError("permission",100,"chain id not set");if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type");if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return h.type()}}t.RemovePermissionOrigin=h;class l extends r.Message{constructor(e,t){super(),this.permissionType=e,this.permissionOrigin=t}static type(){return"remove-global-permission-origin"}validateBasic(){if(!this.permissionType)throw new r.KeplrError("permission",110,"empty permission type");if(!this.permissionOrigin)throw new r.KeplrError("permission",111,"empty permission origin")}route(){return n.ROUTE}type(){return l.type()}}t.RemoveGlobalPermissionOriginMsg=l},551:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t},o=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRing=t.KeyRingStatus=void 0;const a=i(1381),c=i(69),d=i(794),u=i(553),h=i(97),l=i(3),p=i(2),g=i(9),f=i(486),y=s(i(4)),v=i(100),m=i(796),w=i(797),S=i(189);var b;!function(e){e[e.NOTLOADED=0]="NOTLOADED",e[e.EMPTY=1]="EMPTY",e[e.LOCKED=2]="LOCKED",e[e.UNLOCKED=3]="UNLOCKED"}(b=t.KeyRingStatus||(t.KeyRingStatus={}));class k{constructor(e,t,i,r,n){this.embedChainInfos=e,this.kvStore=t,this.ledgerKeeper=i,this.keystoneService=r,this.crypto=n,this.cached=new Map,this.password="",this.loaded=!1,this.keyStore=null,this.multiKeyStore=[]}static getTypeOfKeyStore(e){const t=e.type;if(null==t)return"mnemonic";if("mnemonic"!==t&&"privateKey"!==t&&"ledger"!==t&&"keystone"!==t)throw new l.KeplrError("keyring",132,"Invalid type of key store");return t}get type(){return this.keyStore?k.getTypeOfKeyStore(this.keyStore):"none"}isLocked(){return null==this.privateKey&&null==this.mnemonicMasterSeed&&null==this.ledgerPublicKeyCache&&null==this.keystonePublicKey}get privateKey(){return this._privateKey}set privateKey(e){this._privateKey=e,this._mnemonicMasterSeed=void 0,this._ledgerPublicKeyCache=void 0,this._keystonePublicKeyCache=void 0,this.cached=new Map}get mnemonicMasterSeed(){return this._mnemonicMasterSeed}set mnemonicMasterSeed(e){this._mnemonicMasterSeed=e,this._privateKey=void 0,this._ledgerPublicKeyCache=void 0,this._keystonePublicKeyCache=void 0,this.cached=new Map}get keystonePublicKey(){return this._keystonePublicKeyCache}set keystonePublicKey(e){this._keystonePublicKeyCache=e,this._mnemonicMasterSeed=void 0,this._privateKey=void 0,this._ledgerPublicKeyCache=void 0,this.cached=new Map}get ledgerPublicKeyCache(){return this._ledgerPublicKeyCache}set ledgerPublicKeyCache(e){this._mnemonicMasterSeed=void 0,this._privateKey=void 0,this._ledgerPublicKeyCache=e,this.cached=new Map}get status(){return this.loaded?this.keyStore?this.isLocked()?b.LOCKED:b.UNLOCKED:b.EMPTY:b.NOTLOADED}getKeyStoreCoinType(e){if(this.keyStore&&this.keyStore.coinTypeForChain)return this.keyStore.coinTypeForChain[g.ChainIdHelper.parse(e).identifier]}getKey(e,t,i){return this.loadKey(this.computeKeyStoreCoinType(e,t),i)}getKeyStoreMeta(e){var t;return this.keyStore&&null!=this.keyStore.meta&&null!==(t=this.keyStore.meta[e])&&void 0!==t?t:""}computeKeyStoreCoinType(e,t){var i;if(!this.keyStore)throw new l.KeplrError("keyring",130,"Key store is empty");return 60===t?60:this.keyStore.coinTypeForChain&&null!==(i=this.keyStore.coinTypeForChain[g.ChainIdHelper.parse(e).identifier])&&void 0!==i?i:t}getKeyFromCoinType(e,t){return this.loadKey(e,t)}createMnemonicKey(e,t,i,r,n){return o(this,void 0,void 0,(function*(){if(this.status!==b.EMPTY)throw new l.KeplrError("keyring",142,"Key ring is not loaded or not empty");return this.mnemonicMasterSeed=c.Mnemonic.generateMasterSeedFromMnemonic(t),this.keyStore=yield k.CreateMnemonicKeyStore(this.crypto,e,t,i,yield this.assignKeyStoreIdMeta(r),n),this.password=i,this.multiKeyStore.push(this.keyStore),yield this.save(),{status:this.status,multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}createPrivateKey(e,t,i,r){return o(this,void 0,void 0,(function*(){if(this.status!==b.EMPTY)throw new l.KeplrError("keyring",142,"Key ring is not loaded or not empty");return this.privateKey=t,this.keyStore=yield k.CreatePrivateKeyStore(this.crypto,e,t,i,yield this.assignKeyStoreIdMeta(r)),this.password=i,this.multiKeyStore.push(this.keyStore),yield this.save(),{status:this.status,multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}createKeystoneKey(e,t,i,r,n){return o(this,void 0,void 0,(function*(){if(this.status!==b.EMPTY)throw new l.KeplrError("keyring",142,"Key ring is not loaded or not empty");const s=yield this.keystoneService.getPubkey(e,n),o=yield k.CreateKeystoneKeyStore(this.crypto,t,s,i,yield this.assignKeyStoreIdMeta(r),n);return this.password=i,this.keyStore=o,this.multiKeyStore.push(this.keyStore),this.keystonePublicKey=s,yield this.save(),{status:this.status,multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}createLedgerKey(e,t,i,r,n,s){return o(this,void 0,void 0,(function*(){if(this.status!==b.EMPTY)throw new l.KeplrError("keyring",142,"Key ring is not loaded or not empty");s&&(r=Object.assign(Object.assign({},r),{__ledger__cosmos_app_like__:s}));const o=yield this.ledgerKeeper.getPublicKey(e,d.LedgerApp.Cosmos,n,s),a={[d.LedgerApp.Cosmos]:o},c=yield k.CreateLedgerKeyStore(this.crypto,t,a,i,yield this.assignKeyStoreIdMeta(r),n);return this.password=i,this.keyStore=c,this.multiKeyStore.push(this.keyStore),this.ledgerPublicKeyCache=a,yield this.save(),{status:this.status,multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}lock(){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");this.mnemonicMasterSeed=void 0,this.privateKey=void 0,this.ledgerPublicKeyCache=void 0,this.keystonePublicKey=void 0,this.password=""}unlock(e){return o(this,void 0,void 0,(function*(){if(!this.keyStore||"none"===this.type)throw new l.KeplrError("keyring",144,"Key ring not initialized");if("mnemonic"===this.type)this.mnemonicMasterSeed=c.Mnemonic.generateMasterSeedFromMnemonic(p.Buffer.from(yield a.Crypto.decrypt(this.crypto,this.keyStore,e)).toString());else if("privateKey"===this.type)this.privateKey=p.Buffer.from(p.Buffer.from(yield a.Crypto.decrypt(this.crypto,this.keyStore,e)).toString(),"hex");else if("ledger"===this.type){const t={},i=yield a.Crypto.decrypt(this.crypto,this.keyStore,e);try{const e=JSON.parse(p.Buffer.from(i).toString());Object.keys(e).forEach(i=>t[i]=p.Buffer.from(e[i],"hex"))}catch(e){t[d.LedgerApp.Cosmos]=p.Buffer.from(p.Buffer.from(i).toString(),"hex")}this.ledgerPublicKeyCache=t}else{if("keystone"!==this.type)throw new l.KeplrError("keyring",145,"Unexpected type of keyring");{const t=yield a.Crypto.decrypt(this.crypto,this.keyStore,e);try{this.keystonePublicKey=JSON.parse(p.Buffer.from(t).toString())}catch(e){throw new l.KeplrError("keyring",146,"Unexpected content of Keystone public keys")}}}this.password=e}))}save(){return o(this,void 0,void 0,(function*(){yield this.kvStore.set("key-store",this.keyStore),yield this.kvStore.set("key-multi-store",this.multiKeyStore)}))}restore(){return o(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("key-store");this.keyStore=e||null;const t=yield this.kvStore.get("key-multi-store");t?this.multiKeyStore=t:(e?(e.meta=yield this.assignKeyStoreIdMeta({}),this.multiKeyStore=[e]):this.multiKeyStore=[],yield this.save());let i=!1;this.keyStore&&("1"!==this.keyStore.version&&"1.1"!==this.keyStore.version||(i=!0,this.updateLegacyKeyStore(this.keyStore)));for(const e of this.multiKeyStore)"1"!==e.version&&"1.1"!==e.version||(i=!0,this.updateLegacyKeyStore(e));i&&(yield this.save()),this.loaded=!0}))}updateLegacyKeyStore(e){e.version="1.2";for(const t of this.embedChainInfos){const i=t.alternativeBIP44s&&t.alternativeBIP44s.length>0?t.alternativeBIP44s[0].coinType:t.bip44.coinType;e.coinTypeForChain=Object.assign(Object.assign({},e.coinTypeForChain),{[g.ChainIdHelper.parse(t.chainId).identifier]:i})}}isKeyStoreCoinTypeSet(e){if(!this.keyStore)throw new l.KeplrError("keyring",130,"Key store is empty");return this.keyStore.coinTypeForChain&&void 0!==this.keyStore.coinTypeForChain[g.ChainIdHelper.parse(e).identifier]}setKeyStoreCoinType(e,t){return o(this,void 0,void 0,(function*(){if(!this.keyStore)throw new l.KeplrError("keyring",130,"Key store is empty");if(this.keyStore.coinTypeForChain&&void 0!==this.keyStore.coinTypeForChain[g.ChainIdHelper.parse(e).identifier])throw new l.KeplrError("keyring",110,"Coin type already set");this.keyStore.coinTypeForChain=Object.assign(Object.assign({},this.keyStore.coinTypeForChain),{[g.ChainIdHelper.parse(e).identifier]:t});const i=this.multiKeyStore.find(e=>k.getKeyStoreId(e)===k.getKeyStoreId(this.keyStore));i&&(i.coinTypeForChain=Object.assign({},this.keyStore.coinTypeForChain)),yield this.save()}))}removeAllKeyStoreCoinType(e){var t,i;const r=g.ChainIdHelper.parse(e).identifier;if(this.keyStore){const e=null!==(t=this.keyStore.coinTypeForChain)&&void 0!==t?t:{};delete e[r],this.keyStore.coinTypeForChain=e}for(const e of this.multiKeyStore){const t=null!==(i=e.coinTypeForChain)&&void 0!==i?i:{};delete t[r],e.coinTypeForChain=t}this.save()}deleteKeyRing(e,t){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");if(this.password!==t)throw new l.KeplrError("keyring",121,"Invalid password");const i=this.multiKeyStore[e];if(!i)throw new l.KeplrError("keyring",130,"Key store is empty");const r=this.multiKeyStore.slice(0,e).concat(this.multiKeyStore.slice(e+1));yield a.Crypto.decrypt(this.crypto,i,t);let n=!1;return this.keyStore&&k.getKeyStoreId(i)===k.getKeyStoreId(this.keyStore)&&(r.length>0?(yield this.lock(),this.keyStore=r[0],yield this.unlock(t)):(this.keyStore=null,this.mnemonicMasterSeed=void 0,this.privateKey=void 0,this.ledgerPublicKeyCache=void 0),n=!0),this.multiKeyStore=r,yield this.save(),{multiKeyStoreInfo:this.getMultiKeyStoreInfo(),keyStoreChanged:n}}))}updateNameKeyRing(e,t){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");const i=this.multiKeyStore[e];if(!i)throw new l.KeplrError("keyring",130,"Key store is empty");return i.meta=Object.assign(Object.assign({},i.meta),{name:t}),this.keyStore&&k.getKeyStoreId(this.keyStore)===k.getKeyStoreId(i)&&(this.keyStore=i),yield this.save(),this.getMultiKeyStoreInfo()}))}loadKey(e,t=!1){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");if(!this.keyStore)throw new l.KeplrError("keyring",130,"Key store is empty");if("ledger"===this.keyStore.type){if(!this.ledgerPublicKeyCache)throw new l.KeplrError("keyring",150,"Ledger public key not set");if(t){const e=this.ensureLedgerPublicKey(d.LedgerApp.Ethereum),t=v.computeAddress(e);return{algo:"ethsecp256k1",pubKey:e,address:p.Buffer.from(t.replace("0x",""),"hex"),isKeystone:!1,isNanoLedger:!0}}const e=new c.PubKeySecp256k1(this.ensureLedgerPublicKey(d.LedgerApp.Cosmos));return{algo:"secp256k1",pubKey:e.toBytes(),address:e.getAddress(),isKeystone:!1,isNanoLedger:!0}}if("keystone"===this.keyStore.type){if(!this.keystonePublicKey||0===this.keystonePublicKey.keys.length)throw new l.KeplrError("keyring",160,"Keystone public key not set");const i=this.keystonePublicKey.keys.find(t=>t.coinType===e);if(!i)throw new l.KeplrError("keyring",161,"CoinType is not available");if(t){const e=S.publicKeyConvert(p.Buffer.from(i.pubKey,"hex"),!0),t=v.computeAddress(e);return{algo:"ethsecp256k1",pubKey:e,address:p.Buffer.from(t.replace(/^0x/,""),"hex"),isKeystone:!0,isNanoLedger:!1}}const r=new c.PubKeySecp256k1(p.Buffer.from(i.pubKey,"hex"));return{algo:"secp256k1",pubKey:r.toBytes(),address:r.getAddress(),isKeystone:!0,isNanoLedger:!1}}{const i=this.loadPrivKey(e),r=i.getPubKey();if(t){const e=new f.Wallet(i.toBytes());return{algo:"ethsecp256k1",pubKey:r.toBytes(),address:p.Buffer.from(e.address.replace("0x",""),"hex"),isKeystone:!1,isNanoLedger:!1}}return{algo:"secp256k1",pubKey:r.toBytes(),address:r.getAddress(),isKeystone:!1,isNanoLedger:!1}}}loadPrivKey(e){if(this.status!==b.UNLOCKED||"none"===this.type||!this.keyStore)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");const t=k.getKeyStoreBIP44Path(this.keyStore);if("mnemonic"===this.type){const i=`m/44'/${e}'/${t.account}'/${t.change}/${t.addressIndex}`,r=this.cached.get(i);if(r)return new c.PrivKeySecp256k1(r);if(!this.mnemonicMasterSeed)throw new l.KeplrError("keyring",133,"Key store type is mnemonic and it is unlocked. But, mnemonic is not loaded unexpectedly");const n=c.Mnemonic.generatePrivateKeyFromMasterSeed(this.mnemonicMasterSeed,i);return this.cached.set(i,n),new c.PrivKeySecp256k1(n)}if("privateKey"===this.type){if(!this.privateKey)throw new l.KeplrError("keyring",134,"Key store type is private key and it is unlocked. But, private key is not loaded unexpectedly");return new c.PrivKeySecp256k1(this.privateKey)}throw new l.KeplrError("keyring",145,"Unexpected type of keyring")}sign(e,t,i,r,n,s=u.SignMode.Amino){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");if(!this.keyStore)throw new l.KeplrError("keyring",130,"Key store is empty");if("ledger"===this.keyStore.type){if(!this.ledgerPublicKeyCache)throw new l.KeplrError("keyring",151,"Ledger public key is not initialized");if(n)throw new Error("Can't sign cosmos sign doc by ethereum app on ledger");const t=(this.keyStore.meta?this.keyStore.meta.__ledger__cosmos_app_like__:void 0)||"Cosmos";return yield this.ledgerKeeper.sign(e,k.getKeyStoreBIP44Path(this.keyStore),yield this.ensureLedgerPublicKey(d.LedgerApp.Cosmos),r,t)}if("keystone"===this.keyStore.type){const o=this.computeKeyStoreCoinType(t,i);if(n){const i=g.EthermintChainIdHelper.parse(t).ethChainId;return yield this.keystoneService.signEvm(e,o,k.getKeyStoreBIP44Path(this.keyStore),this.loadKey(o,!0),this.keystonePublicKey,r,s,i)}return yield this.keystoneService.sign(e,o,k.getKeyStoreBIP44Path(this.keyStore),this.loadKey(o,n),this.keystonePublicKey,r,s)}{const e=this.computeKeyStoreCoinType(t,i),s=this.loadPrivKey(e),o=n?s.signDigest32(c.Hash.keccak256(r)):s.sign(r);return this.isKeyStoreCoinTypeSet(t)||(yield this.setKeyStoreCoinType(t,e)),o}}))}signEthereum(e,t,i,r,n){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");if(!this.keyStore)throw new l.KeplrError("keyring",130,"Key store is empty");if("ledger"===this.keyStore.type){if(!this.ledgerPublicKeyCache)throw new l.KeplrError("keyring",151,"Ledger public key is not initialized");return this.ledgerKeeper.signEthereum(e,n,k.getKeyStoreBIP44Path(this.keyStore),yield this.ensureLedgerPublicKey(d.LedgerApp.Ethereum),r)}if("keystone"===this.keyStore.type){const s=this.computeKeyStoreCoinType(t,i);return this.keystoneService.signEthereum(e,s,t,k.getKeyStoreBIP44Path(this.keyStore),this.loadKey(s,!0),this.keystonePublicKey,r,n)}const s=this.computeKeyStoreCoinType(t,i),o=this.loadPrivKey(s),a=new f.Wallet(o.toBytes());switch(n){case h.EthSignType.MESSAGE:{const e=yield a.signMessage(r);return y.arrayify(e)}case h.EthSignType.TRANSACTION:{const e=yield a.signTransaction(JSON.parse(p.Buffer.from(r).toString()));return y.arrayify(e)}case h.EthSignType.EIP712:{const e=yield m.EIP712MessageValidator.validateAsync(JSON.parse(p.Buffer.from(r).toString())),t=yield a._signingKey().signDigest(c.Hash.keccak256(p.Buffer.concat([p.Buffer.from("19","hex"),p.Buffer.from("01","hex"),p.Buffer.from(w.domainHash(e).replace("0x",""),"hex"),p.Buffer.from(w.messageHash(e).replace("0x",""),"hex")])));return p.Buffer.concat([p.Buffer.from(t.r.replace("0x",""),"hex"),p.Buffer.from(t.s.replace("0x",""),"hex"),t.recoveryParam?p.Buffer.from("1c","hex"):p.Buffer.from("1b","hex")])}default:throw new Error("Unknown sign type: "+n)}}))}showKeyRing(e,t){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED)throw new l.KeplrError("keyring",143,"Key ring is not unlocked");if(this.password!==t)throw new l.KeplrError("keyring",121,"Invalid password");const i=this.multiKeyStore[e];if(!i)throw new l.KeplrError("keyring",130,"Key store is empty");return i.type,p.Buffer.from(yield a.Crypto.decrypt(this.crypto,i,t)).toString()}))}get canSetPath(){return"mnemonic"===this.type||"ledger"===this.type}addMnemonicKey(e,t,i,r){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED||""==this.password)throw new l.KeplrError("keyring",141,"Key ring is locked or not initialized");const n=yield k.CreateMnemonicKeyStore(this.crypto,e,t,this.password,yield this.assignKeyStoreIdMeta(i),r);return this.multiKeyStore.push(n),yield this.save(),{multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}addPrivateKey(e,t,i){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED||""==this.password)throw new l.KeplrError("keyring",141,"Key ring is locked or not initialized");const r=yield k.CreatePrivateKeyStore(this.crypto,e,t,this.password,yield this.assignKeyStoreIdMeta(i));return this.multiKeyStore.push(r),yield this.save(),{multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}addKeystoneKey(e,t,i,r){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED||""==this.password)throw new l.KeplrError("keyring",141,"Key ring is locked or not initialized");const n=yield this.keystoneService.getPubkey(e,r),s=yield k.CreateKeystoneKeyStore(this.crypto,t,n,this.password,yield this.assignKeyStoreIdMeta(i),r);return this.multiKeyStore.push(s),yield this.save(),{multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}addLedgerKey(e,t,i,r,n){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED||""==this.password)throw new l.KeplrError("keyring",141,"Key ring is locked or not initialized");n&&(i=Object.assign(Object.assign({},i),{__ledger__cosmos_app_like__:n}));const s=yield this.ledgerKeeper.getPublicKey(e,d.LedgerApp.Cosmos,r,n),o={[d.LedgerApp.Cosmos]:s},a=yield k.CreateLedgerKeyStore(this.crypto,t,o,this.password,yield this.assignKeyStoreIdMeta(i),r);return this.multiKeyStore.push(a),yield this.save(),{multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}changeKeyStoreFromMultiKeyStore(e){return o(this,void 0,void 0,(function*(){if(this.status!==b.UNLOCKED||""==this.password)throw new l.KeplrError("keyring",141,"Key ring is locked or not initialized");const t=this.multiKeyStore[e];if(!t)throw new l.KeplrError("keyring",120,"Invalid keystore");return this.keyStore=t,yield this.unlock(this.password),yield this.save(),{multiKeyStoreInfo:this.getMultiKeyStoreInfo()}}))}getMultiKeyStoreInfo(){const e=[];for(const t of this.multiKeyStore)e.push({version:t.version,type:t.type,meta:t.meta,coinTypeForChain:t.coinTypeForChain,bip44HDPath:t.bip44HDPath,selected:!!this.keyStore&&k.getKeyStoreId(t)===k.getKeyStoreId(this.keyStore)});return e}checkPassword(e){if(!this.password)throw new l.KeplrError("keyring",100,"Keyring is locked");return this.password===e}exportKeyRingDatas(e){var t,i,r,n,s;return o(this,void 0,void 0,(function*(){if(!this.password)throw new l.KeplrError("keyring",100,"Keyring is locked");if(this.password!==e)throw new l.KeplrError("keyring",121,"Invalid password");const o=[];for(const c of this.multiKeyStore){switch(null!==(t=c.type)&&void 0!==t?t:"mnemonic"){case"mnemonic":{const t=p.Buffer.from(yield a.Crypto.decrypt(this.crypto,c,e)).toString();o.push({bip44HDPath:null!==(i=c.bip44HDPath)&&void 0!==i?i:{account:0,change:0,addressIndex:0},coinTypeForChain:c.coinTypeForChain,key:t,meta:null!==(r=c.meta)&&void 0!==r?r:{},type:"mnemonic"});break}case"privateKey":{const t=p.Buffer.from(yield a.Crypto.decrypt(this.crypto,c,e)).toString();o.push({bip44HDPath:null!==(n=c.bip44HDPath)&&void 0!==n?n:{account:0,change:0,addressIndex:0},coinTypeForChain:c.coinTypeForChain,key:t,meta:null!==(s=c.meta)&&void 0!==s?s:{},type:"privateKey"});break}}}return o}))}static CreateMnemonicKeyStore(e,t,i,r,n,s){return o(this,void 0,void 0,(function*(){return yield a.Crypto.encrypt(e,t,"mnemonic",i,r,n,s)}))}static CreatePrivateKeyStore(e,t,i,r,n){return o(this,void 0,void 0,(function*(){return yield a.Crypto.encrypt(e,t,"privateKey",p.Buffer.from(i).toString("hex"),r,n)}))}static CreateKeystoneKeyStore(e,t,i,r,n,s){return o(this,void 0,void 0,(function*(){return yield a.Crypto.encrypt(e,t,"keystone",JSON.stringify(i),r,n,s)}))}static CreateLedgerKeyStore(e,t,i,r,n,s){return o(this,void 0,void 0,(function*(){const o={};return Object.keys(i).filter(e=>null!=i[e]).forEach(e=>o[e]=p.Buffer.from(i[e]).toString("hex")),yield a.Crypto.encrypt(e,t,"ledger",JSON.stringify(o),r,n,s)}))}assignKeyStoreIdMeta(e){return o(this,void 0,void 0,(function*(){return Object.assign({},e,{__id__:(yield this.getIncrementalNumber()).toString()})}))}static getKeyStoreId(e){var t;const i=null===(t=e.meta)||void 0===t?void 0:t.__id__;if(!i)throw new l.KeplrError("keyring",131,"Key store's id is empty");return i}static getKeyStoreBIP44Path(e){return e.bip44HDPath?(k.validateBIP44Path(e.bip44HDPath),e.bip44HDPath):{account:0,change:0,addressIndex:0}}static validateBIP44Path(e){if(!Number.isInteger(e.account)||e.account<0)throw new l.KeplrError("keyring",100,"Invalid account in hd path");if(!Number.isInteger(e.change)||0!==e.change&&1!==e.change)throw new l.KeplrError("keyring",102,"Invalid change in hd path");if(!Number.isInteger(e.addressIndex)||e.addressIndex<0)throw new l.KeplrError("keyring",101,"Invalid address index in hd path")}getIncrementalNumber(){return o(this,void 0,void 0,(function*(){let e=yield this.kvStore.get("incrementalNumber");return void 0===e&&(e=0),e++,yield this.kvStore.set("incrementalNumber",e),e}))}throwErrorIfEthermintWithLedgerButNotSupported(e){if(this.keyStore&&"ledger"===this.keyStore.type&&!e.startsWith("evmos_")&&!e.startsWith("injective"))throw new l.KeplrError("keyring",152,"Ledger is unsupported for this chain")}ensureLedgerPublicKey(e){if(!this.keyStore)throw new l.KeplrError("keyring",130,"Keystore is empty");if("ledger"!==this.keyStore.type)throw new Error("Keystore is not ledger");if(!this.ledgerPublicKeyCache)throw new l.KeplrError("keyring",150,"Ledger not initialized");const t=this.ledgerPublicKeyCache[e];if(t)return t;throw new l.KeplrError("keyring",901,"No Ethereum public key. Initialize Ethereum app on Ledger by selecting the chain in the extension")}initializeNonDefaultLedgerApp(e,t){var i,r;return o(this,void 0,void 0,(function*(){if(!this.keyStore)throw new l.KeplrError("keyring",130,"Keystore is empty");if("ledger"!==this.keyStore.type)throw new Error("Keystore is not ledger");if(!this.ledgerPublicKeyCache)throw new l.KeplrError("keyring",150,"Ledger not initialized");if(this.ledgerPublicKeyCache[t])throw new Error(`Ledger app (${t}) has been initialized`);const n=yield this.ledgerKeeper.getPublicKey(e,t,k.getKeyStoreBIP44Path(this.keyStore)),s=Object.assign(Object.assign({},this.ledgerPublicKeyCache),{[t]:n}),o=yield k.CreateLedgerKeyStore(this.crypto,this.keyStore.crypto.kdf,s,this.password,null!==(i=this.keyStore.meta)&&void 0!==i?i:{},null!==(r=this.keyStore.bip44HDPath)&&void 0!==r?r:{account:0,change:0,addressIndex:0});let a;if(this.multiKeyStore.forEach((e,t)=>{this.keyStore&&k.getKeyStoreId(this.keyStore)===k.getKeyStoreId(e)&&(a=t)}),void 0===a)throw new Error("Could not find keystore in keyring");return this.ledgerPublicKeyCache=s,this.keyStore=o,this.multiKeyStore[a]=o,this.save(),n}))}}t.KeyRing=k},552:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TryLedgerInitMsg=t.LedgerSetWebHIDFlagMsg=t.LedgerGetWebHIDFlagMsg=void 0;const r=i(3),n=i(795);class s extends r.Message{static type(){return"ledger-get-webhid-flag"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.LedgerGetWebHIDFlagMsg=s;class o extends r.Message{constructor(e){super(),this.flag=e}static type(){return"ledger-set-webhid-flag"}validateBasic(){if(null==this.flag)throw new r.KeplrError("ledger",101,"Flag is null")}route(){return n.ROUTE}type(){return o.type()}}t.LedgerSetWebHIDFlagMsg=o;class a extends r.Message{constructor(e,t){super(),this.ledgerApp=e,this.cosmosLikeApp=t}static type(){return"try-ledger-init"}validateBasic(){}route(){return n.ROUTE}type(){return a.type()}}t.TryLedgerInitMsg=a},553:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignMode=void 0,function(e){e.Amino="amino",e.Direct="direct",e.Message="message"}(t.SignMode||(t.SignMode={}))},555:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_DESCRIPTION=t.ERROR_CODE=t.P2_VALUES=t.PAYLOAD_TYPE=t.INS=t.APP_KEY=t.CHUNK_SIZE=t.CLA=void 0,t.CLA=85,t.CHUNK_SIZE=250,t.APP_KEY="CSM",t.INS={GET_VERSION:0,INS_PUBLIC_KEY_SECP256K1:1,SIGN_SECP256K1:2,GET_ADDR_SECP256K1:4},t.PAYLOAD_TYPE={INIT:0,ADD:1,LAST:2},t.P2_VALUES={JSON:0,TEXTUAL:1},t.ERROR_CODE={NoError:36864},t.ERROR_DESCRIPTION={1:"U2F: Unknown",2:"U2F: Bad request",3:"U2F: Configuration unsupported",4:"U2F: Device Ineligible",5:"U2F: Timeout",14:"Timeout",36864:"No errors",36865:"Device is busy",26626:"Error deriving keys",25600:"Execution Error",26368:"Wrong Length",27010:"Empty Buffer",27011:"Output buffer too small",27012:"Data is invalid",27013:"Conditions not satisfied",27014:"Transaction rejected",27264:"Bad key handle",27392:"Invalid P1/P2",27904:"Instruction not supported",28160:"App does not seem to be open",28416:"Unknown error",28417:"Sign/verify error"}},601:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetTxEncryptionKeyMsg=t.RequestDecryptMsg=t.ReqeustEncryptMsg=t.GetPubkeyMsg=void 0;const r=i(3),n=i(872);class s extends r.Message{constructor(e){super(),this.chainId=e}static type(){return"get-pubkey-msg"}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return s.type()}}t.GetPubkeyMsg=s;class o extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.contractCodeHash=t,this.msg=i}static type(){return"request-encrypt-msg"}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set");if(!this.contractCodeHash)throw new r.KeplrError("secret-wasm",103,"contract code hash not set");if(!this.msg)throw new r.KeplrError("secret-wasm",101,"msg not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return o.type()}}t.ReqeustEncryptMsg=o;class a extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.cipherText=t,this.nonce=i}static type(){return"request-decrypt-msg"}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set");if(!this.cipherText||0===this.cipherText.length)throw new r.KeplrError("secret-wasm",102,"ciphertext not set");if(!this.nonce||0===this.nonce.length)throw new r.KeplrError("secret-wasm",110,"nonce not set")}approveExternal(){return!0}route(){return n.ROUTE}type(){return a.type()}}t.RequestDecryptMsg=a;class c extends r.Message{constructor(e,t){super(),this.chainId=e,this.nonce=t}static type(){return"get-tx-encryption-key-msg"}validateBasic(){if(!this.chainId)throw new r.KeplrError("secret-wasm",100,"chain id not set");if(!this.nonce)throw new r.KeplrError("secret-wasm",111,"nonce is null")}approveExternal(){return!0}route(){return n.ROUTE}type(){return c.type()}}t.GetTxEncryptionKeyMsg=c},602:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendTxMsg=void 0;const r=i(3),n=i(874);class s extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.tx=t,this.mode=i}static type(){return"send-tx-to-background"}validateBasic(){if(!this.chainId)throw new r.KeplrError("tx",100,"chain id is empty");if(!this.tx)throw new r.KeplrError("tx",101,"tx is empty");if(!this.mode||"sync"!==this.mode&&"async"!==this.mode&&"block"!==this.mode)throw new r.KeplrError("tx",120,"invalid mode")}approveExternal(){return!0}route(){return n.ROUTE}type(){return s.type()}}t.SendTxMsg=s},603:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResetChainEndpointsMsg=t.SetChainEndpointsMsg=t.TryUpdateChainMsg=void 0;const r=i(3),n=i(876);class s extends r.Message{constructor(e){super(),this.chainId=e}static type(){return"try-update-chain"}validateBasic(){if(!this.chainId)throw new r.KeplrError("updater",100,"Empty chain id")}route(){return n.ROUTE}type(){return s.type()}}t.TryUpdateChainMsg=s;class o extends r.Message{constructor(e,t,i){super(),this.chainId=e,this.rpc=t,this.rest=i}static type(){return"set-chain-endpoints"}validateBasic(){if(!this.chainId)throw new r.KeplrError("updater",100,"Empty chain id");if(this.rpc){const e=new URL(this.rpc);if("http:"!==e.protocol&&"https:"!==e.protocol)throw new Error("RPC has invalid protocol: "+e.protocol)}if(this.rest){const e=new URL(this.rest);if("http:"!==e.protocol&&"https:"!==e.protocol)throw new Error("LCD has invalid protocol: "+e.protocol)}}route(){return n.ROUTE}type(){return o.type()}}t.SetChainEndpointsMsg=o;class a extends r.Message{constructor(e){super(),this.chainId=e}static type(){return"reset-chain-endpoints"}validateBasic(){if(!this.chainId)throw new r.KeplrError("updater",100,"Empty chain id")}route(){return n.ROUTE}type(){return a.type()}}t.ResetChainEndpointsMsg=a},604:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PushEventDataMsg=t.PushInteractionDataMsg=void 0;const r=i(3),n=i(882);class s extends r.Message{constructor(e){super(),this.data=e}static type(){return"push-interaction-data"}validateBasic(){if(!this.data.type)throw new r.KeplrError("interaction",101,"Type should not be empty")}route(){return n.ROUTE}type(){return s.type()}}t.PushInteractionDataMsg=s;class o extends r.Message{constructor(e){super(),this.data=e}static type(){return"push-event-data"}validateBasic(){if(!this.data.type)throw new r.KeplrError("interaction",101,"Type should not be empty")}route(){return n.ROUTE}type(){return o.type()}}t.PushEventDataMsg=o},605:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RejectInteractionMsg=t.ApproveInteractionMsg=void 0;const r=i(3),n=i(883);class s extends r.Message{constructor(e,t){super(),this.id=e,this.result=t}static type(){return"approve-interaction"}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.ApproveInteractionMsg=s;class o extends r.Message{constructor(e){super(),this.id=e}static type(){return"reject-interaction"}validateBasic(){}route(){return n.ROUTE}type(){return o.type()}}t.RejectInteractionMsg=o},606:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CheckBadTwitterIdMsg=t.URLTempAllowMsg=t.CheckURLIsPhishingMsg=void 0;const r=i(3),n=i(886),s=i(885);class o extends r.Message{static type(){return"check-url-is-phishing"}constructor(){super()}validateBasic(){const e=new URL(this.origin);s.parseDomainUntilSecondLevel(e.origin)}approveExternal(){return!0}route(){return n.ROUTE}type(){return o.type()}}t.CheckURLIsPhishingMsg=o;class a extends r.Message{constructor(e){super(),this.url=e}static type(){return"url-temp-allow"}validateBasic(){const e=new URL(this.url);s.parseDomainUntilSecondLevel(e.origin)}route(){return n.ROUTE}type(){return a.type()}}t.URLTempAllowMsg=a;class c extends r.Message{constructor(e){super(),this.id=e}static type(){return"check-bad-twitter-id"}validateBasic(){}approveExternal(){return!0}route(){return n.ROUTE}type(){return c.type()}}t.CheckBadTwitterIdMsg=c},607:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StartAutoLockMonitoringMsg=t.UpdateAutoLockAccountDurationMsg=t.GetAutoLockAccountDurationMsg=void 0;const r=i(3),n=i(888);class s extends r.Message{static type(){return"get-auto-lock-account-duration"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return s.type()}}t.GetAutoLockAccountDurationMsg=s;class o extends r.Message{constructor(e){super(),this.duration=e}static type(){return"update-auto-lock-account-duration"}validateBasic(){if(this.duration<0)throw new r.KeplrError("auto-lock-account",101,"duration cannot be set to a negative number.")}route(){return n.ROUTE}type(){return o.type()}}t.UpdateAutoLockAccountDurationMsg=o;class a extends r.Message{static type(){return"start-auto-lock-monitoring"}constructor(){super()}validateBasic(){}route(){return n.ROUTE}type(){return a.type()}}t.StartAutoLockMonitoringMsg=a},608:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN=t.KEPLR_EXT_ANALYTICS_API_URL=t.ROUTE=void 0,t.ROUTE="analytics",t.KEPLR_EXT_ANALYTICS_API_URL="https://analytics.keplr.app",t.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN="D7THUjkEo3f_u!3eBfi"},609:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetAnalyticsIdMsg=void 0;const r=i(3),n=i(608);class s extends r.Message{static type(){return"get-analytics-id"}constructor(){super()}validateBasic(){}approveExternal(){return!0}route(){return n.ROUTE}type(){return s.type()}}t.GetAnalyticsIdMsg=s},69:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1136),t),n(i(1200),t),n(i(742),t)},742:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hash=void 0;const r=i(259),n=i(2155),s=i(2);t.Hash=class{static sha256(e){return new Uint8Array((new r.sha256).update(e).digest())}static keccak256(e){return s.Buffer.from(n.keccak256(e).replace("0x",""),"hex")}static truncHashPortion(e,t=e.length,i=0){return e.substring(0,t)+""+e.substring(e.length-i,e.length)}}},743:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PersistentMemoryService=void 0;t.PersistentMemoryService=class{constructor(){this.data={}}init(){}set(e){this.data=Object.assign(Object.assign({},this.data),e)}get(){return this.data}}},744:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="persistent-memory"},745:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainsService=void 0;const n=i(21),s=i(3),o=i(421),a=i(9),c=i(272),d=i(781);t.ChainsService=class{constructor(e,t,i={}){this.kvStore=e,this.embedChainInfos=t,this.experimentalOptions=i,this.onChainRemovedHandlers=[],this.getChainInfos=n.Debouncer.promise(()=>r(this,void 0,void 0,(function*(){if(this.cachedChainInfos)return this.cachedChainInfos;const e=this.embedChainInfos.map(e=>Object.assign(Object.assign({},e),{embeded:!0})),t=new Map;for(const i of e)t.set(a.ChainIdHelper.parse(i.chainId).identifier,!0);const i=(yield this.getSuggestedChainInfos()).filter(e=>!t.get(a.ChainIdHelper.parse(e.chainId).identifier)).map(e=>Object.assign(Object.assign({},e),{embeded:!1}));let n=e.concat(i);return n=yield Promise.all(n.map(e=>r(this,void 0,void 0,(function*(){const t=yield this.chainUpdaterService.replaceChainInfo(e);return Object.assign(Object.assign({},t),{embeded:e.embeded})})))),this.cachedChainInfos=n,n}))),(null==i?void 0:i.useMemoryKVStoreForSuggestChain)?this.kvStoreForSuggestChain=new n.MemoryKVStore("suggest-chain"):this.kvStoreForSuggestChain=e}init(e,t,i){this.chainUpdaterService=e,this.interactionService=t,this.permissionService=i}getChainInfosWithoutEndpoints(){return r(this,void 0,void 0,(function*(){return(yield this.getChainInfos()).map(e=>{const t=Object.assign({},e);return delete t.rpc,delete t.rpcConfig,delete t.rest,delete t.restConfig,delete t.nodeProvider,delete t.updateFromRepoDisabled,delete t.embeded,t})}))}clearCachedChainInfos(){this.cachedChainInfos=void 0}getChainInfo(e){return r(this,void 0,void 0,(function*(){const t=(yield this.getChainInfos()).find(t=>a.ChainIdHelper.parse(t.chainId).identifier===a.ChainIdHelper.parse(e).identifier);if(!t)throw new s.KeplrError("chains",411,"There is no chain info for "+e);return t}))}getChainCoinType(e){return r(this,void 0,void 0,(function*(){const t=yield this.getChainInfo(e);if(!t)throw new s.KeplrError("chains",411,"There is no chain info for "+e);return t.bip44.coinType}))}hasChainInfo(e){return r(this,void 0,void 0,(function*(){return null!=(yield this.getChainInfos()).find(t=>a.ChainIdHelper.parse(t.chainId).identifier===a.ChainIdHelper.parse(e).identifier)}))}suggestChainInfo(e,t,i){return r(this,void 0,void 0,(function*(){t=yield c.validateBasicChainInfoType(t);let r=yield this.interactionService.waitApprove(e,"/suggest-chain",o.SuggestChainInfoMsg.type(),{chainInfo:t,origin:i});r=Object.assign(Object.assign({},yield c.validateBasicChainInfoType(r)),{beta:t.beta,updateFromRepoDisabled:r.updateFromRepoDisabled}),r.updateFromRepoDisabled?console.log(`Chain ${r.chainName}(${r.chainId}) added with updateFromRepoDisabled`):console.log(`Chain ${r.chainName}(${r.chainId}) added`),yield this.permissionService.addPermission([t.chainId],d.getBasicAccessPermissionType(),[i]),yield this.addChainInfo(r)}))}getSuggestedChainInfos(){var e;return r(this,void 0,void 0,(function*(){return null!==(e=yield this.kvStoreForSuggestChain.get("chain-infos"))&&void 0!==e?e:[]}))}addChainInfo(e){var t;return r(this,void 0,void 0,(function*(){if(yield this.hasChainInfo(e.chainId))throw new s.KeplrError("chains",121,"Same chain is already registered");const i=null!==(t=yield this.kvStoreForSuggestChain.get("chain-infos"))&&void 0!==t?t:[];i.push(e),yield this.kvStoreForSuggestChain.set("chain-infos",i),this.clearCachedChainInfos()}))}removeChainInfo(e){var t;return r(this,void 0,void 0,(function*(){if(!(yield this.hasChainInfo(e)))throw new s.KeplrError("chains",120,"Chain is not registered");if((yield this.getChainInfo(e)).embeded)throw new s.KeplrError("chains",122,"Can't remove the embedded chain");const i=(null!==(t=yield this.kvStoreForSuggestChain.get("chain-infos"))&&void 0!==t?t:[]).filter(t=>a.ChainIdHelper.parse(t.chainId).identifier!==a.ChainIdHelper.parse(e).identifier);yield this.kvStoreForSuggestChain.set("chain-infos",i),yield this.chainUpdaterService.clearUpdatedProperty(e);for(const t of this.onChainRemovedHandlers)t(e,a.ChainIdHelper.parse(e).identifier);this.clearCachedChainInfos()}))}getChainEthereumKeyFeatures(e){var t,i,n,s;return r(this,void 0,void 0,(function*(){const r=yield this.getChainInfo(e);return{address:null!==(i=null===(t=r.features)||void 0===t?void 0:t.includes("eth-address-gen"))&&void 0!==i&&i,signing:null!==(s=null===(n=r.features)||void 0===n?void 0:n.includes("eth-key-sign"))&&void 0!==s&&s}}))}addChainRemovedHandler(e){this.onChainRemovedHandlers.push(e)}}},746:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="chains"},750:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&r(t,e,i);return n(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Bech32Address=void 0;const o=s(i(541)),a=i(2),c=i(279);class d{constructor(e){this.address=e}static shortenAddress(e,t){if(t>=e.length)return e;const i=e.indexOf("1"),r=e.slice(0,i),n=e.slice(i+1);if(t-=r.length,t-=3,(t-=1)<=0)return"";const s=Math.floor(n.length/2);let o=n.slice(0,s),a=n.slice(s);for(;t<o.length+a.length;)(o.length+a.length)%2==1&&o.length>0?o=o.slice(0,o.length-1):a=a.slice(1);return r+"1"+o+"..."+a}static fromBech32(e,t){const i=o.default.decode(e);if(t&&i.prefix!==t)throw new Error("Unmatched prefix");return new d(new Uint8Array(o.fromWords(i.words)))}static validate(e,t){const{prefix:i}=o.default.decode(e);if(t&&t!==i)throw new Error(`Unexpected prefix (expected: ${t}, actual: ${i})`)}static defaultBech32Config(e,t="val",i="cons",r="pub",n="oper"){return{bech32PrefixAccAddr:e,bech32PrefixAccPub:e+r,bech32PrefixValAddr:e+t+n,bech32PrefixValPub:e+t+n+r,bech32PrefixConsAddr:e+t+i,bech32PrefixConsPub:e+t+i+r}}toBech32(e){const t=o.default.toWords(this.address);return o.default.encode(e,t)}toHex(e=!0){const t=a.Buffer.from(this.address).toString("hex");if(0===t.length)throw new Error("Empty address");return e?c.getAddress("0x"+t):"0x"+t}}t.Bech32Address=d},751:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChainIdHelper=void 0;class r{static parse(e){const t=e.split(r.VersionFormatRegExp).filter(Boolean);return 2!==t.length?{identifier:e,version:0}:{identifier:t[0],version:parseInt(t[1])}}static hasChainVersion(e){return r.parse(e).identifier!==e}}t.ChainIdHelper=r,r.VersionFormatRegExp=/(.+)-([\d]+)/},752:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProtoCodec=t.ProtoCodec=void 0;const s=i(753),o=i(756),a=i(758),c=i(759),d=i(761),u=i(762),h=i(763),l=i(764);n(i(764),t);class p{constructor(){this.typeUrlMap=new Map}unpackAny(e){if(!this.typeUrlMap.has(e.typeUrl))return new l.UnknownMessage(e.typeUrl,e.value);const t=this.typeUrlMap.get(e.typeUrl),i=t.decode(e.value);return Object.assign(Object.assign({},e),{unpacked:i,factory:t})}registerAny(e,t){this.typeUrlMap.set(e,t)}}t.ProtoCodec=p,t.defaultProtoCodec=new p,t.defaultProtoCodec.registerAny("/cosmos.bank.v1beta1.MsgSend",s.MsgSend),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgDelegate",o.MsgDelegate),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgUndelegate",o.MsgUndelegate),t.defaultProtoCodec.registerAny("/cosmos.staking.v1beta1.MsgBeginRedelegate",o.MsgBeginRedelegate),t.defaultProtoCodec.registerAny("/cosmwasm.wasm.v1.MsgExecuteContract",u.MsgExecuteContract),t.defaultProtoCodec.registerAny("/cosmwasm.wasm.v1.MsgInstantiateContract",u.MsgInstantiateContract),t.defaultProtoCodec.registerAny("/cosmos.distribution.v1beta1.MsgWithdrawDelegatorReward",d.MsgWithdrawDelegatorReward),t.defaultProtoCodec.registerAny("/ibc.applications.transfer.v1.MsgTransfer",h.MsgTransfer),t.defaultProtoCodec.registerAny("/cosmos.gov.v1beta1.MsgVote",c.MsgVote),t.defaultProtoCodec.registerAny("/cosmos.authz.v1beta1.MsgGrant",a.MsgGrant),t.defaultProtoCodec.registerAny("/cosmos.authz.v1beta1.MsgRevoke",a.MsgRevoke)},764:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownMessage=void 0;const r=i(2);t.UnknownMessage=class{constructor(e,t){this._typeUrl=e,this._value=t}get typeUrl(){return this._typeUrl}get value(){return this._value}toJSON(){return{type_url:this._typeUrl,value:r.Buffer.from(this._value).toString("base64")}}}},765:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProtoSignDocDecoder=void 0;const r=i(147),n=i(752);class s{constructor(e,t=n.defaultProtoCodec){this.signDoc=e,this.protoCodec=t}static decode(e){return new s(r.SignDoc.decode(e))}get txBody(){return this._txBody||(this._txBody=r.TxBody.decode(this.signDoc.bodyBytes)),this._txBody}get txMsgs(){const e=[];for(const t of this.txBody.messages)e.push(this.protoCodec.unpackAny(t));return e}get authInfo(){return this._authInfo||(this._authInfo=r.AuthInfo.decode(this.signDoc.authInfoBytes)),this._authInfo}get chainId(){return this.signDoc.chainId}get accountNumber(){return this.signDoc.accountNumber.toString()}toBytes(){return r.SignDoc.encode(this.signDoc).finish()}toJSON(){return{txBody:Object.assign(Object.assign({},r.TxBody.toJSON(this.txBody)),{messages:this.txMsgs.map(e=>{if(e){if(e instanceof n.UnknownMessage)return e.toJSON();if("factory"in e)return e.factory.toJSON(e.unpacked)}return e})}),authInfo:r.AuthInfo.toJSON(this.authInfo),chainId:this.chainId,accountNumber:this.accountNumber}}}t.ProtoSignDocDecoder=s},768:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1317),t)},769:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1318),t)},770:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainInfoSchema=t.SuggestingBIP44Schema=t.Bech32ConfigSchema=t.FeeCurrencySchema=t.Secret20CurrencySchema=t.CW20CurrencySchema=t.CurrencySchema=void 0;const n=i(771),s=r(i(49));t.CurrencySchema=s.default.object({coinDenom:s.default.string().required(),coinMinimalDenom:s.default.string().required(),coinDecimals:s.default.number().strict().integer().min(0).max(18).required(),coinGeckoId:s.default.string(),coinImageUrl:s.default.string().uri()}).keys({type:s.default.forbidden()}),t.CW20CurrencySchema=t.CurrencySchema.keys({type:s.default.string().equal("cw20").required(),contractAddress:s.default.string().required()}).custom(e=>e.coinMinimalDenom.startsWith(`${e.type}:${e.contractAddress}:`)?e:Object.assign(Object.assign({},e),{coinMinimalDenom:`${e.type}:${e.contractAddress}:`+e.coinMinimalDenom})),t.Secret20CurrencySchema=t.CurrencySchema.keys({type:s.default.string().equal("secret20").required(),contractAddress:s.default.string().required(),viewingKey:s.default.string().required()}).custom(e=>e.coinMinimalDenom.startsWith(`${e.type}:${e.contractAddress}:`)?e:Object.assign(Object.assign({},e),{coinMinimalDenom:`${e.type}:${e.contractAddress}:`+e.coinMinimalDenom}));const o=s.default.object({low:s.default.number().strict().required(),average:s.default.number().strict().required(),high:s.default.number().strict().required()}).custom(e=>{if(e.low>e.average)throw new Error("Low gas price step can not be greater than average");if(e.average>e.high)throw new Error("Average gas price step can not be greater than high");return e});t.FeeCurrencySchema=t.CurrencySchema.keys({gasPriceStep:o}),t.Bech32ConfigSchema=s.default.object({bech32PrefixAccAddr:s.default.string().required(),bech32PrefixAccPub:s.default.string().required(),bech32PrefixValAddr:s.default.string().required(),bech32PrefixValPub:s.default.string().required(),bech32PrefixConsAddr:s.default.string().required(),bech32PrefixConsPub:s.default.string().required()}),t.SuggestingBIP44Schema=s.default.object({coinType:s.default.number().strict().integer().min(0).required()}).unknown(!0),t.ChainInfoSchema=s.default.object({rpc:s.default.string().uri().custom(e=>{if(e.includes("?"))throw new Error("rpc should not have query string");return e}).required(),rest:s.default.string().uri().custom(e=>{if(e.includes("?"))throw new Error("rest should not have query string");return e}).required(),nodeProvider:s.default.object({name:s.default.string().min(1).max(30).required(),email:s.default.string().email({tlds:{allow:!1}}).required(),website:s.default.string().uri()}),chainId:s.default.string().required().min(1).max(30),chainName:s.default.string().required().min(1).max(30),stakeCurrency:t.CurrencySchema.required(),walletUrl:s.default.string().uri(),walletUrlForStaking:s.default.string().uri(),bip44:t.SuggestingBIP44Schema.required(),alternativeBIP44s:s.default.array().items(t.SuggestingBIP44Schema).custom(e=>{const t={};for(const i of e){if(t[i.coinType])throw new Error(`coin type ${i.coinType} is duplicated`);t[i.coinType]=!0}return e}),bech32Config:t.Bech32ConfigSchema.required(),currencies:s.default.array().min(1).items(t.CurrencySchema,t.CW20CurrencySchema,t.Secret20CurrencySchema).custom(e=>{const t={};for(const i of e){if(t[i.coinMinimalDenom])throw new Error(i.coinMinimalDenom+" is duplicated");t[i.coinMinimalDenom]=!0}return e}).required(),feeCurrencies:s.default.array().min(1).items(t.FeeCurrencySchema).custom(e=>{const t={};for(const i of e){if(t[i.coinMinimalDenom])throw new Error(i.coinMinimalDenom+" is duplicated");t[i.coinMinimalDenom]=!0}return e}).required(),coinType:s.default.number().strict().integer(),beta:s.default.boolean(),features:s.default.array().items(s.default.string().valid(...n.SupportedChainFeatures)).unique().custom(e=>{if(e.indexOf("cosmwasm")>=0&&e.indexOf("secretwasm")>=0)throw new Error("cosmwasm and secretwasm are not compatible");return e}),chainSymbolImageUrl:s.default.string().uri()}).custom(e=>{var t;if(null===(t=e.alternativeBIP44s)||void 0===t?void 0:t.find(t=>t.coinType===e.bip44.coinType))throw new Error(`coin type ${e.bip44.coinType} is duplicated`);return e})},771:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hasFeature=t.checkChainFeatures=t.NonRecognizableChainFeatures=t.RecognizableChainFeatures=t.RecognizableChainFeaturesMethod=t.SupportedChainFeatures=void 0;const s=n(i(89));t.SupportedChainFeatures=["stargate","cosmwasm","wasmd_0.24+","secretwasm","ibc-transfer","no-legacy-stdTx","ibc-go","eth-address-gen","eth-key-sign","query:/cosmos/bank/v1beta1/spendable_balances","axelar-evm-bridge","osmosis-txfees","terra-classic-fee"],t.RecognizableChainFeaturesMethod=[{feature:"ibc-go",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){return 200===(yield i.get("/ibc/apps/transfer/v1/params",{validateStatus:e=>200===e||501===e})).status}))},{feature:"ibc-transfer",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){const t=e.includes("ibc-go")?"/ibc/apps/transfer/v1/params":"/ibc/applications/transfer/v1beta1/params",r=yield i.get(t,{validateStatus:e=>200===e||501===e});return 200===r.status&&r.data.params.receive_enabled&&r.data.params.send_enabled}))},{feature:"wasmd_0.24+",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){if(e.includes("cosmwasm")){if(400===(yield i.get("/cosmwasm/wasm/v1/contract/test/smart/test",{validateStatus:e=>400===e||501===e})).status)return!0}return!1}))},{feature:"query:/cosmos/bank/v1beta1/spendable_balances",fetch:(e,t,i)=>r(void 0,void 0,void 0,(function*(){return 400===(yield i.get("/cosmos/bank/v1beta1/spendable_balances/test",{validateStatus:e=>400===e||501===e})).status}))}],t.RecognizableChainFeatures=t.RecognizableChainFeaturesMethod.map(e=>e.feature),t.NonRecognizableChainFeatures=(()=>{const e={};for(const i of t.RecognizableChainFeatures)e[i]=!0;const i=[];for(const r of t.SupportedChainFeatures)e[r]||i.push(r);return i})(),t.checkChainFeatures=function(e){var i,n;return r(this,void 0,void 0,(function*(){const r=[],o=null!==(n=null===(i=e.features)||void 0===i?void 0:i.slice())&&void 0!==n?n:[],a=s.default.create({baseURL:e.rpc}),c=s.default.create({baseURL:e.rest});for(const e of t.RecognizableChainFeaturesMethod)if(!o.includes(e.feature))try{(yield e.fetch(o,a,c))&&(r.push(e.feature),o.push(e.feature))}catch(t){console.log(`Failed to try to fetch feature (${e.feature}): ${t.message||t}`)}return r}))},t.hasFeature=function(e,i){var n,o,a;return r(this,void 0,void 0,(function*(){if(null===(n=e.features)||void 0===n?void 0:n.includes(i))return!0;const r=t.RecognizableChainFeaturesMethod.find(e=>e.feature===i);if(!r)throw new Error(i+" not exist on RecognizableChainFeaturesMethod");const c=s.default.create({baseURL:e.rpc}),d=s.default.create({baseURL:e.rest});return r.fetch(null!==(a=null===(o=e.features)||void 0===o?void 0:o.slice())&&void 0!==a?a:[],c,d)}))}},781:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(782),t),n(i(783),t),n(i(543),t)},782:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PermissionService=void 0;const n=i(3),s=i(783),o=i(9);t.PermissionService=class{constructor(e,t){this.kvStore=e,this.globalPermissionMap={},this.permissionMap={},this.privilegedOrigins=new Map,this.onChainRemoved=e=>{this.removeAllPermissions(e)};for(const e of t)this.privilegedOrigins.set(e,!0);this.restore()}init(e,t,i){this.interactionService=e,this.chainsService=t,this.keyRingService=i,this.chainsService.addChainRemovedHandler(this.onChainRemoved)}checkOrGrantBasicAccessPermission(e,t,i){return r(this,void 0,void 0,(function*(){yield this.keyRingService.enable(e),"string"==typeof t&&(t=[t]);const r=[];for(const e of t)this.hasPermisson(e,s.getBasicAccessPermissionType(),i)||r.push(e);r.length>0&&(yield this.grantBasicAccessPermission(e,r,[i])),yield this.checkBasicAccessPermission(e,t,i)}))}disable(e,t,i){return r(this,void 0,void 0,(function*(){if(yield this.keyRingService.enable(e),"string"==typeof t&&(t=[t]),t.length>0)for(const e of t)yield this.removeAllTypePermissionToChainId(e,[i]);else yield this.removeAllTypePermission([i]),yield this.removeAllTypeGlobalPermission([i])}))}checkOrGrantPermission(e,t,i,n,s){return r(this,void 0,void 0,(function*(){yield this.keyRingService.enable(e);const r=[];for(const e of i)this.hasPermisson(e,n,s)||r.push(e);r.length>0&&(yield this.grantPermission(e,t,r,n,[s]));for(const t of i)this.checkPermission(e,t,n,s)}))}checkOrGrantGlobalPermission(e,t,i,n){return r(this,void 0,void 0,(function*(){yield this.keyRingService.enable(e),this.hasGlobalPermission(i,n)||(yield this.grantGlobalPermission(e,t,i,[n])),this.checkGlobalPermission(e,i,n)}))}grantPermission(e,t,i,n,o){return r(this,void 0,void 0,(function*(){if(e.isInternalMsg)return;const r={chainIds:i,type:n,origins:o};yield this.interactionService.waitApprove(e,t,s.INTERACTION_TYPE_PERMISSION,r),yield this.addPermission(i,n,o)}))}grantBasicAccessPermission(e,t,i){return r(this,void 0,void 0,(function*(){for(const e of t)yield this.chainsService.getChainInfo(e);yield this.grantPermission(e,"/access",t,s.getBasicAccessPermissionType(),i)}))}grantGlobalPermission(e,t,i,n){return r(this,void 0,void 0,(function*(){if(e.isInternalMsg)return;const r={type:i,origins:n};yield this.interactionService.waitApprove(e,t,s.INTERACTION_TYPE_GLOBAL_PERMISSION,r),yield this.addGlobalPermission(i,n)}))}checkPermission(e,t,i,r){if(!e.isInternalMsg&&!this.hasPermisson(t,i,r))throw new n.KeplrError("permission",130,r+" is not permitted")}checkBasicAccessPermission(e,t,i){return r(this,void 0,void 0,(function*(){for(const r of t)yield this.chainsService.getChainInfo(r),this.checkPermission(e,r,s.getBasicAccessPermissionType(),i)}))}checkGlobalPermission(e,t,i){if(!e.isInternalMsg&&!this.hasGlobalPermission(t,i))throw new n.KeplrError("permission",130,i+" is not permitted")}hasPermisson(e,t,i){if(this.privilegedOrigins.get(i))return!0;const r=this.permissionMap[o.ChainIdHelper.parse(e).identifier];if(!r)return!1;const n=r[t];return!(!n||!n[i])}hasGlobalPermission(e,t){if(this.privilegedOrigins.get(t))return!0;const i=this.globalPermissionMap[e];return!!i&&!!i[t]}getPermissionOrigins(e,t){const i=[],r=this.permissionMap[o.ChainIdHelper.parse(e).identifier];if(!r)return[];const n=r[t];if(!n)return[];for(const e of Object.keys(n))n[e]&&i.push(e);return i}getGlobalPermissionOrigins(e){const t=Object.assign({},this.globalPermissionMap[e]);return Object.keys(t).filter(e=>t[e])}getOriginPermittedChains(e,t){var i;const r=[];for(const n of Object.keys(this.permissionMap)){const s=this.permissionMap[n],o=null!==(i=s?s[t]:void 0)&&void 0!==i?i:{};for(const t of Object.keys(o))t===e&&o[t]&&r.push(n)}return r}addPermission(e,t,i){return r(this,void 0,void 0,(function*(){for(const r of e){let e=this.permissionMap[o.ChainIdHelper.parse(r).identifier];e||(e={},this.permissionMap[o.ChainIdHelper.parse(r).identifier]=e);let n=e[t];n||(n={},e[t]=n);for(const e of i)n[e]=!0}yield this.save()}))}addGlobalPermission(e,t){return r(this,void 0,void 0,(function*(){const i=Object.assign({},this.globalPermissionMap[e]);for(const e of t)i[e]=!0;this.globalPermissionMap[e]=i,yield this.save()}))}removePermission(e,t,i){return r(this,void 0,void 0,(function*(){const r=this.permissionMap[o.ChainIdHelper.parse(e).identifier];if(!r)return;const n=r[t];if(n){for(const e of i)delete n[e];yield this.save()}}))}removeAllTypePermission(e){return r(this,void 0,void 0,(function*(){for(const t of Object.keys(this.permissionMap)){const i=this.permissionMap[t];if(!i)return;for(const t of Object.keys(i)){const r=i[t];if(!r)return;for(const t of e)delete r[t]}}yield this.save()}))}removeAllTypePermissionToChainId(e,t){return r(this,void 0,void 0,(function*(){const i=this.permissionMap[o.ChainIdHelper.parse(e).identifier];if(i){for(const e of Object.keys(i)){const r=i[e];if(!r)return;for(const e of t)delete r[e]}yield this.save()}}))}removeGlobalPermission(e,t){return r(this,void 0,void 0,(function*(){const i=Object.assign({},this.globalPermissionMap[e]);for(const e of t)delete i[e];this.globalPermissionMap[e]=i,yield this.save()}))}removeAllTypeGlobalPermission(e){return r(this,void 0,void 0,(function*(){for(const t of Object.keys(this.globalPermissionMap)){const i=Object.assign({},this.globalPermissionMap[t]);for(const t of e)delete i[t];this.globalPermissionMap[t]=i}yield this.save()}))}removeAllPermissions(e){return r(this,void 0,void 0,(function*(){this.permissionMap[o.ChainIdHelper.parse(e).identifier]=void 0,yield this.save()}))}restore(){return r(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("permissionMap");e&&(this.permissionMap=e);const t=yield this.kvStore.get("globalPermissionMap");t&&(this.globalPermissionMap=t)}))}save(){return r(this,void 0,void 0,(function*(){yield this.kvStore.set("permissionMap",this.permissionMap),yield this.kvStore.set("globalPermissionMap",this.globalPermissionMap)}))}}},783:function(e,t,i){"use strict";function r(){return"basic-access"}Object.defineProperty(t,"__esModule",{value:!0}),t.isBasicAccessPermissionType=t.getBasicAccessPermissionType=t.INTERACTION_TYPE_GLOBAL_PERMISSION=t.INTERACTION_TYPE_PERMISSION=void 0,t.INTERACTION_TYPE_PERMISSION="permission",t.INTERACTION_TYPE_GLOBAL_PERMISSION="global_permission",t.getBasicAccessPermissionType=r,t.isBasicAccessPermissionType=function(e){return"basic-access"===e}},784:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="permission"},785:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LedgerService=void 0;const s=i(786),o=n(i(141)),a=i(3),c=i(2);t.LedgerService=class{constructor(e,t){var i;this.kvStore=e,this.options={defaultMode:t.defaultMode||"webusb",transportIniters:null!==(i=t.transportIniters)&&void 0!==i?i:{}},this.options.transportIniters.webusb||(this.options.transportIniters.webusb=s.LedgerWebUSBIniter),this.options.transportIniters.webhid||(this.options.transportIniters.webhid=s.LedgerWebHIDIniter)}init(e){this.interactionService=e}tryLedgerInit(e,t,i="Cosmos"){return r(this,void 0,void 0,(function*(){yield this.getPublicKey(e,t,{account:0,change:0,addressIndex:0},i)}))}getPublicKey(e,t,i,n="Cosmos"){return r(this,void 0,void 0,(function*(){return yield this.useLedger(e,t,(e,n)=>r(this,void 0,void 0,(function*(){try{return yield e.getPublicKey(t,i)}finally{n>0&&this.interactionService.dispatchEvent(a.APP_PORT,"ledger-init",{event:"get-pubkey",success:!0})}})),n)}))}sign(e,t,i,n,o="Cosmos"){return r(this,void 0,void 0,(function*(){const d=s.LedgerApp.Cosmos;return yield this.useLedger(e,d,(e,s)=>r(this,void 0,void 0,(function*(){try{const r=yield e.getPublicKey(d,t);if(c.Buffer.from(i).toString("hex")!==c.Buffer.from(r).toString("hex"))throw new a.KeplrError("ledger",110,"Unmatched public key");const o=yield e.sign(t,n);return s>0&&this.interactionService.dispatchEvent(a.APP_PORT,"ledger-init",{event:"sign",success:!0}),o}catch(e){throw s>0&&this.interactionService.dispatchEvent(a.APP_PORT,"ledger-init",{event:"sign",success:!1}),e}})),o)}))}signEthereum(e,t,i,n,o){return r(this,void 0,void 0,(function*(){const d=s.LedgerApp.Ethereum;return yield this.useLedger(e,d,(e,s)=>r(this,void 0,void 0,(function*(){try{const r=yield e.getPublicKey(d,i);if(c.Buffer.from(n).toString("hex")!==c.Buffer.from(r).toString("hex"))throw new a.KeplrError("ledger",110,"Unmatched public key");const u=yield e.signEthereum(i,t,o);return s>0&&this.interactionService.dispatchEvent(a.APP_PORT,"ledger-init",{event:"sign",success:!0}),u}catch(e){throw s>0&&this.interactionService.dispatchEvent(a.APP_PORT,"ledger-init",{event:"sign",success:!1}),e}})))}))}useLedger(e,t,i,n="Cosmos"){return r(this,void 0,void 0,(function*(){let r;try{return r=yield this.initLedger(e,t,n),yield i(r.ledger,r.retryCount)}finally{r&&(yield r.ledger.close())}}))}initLedger(e,t,i="Cosmos"){return r(this,void 0,void 0,(function*(){this.previousInitAborter&&this.previousInitAborter(new Error("New ledger request occurred before the ledger was initialized"));const n=(()=>{let e;return{wait:()=>new Promise((t,i)=>{e=i}),abort:t=>{e&&e(t)}}})();this.previousInitAborter=n.abort;let c=0,d=[];for(;;){const u=yield this.getMode();try{const e=this.options.transportIniters[u];if(!e)throw new a.KeplrError("ledger",112,"Unknown mode: "+u);const r=yield s.Ledger.init(e,d,t,i);return this.previousInitAborter=void 0,{ledger:r,retryCount:c}}catch(s){console.log(s);const c=new AbortController;try{const s=[(()=>r(this,void 0,void 0,(function*(){const r=yield this.interactionService.waitApprove(e,"/ledger-grant","ledger-init",{event:"init-failed",ledgerApp:t,mode:u,cosmosLikeApp:i},{forceOpenWindow:!0,channel:"ledger"});if(null==r?void 0:r.abort)throw new a.KeplrError("ledger",120,"Ledger init aborted");(null==r?void 0:r.initArgs)&&(d=r.initArgs)})))()];s.push((()=>r(this,void 0,void 0,(function*(){let e=!1;try{yield o.default(3e5,{signal:c.signal})}catch(t){if("AbortError"!==t.name)throw t;e=!0}if(!e)throw this.interactionService.dispatchEvent(a.APP_PORT,"ledger-init",{event:"init-aborted",mode:u}),new a.KeplrError("ledger",121,"Ledger init timeout")})))()),s.push(n.wait()),"undefined"!=typeof browser&&s.push(this.testLedgerGrantUIOpened()),yield Promise.race(s)}finally{c.abort()}}c++}}))}testLedgerGrantUIOpened(){return r(this,void 0,void 0,(function*(){for(yield o.default(1e3);;){const e=browser.extension.getViews();let t=!1;for(const i of e)if(i.location.href.includes(browser.runtime.getURL("popup.html#/ledger-grant"))){t=!0;break}if(!t)throw new a.KeplrError("ledger",120,"Ledger init aborted");yield o.default(1e3)}}))}getMode(){return r(this,void 0,void 0,(function*(){return(yield this.getWebHIDFlag())?"webhid":this.options.defaultMode}))}getWebHIDFlag(){return r(this,void 0,void 0,(function*(){return!!(yield this.kvStore.get("webhid"))}))}setWebHIDFlag(e){return r(this,void 0,void 0,(function*(){yield this.kvStore.set("webhid",e)}))}}},786:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Ledger=t.LedgerInitError=t.LedgerWebHIDIniter=t.LedgerWebUSBIniter=t.LedgerInitErrorOn=t.LedgerApp=void 0;const s=n(i(476)),o=n(i(641)),a=i(189),c=i(3),d=n(i(642)),u=i(97),h=i(365),l=i(100),p=i(2),g=i(797),f=i(206);var y,v;!function(e){e.Cosmos="cosmos",e.Ethereum="ethereum"}(y=t.LedgerApp||(t.LedgerApp={})),function(e){e[e.Transport=0]="Transport",e[e.App=1]="App",e[e.Unknown=2]="Unknown"}(v=t.LedgerInitErrorOn||(t.LedgerInitErrorOn={}));t.LedgerWebUSBIniter=()=>r(void 0,void 0,void 0,(function*(){return yield o.default.create()}));t.LedgerWebHIDIniter=()=>r(void 0,void 0,void 0,(function*(){return yield s.default.create()}));class m extends Error{constructor(e,t){super(t),this.errorOn=e,Object.setPrototypeOf(this,m.prototype)}}t.LedgerInitError=m;class w{constructor(e,t){this.cosmosApp=e,this.ethereumApp=t}static init(e,t=[],i,n){return r(this,void 0,void 0,(function*(){const r=yield e(...t);try{if(i===y.Ethereum){const e=new d.default(r);return yield e.getAddress("m/44'/60'/0'/0/0"),new w(void 0,e)}const e=new f.CosmosApp(n,r),t=new w(e,void 0);if((yield t.getVersion()).deviceLocked)throw new c.KeplrError("ledger",102,"Device is on screen saver");let s="";try{s=(yield e.getAppInfo()).app_name}catch(e){console.log(e)}if(s&&s!==n)throw new c.KeplrError("ledger",122,"Invalid cosmos app selected");return t}catch(e){if(r&&(yield r.close()),"Device is on screen saver"===e.message)throw new m(v.Transport,e.message);throw new m(v.App,e.message)}}))}getVersion(){var e;return r(this,void 0,void 0,(function*(){if(!this.cosmosApp)throw new c.KeplrError("ledger",100,"Cosmos App not initialized");const t=yield this.cosmosApp.getVersion();if("No errors"!==t.error_message)throw new Error(t.error_message);return{deviceLocked:null!==(e=t.device_locked)&&void 0!==e&&e,major:t.major,minor:t.minor,patch:t.patch,targetId:t.target_id,testMode:t.test_mode}}))}getPublicKey(e,t){return r(this,void 0,void 0,(function*(){if(e!==y.Ethereum){if(!this.cosmosApp)throw new c.KeplrError("ledger",100,"Cosmos App not initialized");const e=yield this.cosmosApp.getPublicKey(t.account,t.change,t.addressIndex);if("No errors"!==e.error_message)throw new Error(e.error_message);return e.compressed_pk}if(!this.ethereumApp)throw new c.KeplrError("ledger",100,"Ethereum App not initialized");try{const e=yield this.ethereumApp.getAddress(w.pathToString(w.createPath(60,t))),i=p.Buffer.from(e.publicKey,"hex");return a.publicKeyConvert(i,!0)}catch(e){throw new Error(e)}}))}sign(e,t){return r(this,void 0,void 0,(function*(){if(!this.cosmosApp)throw new c.KeplrError("ledger",100,"Cosmos App not initialized");const i=yield this.cosmosApp.sign(e.account,e.change,e.addressIndex,t);if("No errors"!==i.error_message)throw new Error(i.error_message);return a.signatureImport(i.signature)}))}signEthereum(e,t,i){return r(this,void 0,void 0,(function*(){if(!this.ethereumApp)throw new c.KeplrError("ledger",100,"Ethereum App not initialized");const r=w.pathToString(w.createPath(60,e));switch(t){case u.EthSignType.MESSAGE:{const e=yield this.ethereumApp.signPersonalMessage(r,p.Buffer.from(i).toString("hex"));return w.ethSignatureToBytes(e)}case u.EthSignType.TRANSACTION:{const e=JSON.parse(p.Buffer.from(i).toString()),t=l.serialize(e).replace("0x",""),n=yield this.ethereumApp.signTransaction(r,t),s=l.serialize(e,{r:"0x"+n.r,s:"0x"+n.s,v:parseInt(n.v,16)}).replace("0x","");return p.Buffer.from(s,"hex")}case u.EthSignType.EIP712:{const e=yield h.EIP712MessageValidator.validateAsync(JSON.parse(p.Buffer.from(i).toString()));return w.ethSignatureToBytes(yield this.ethereumApp.signEIP712HashedMessage(r,g.domainHash(e),g.messageHash(e)))}default:throw new Error("Unknown sign type: "+t)}}))}close(){return r(this,void 0,void 0,(function*(){this.cosmosApp&&(yield this.cosmosApp.transport.close()),this.ethereumApp&&(yield this.ethereumApp.transport.close())}))}static isWebHIDSupported(){return r(this,void 0,void 0,(function*(){return yield s.default.isSupported()}))}static createPath(e,t){return[44,e,t.account,t.change,t.addressIndex]}static pathToString(e){if(5!==e.length)throw new Error("Invalid path for bip44: "+e.join(","));let t="m",i=0;return e.forEach(e=>{t=t.concat("/"+e),i<3&&(t=t.concat("'")),i++}),t}static ethSignatureToBytes(e){const t=p.Buffer.from(e.r,"hex"),i=p.Buffer.from(e.s,"hex");if(32!==t.length||32!==i.length)throw new Error("Unable to process signature: malformed fields");if(!Number.isInteger(e.v))throw new Error("Unable to process signature: malformed fields");return p.Buffer.concat([t,i,p.Buffer.from([e.v])])}}t.Ledger=w},789:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KeyRingService=void 0;const s=i(551),o=i(9),a=i(553),c=i(21),d=i(97),u=i(3),h=i(147),l=n(i(56)),p=i(2),g=i(1384),f=i(430),y=i(69),v=i(190);t.KeyRingService=class{constructor(e,t,i){this.kvStore=e,this.embedChainInfos=t,this.crypto=i,this.onChainRemoved=e=>{this.keyRing.removeAllKeyStoreCoinType(e)}}init(e,t,i,r,n,o){this.interactionService=e,this.chainsService=t,this.permissionService=i,this.keyRing=new s.KeyRing(this.embedChainInfos,this.kvStore,r,n,this.crypto),this.chainsService.addChainRemovedHandler(this.onChainRemoved),this.analyticsSerice=o}restore(){return r(this,void 0,void 0,(function*(){return yield this.keyRing.restore(),{status:this.keyRing.status,multiKeyStoreInfo:this.keyRing.getMultiKeyStoreInfo()}}))}enable(e){return r(this,void 0,void 0,(function*(){if(this.keyRing.status===s.KeyRingStatus.EMPTY)throw new u.KeplrError("keyring",261,"key doesn't exist");return this.keyRing.status===s.KeyRingStatus.NOTLOADED&&(yield this.keyRing.restore()),this.keyRing.status===s.KeyRingStatus.LOCKED?(yield this.interactionService.waitApprove(e,"/unlock","unlock",{}),this.keyRing.status):this.keyRing.status}))}get keyRingStatus(){return this.keyRing.status}deleteKeyRing(e,t){return r(this,void 0,void 0,(function*(){let i=!1;try{const r=yield this.keyRing.deleteKeyRing(e,t);return i=r.keyStoreChanged,{multiKeyStoreInfo:r.multiKeyStoreInfo,status:this.keyRing.status}}finally{i&&this.interactionService.dispatchEvent(u.WEBPAGE_PORT,"keystore-changed",{})}}))}updateNameKeyRing(e,t){return r(this,void 0,void 0,(function*(){return{multiKeyStoreInfo:yield this.keyRing.updateNameKeyRing(e,t)}}))}showKeyRing(e,t){return r(this,void 0,void 0,(function*(){return yield this.keyRing.showKeyRing(e,t)}))}createMnemonicKey(e,t,i,n,s){return r(this,void 0,void 0,(function*(){return yield this.keyRing.createMnemonicKey(e,t,i,n,s)}))}createPrivateKey(e,t,i,n){return r(this,void 0,void 0,(function*(){return yield this.keyRing.createPrivateKey(e,t,i,n)}))}createKeystoneKey(e,t,i,n,s){return r(this,void 0,void 0,(function*(){return yield this.keyRing.createKeystoneKey(e,t,i,n,s)}))}createLedgerKey(e,t,i,n,s,o){return r(this,void 0,void 0,(function*(){return yield this.keyRing.createLedgerKey(e,t,i,n,s,o)}))}lock(){return this.keyRing.lock(),this.keyRing.status}unlock(e){return r(this,void 0,void 0,(function*(){return yield this.keyRing.unlock(e),this.keyRing.status}))}getKey(e){return r(this,void 0,void 0,(function*(){const t=yield this.chainsService.getChainEthereumKeyFeatures(e);return(t.address||t.signing)&&this.keyRing.throwErrorIfEthermintWithLedgerButNotSupported(e),this.keyRing.getKey(e,yield this.chainsService.getChainCoinType(e),t.address)}))}getKeyStoreMeta(e){return this.keyRing.getKeyStoreMeta(e)}getKeyRingType(){return this.keyRing.type}requestSignAmino(e,t,i,n,s,d){return r(this,void 0,void 0,(function*(){s=Object.assign(Object.assign({},s),{memo:c.escapeHTML(s.memo)}),s=g.trimAminoSignDoc(s),s=c.sortObjectByKey(s);const r=yield this.chainsService.getChainCoinType(i),h=yield this.chainsService.getChainEthereumKeyFeatures(i);(h.address||h.signing)&&this.keyRing.throwErrorIfEthermintWithLedgerButNotSupported(i);const l=yield this.keyRing.getKey(i,r,h.address),f=(yield this.chainsService.getChainInfo(i)).bech32Config.bech32PrefixAccAddr,y=new o.Bech32Address(l.address).toBech32(f);if(n!==y)throw new u.KeplrError("keyring",231,"Signer mismatched");const v=o.checkAndValidateADR36AminoSignDoc(s,f);if(v&&s.msgs[0].value.signer!==n)throw new u.KeplrError("keyring",233,"Unmatched signer in sign doc");if(null!=d.isADR36WithString&&!v)throw new u.KeplrError("keyring",236,'Sign doc is not for ADR-36. But, "isADR36WithString" option is defined');if(d.ethSignType&&!v)throw new Error("Eth sign type can be requested with only ADR-36 amino sign doc");let m=yield this.interactionService.waitApprove(e,"/sign","request-sign",{msgOrigin:t,chainId:i,mode:"amino",signDoc:s,signer:n,signOptions:d,isADR36SignDoc:v,isADR36WithString:d.isADR36WithString,ethSignType:d.ethSignType});if(m=Object.assign(Object.assign({},m),{memo:c.escapeHTML(m.memo)}),v){if(!o.checkAndValidateADR36AminoSignDoc(s,f))throw new u.KeplrError("keyring",237,"Signing request was for ADR-36. But, accidentally, new sign doc is not for ADR-36");if(s.msgs[0].value.signer!==n)throw new u.KeplrError("keyring",232,"Unmatched signer in new sign doc")}if(d.ethSignType){if(1!==m.msgs.length)throw new Error("Invalid number of messages for Ethereum sign request");const n=p.Buffer.from(m.msgs[0].value.data,"base64");try{const s=yield this.keyRing.signEthereum(e,i,r,n,d.ethSignType);return this.analyticsSerice.logEventIgnoreError("tx_signed",{chainId:i,isInternal:e.isInternalMsg,origin:t,ethSignType:d.ethSignType}),{signed:m,signature:{pub_key:o.encodeSecp256k1Pubkey(l.pubKey),signature:p.Buffer.from(s).toString("base64")}}}finally{this.interactionService.dispatchEvent(u.APP_PORT,"request-sign-end",{})}}try{const n=yield this.keyRing.sign(e,i,r,o.serializeSignDoc(m),h.signing,a.SignMode.Amino),s=m.msgs.filter(e=>e.type).map(e=>e.type);return this.analyticsSerice.logEventIgnoreError("tx_signed",{chainId:i,isInternal:e.isInternalMsg,origin:t,signMode:a.SignMode.Amino,msgTypes:s,isADR36SignDoc:v}),{signed:m,signature:o.encodeSecp256k1Signature(l.pubKey,n)}}finally{this.interactionService.dispatchEvent(u.APP_PORT,"request-sign-end",{})}}))}requestSignEIP712CosmosTx_v0(e,t,i,n,s,a,h){return r(this,void 0,void 0,(function*(){a=Object.assign(Object.assign({},a),{memo:c.escapeHTML(a.memo)}),a=g.trimAminoSignDoc(a),a=c.sortObjectByKey(a);const r=yield this.chainsService.getChainCoinType(i),l=yield this.chainsService.getChainEthereumKeyFeatures(i);(l.address||l.signing)&&this.keyRing.throwErrorIfEthermintWithLedgerButNotSupported(i);const f=yield this.keyRing.getKey(i,r,l.address),y=(yield this.chainsService.getChainInfo(i)).bech32Config.bech32PrefixAccAddr,v=new o.Bech32Address(f.address).toBech32(y);if(n!==v)throw new u.KeplrError("keyring",231,"Signer mismatched");let m=yield this.interactionService.waitApprove(e,"/sign","request-sign",{msgOrigin:t,chainId:i,mode:"amino",signDoc:a,signer:n,signOptions:h,isADR36SignDoc:!1,ethSignType:d.EthSignType.EIP712});m=Object.assign(Object.assign({},m),{memo:c.escapeHTML(m.memo)});try{const n=yield this.keyRing.signEthereum(e,i,r,p.Buffer.from(JSON.stringify({types:s.types,domain:s.domain,primaryType:s.primaryType,message:m})),d.EthSignType.EIP712),a=m.msgs.filter(e=>e.type).map(e=>e.type);return this.analyticsSerice.logEventIgnoreError("tx_signed",{chainId:i,isInternal:e.isInternalMsg,origin:t,ethSignType:d.EthSignType.EIP712,msgTypes:a}),{signed:m,signature:{pub_key:o.encodeSecp256k1Pubkey(f.pubKey),signature:p.Buffer.from(n).toString("base64")}}}finally{this.interactionService.dispatchEvent(u.APP_PORT,"request-sign-end",{})}}))}requestSignDirect(e,t,i,n,s,c){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainCoinType(i),d=yield this.chainsService.getChainEthereumKeyFeatures(i);(d.address||d.signing)&&this.keyRing.throwErrorIfEthermintWithLedgerButNotSupported(i);const p=yield this.keyRing.getKey(i,r,d.address),g=new o.Bech32Address(p.address).toBech32((yield this.chainsService.getChainInfo(i)).bech32Config.bech32PrefixAccAddr);if(n!==g)throw new u.KeplrError("keyring",231,"Signer mismatched");const f=yield this.interactionService.waitApprove(e,"/sign","request-sign",{msgOrigin:t,chainId:i,mode:"direct",signDocBytes:h.SignDoc.encode(s).finish(),signer:n,signOptions:c}),y=h.SignDoc.decode(f);try{const n=yield this.keyRing.sign(e,i,r,f,d.signing,a.SignMode.Direct),s=h.TxBody.decode(y.bodyBytes).messages.map(e=>e.typeUrl);return this.analyticsSerice.logEventIgnoreError("tx_signed",{chainId:i,isInternal:e.isInternalMsg,origin:t,signMode:a.SignMode.Direct,msgTypes:s}),{signed:Object.assign(Object.assign({},y),{accountNumber:l.default.fromString(y.accountNumber)}),signature:o.encodeSecp256k1Signature(p.pubKey,n)}}finally{this.interactionService.dispatchEvent(u.APP_PORT,"request-sign-end",{})}}))}requestICNSAdr36Signatures(e,t,i,n,s,c){return r(this,void 0,void 0,(function*(){const r=[],d={chainId:t,owner:n,username:s,accountInfos:[]};{const e=yield this.chainsService.getChainInfo(t);o.Bech32Address.validate(i,e.bech32Config.bech32PrefixAccAddr);const r=yield this.getKey(t),s=new o.Bech32Address(r.address).toBech32(e.bech32Config.bech32PrefixAccAddr);if(s!==n)throw new Error(`Unmatched owner: (expected: ${s}, actual: ${n})`)}const u=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER);for(const e of c){const t=yield this.chainsService.getChainInfo(e),i=yield this.getKey(e),r=new o.Bech32Address(i.address).toBech32(t.bech32Config.bech32PrefixAccAddr);d.accountInfos.push({chainId:t.chainId,bech32Prefix:t.bech32Config.bech32PrefixAccAddr,bech32Address:r,pubKey:i.pubKey})}yield this.interactionService.waitApprove(e,"/icns/adr36-signatures",f.RequestICNSAdr36SignaturesMsg.type(),d);const h=o.Bech32Address.fromBech32(n);for(const c of d.accountInfos)if(h.toHex(!1)!==o.Bech32Address.fromBech32(c.bech32Address).toHex(!1)){const d=`The following is the information for ICNS registration for ${s}.${c.bech32Prefix}.\n\nChain id: ${t}\nContract Address: ${i}\nOwner: ${n}\nSalt: ${u}`,h=o.makeADR36AminoSignDoc(c.bech32Address,d),l=yield this.chainsService.getChainCoinType(c.chainId),p=yield this.chainsService.getChainEthereumKeyFeatures(c.chainId),g=yield this.keyRing.sign(e,c.chainId,l,o.serializeSignDoc(h),p.signing,a.SignMode.Message).finally(()=>{"keystone"===this.keyRing.type&&v.closePopupWindow("default")});r.push({chainId:c.chainId,bech32Prefix:c.bech32Prefix,bech32Address:c.bech32Address,addressHash:p.signing?"ethereum":"cosmos",pubKey:new y.PubKeySecp256k1(c.pubKey).toBytes(p.signing),signatureSalt:u,signature:g})}else{const e=yield this.chainsService.getChainEthereumKeyFeatures(c.chainId);r.push({chainId:c.chainId,bech32Prefix:c.bech32Prefix,bech32Address:c.bech32Address,addressHash:e.signing?"ethereum":"cosmos",pubKey:new y.PubKeySecp256k1(c.pubKey).toBytes(e.signing),signatureSalt:0,signature:new Uint8Array(0)})}return r}))}verifyADR36AminoSignDoc(e,t,i,n){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainCoinType(e),s=yield this.chainsService.getChainEthereumKeyFeatures(e),a=yield this.keyRing.getKey(e,r,s.address),c=(yield this.chainsService.getChainInfo(e)).bech32Config.bech32PrefixAccAddr,d=new o.Bech32Address(a.address).toBech32(c);if(t!==d)throw new u.KeplrError("keyring",231,"Signer mismatched");if("tendermint/PubKeySecp256k1"!==n.pub_key.type)throw new u.KeplrError("keyring",211,"Unsupported type of pub key: "+n.pub_key.type);if(p.Buffer.from(a.pubKey).toString("base64")!==n.pub_key.value)throw new u.KeplrError("keyring",210,"Pub key unmatched");const h=o.makeADR36AminoSignDoc(t,i);return o.verifyADR36AminoSignDoc(c,h,p.Buffer.from(n.pub_key.value,"base64"),p.Buffer.from(n.signature,"base64"),s.address?"ethsecp256k1":"secp256k1")}))}sign(e,t,i){return r(this,void 0,void 0,(function*(){return this.keyRing.sign(e,t,yield this.chainsService.getChainCoinType(t),i,(yield this.chainsService.getChainEthereumKeyFeatures(t)).signing)}))}addMnemonicKey(e,t,i,n){return r(this,void 0,void 0,(function*(){return this.keyRing.addMnemonicKey(e,t,i,n)}))}addPrivateKey(e,t,i){return r(this,void 0,void 0,(function*(){return this.keyRing.addPrivateKey(e,t,i)}))}addKeystoneKey(e,t,i,n){return r(this,void 0,void 0,(function*(){return this.keyRing.addKeystoneKey(e,t,i,n)}))}addLedgerKey(e,t,i,n,s){return r(this,void 0,void 0,(function*(){return this.keyRing.addLedgerKey(e,t,i,n,s)}))}changeKeyStoreFromMultiKeyStore(e){return r(this,void 0,void 0,(function*(){try{return yield this.keyRing.changeKeyStoreFromMultiKeyStore(e)}finally{this.interactionService.dispatchEvent(u.WEBPAGE_PORT,"keystore-changed",{})}}))}checkPassword(e){return this.keyRing.checkPassword(e)}getMultiKeyStoreInfo(){return this.keyRing.getMultiKeyStoreInfo()}isKeyStoreCoinTypeSet(e){return this.keyRing.isKeyStoreCoinTypeSet(e)}setKeyStoreCoinType(e,t){return r(this,void 0,void 0,(function*(){const i=this.keyRing.computeKeyStoreCoinType(e,yield this.chainsService.getChainCoinType(e));yield this.keyRing.setKeyStoreCoinType(e,t),i!==t&&this.interactionService.dispatchEvent(u.WEBPAGE_PORT,"keystore-changed",{})}))}getKeyStoreBIP44Selectables(e,t){return r(this,void 0,void 0,(function*(){if(this.isKeyStoreCoinTypeSet(e))return[];const i=[],r=yield this.chainsService.getChainInfo(e);for(const n of t){const t=yield this.keyRing.getKeyFromCoinType(n.coinType,(yield this.chainsService.getChainEthereumKeyFeatures(e)).address),s=new o.Bech32Address(t.address).toBech32(r.bech32Config.bech32PrefixAccAddr);i.push({path:n,bech32Address:s})}return i}))}exportKeyRingDatas(e){return r(this,void 0,void 0,(function*(){return yield this.keyRing.exportKeyRingDatas(e)}))}initializeNonDefaultLedgerApp(e,t){return r(this,void 0,void 0,(function*(){return yield this.keyRing.initializeNonDefaultLedgerApp(e,t)}))}changeKeyRingName(e,t,{defaultName:i,editable:n}){return r(this,void 0,void 0,(function*(){const r=yield this.interactionService.waitApprove(e,"/setting/keyring/change/name/"+t,"change-keyring-name",{defaultName:i,editable:n});return yield this.updateNameKeyRing(t,r),r}))}}},790:function(e,t){var i=Math.pow(2,30)-1;e.exports=function(e,t){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof t)throw new TypeError("Key length not a number");if(t<0||t>i||t!=t)throw new TypeError("Bad key length")}},791:function(e,t,i){(function(t,i){var r;if(t.process&&t.process.browser)r="utf-8";else if(t.process&&t.process.version){r=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary"}else r="utf-8";e.exports=r}).call(this,i(30),i(57))},792:function(e,t,i){var r=i(523),n=i(356),s=i(259),o=i(50).Buffer,a=i(790),c=i(791),d=i(793),u=o.alloc(128),h={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function l(e,t,i){var a=function(e){function t(t){return s(e).update(t).digest()}return"rmd160"===e||"ripemd160"===e?function(e){return(new n).update(e).digest()}:"md5"===e?r:t}(e),c="sha512"===e||"sha384"===e?128:64;t.length>c?t=a(t):t.length<c&&(t=o.concat([t,u],c));for(var d=o.allocUnsafe(c+h[e]),l=o.allocUnsafe(c+h[e]),p=0;p<c;p++)d[p]=54^t[p],l[p]=92^t[p];var g=o.allocUnsafe(c+i+4);d.copy(g,0,0,c),this.ipad1=g,this.ipad2=d,this.opad=l,this.alg=e,this.blocksize=c,this.hash=a,this.size=h[e]}l.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,i,r,n){a(i,r);var s=new l(n=n||"sha1",e=d(e,c,"Password"),(t=d(t,c,"Salt")).length),u=o.allocUnsafe(r),p=o.allocUnsafe(t.length+4);t.copy(p,0,0,t.length);for(var g=0,f=h[n],y=Math.ceil(r/f),v=1;v<=y;v++){p.writeUInt32BE(v,t.length);for(var m=s.run(p,s.ipad1),w=m,S=1;S<i;S++){w=s.run(w,s.ipad2);for(var b=0;b<f;b++)m[b]^=w[b]}m.copy(u,g),g+=f}return u}},793:function(e,t,i){var r=i(50).Buffer;e.exports=function(e,t,i){if(r.isBuffer(e))return e;if("string"==typeof e)return r.from(e,t);if(ArrayBuffer.isView(e))return r.from(e.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")}},794:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(785),t),n(i(552),t),n(i(786),t)},795:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="ledger"},796:function(e,t,i){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EIP712MessageValidator=t.EIP712DomainTypeValidator=t.EIP712PropertyFieldValidator=void 0;const n=r(i(49));t.EIP712PropertyFieldValidator=n.default.object({name:n.default.string().min(1).required(),type:n.default.string().min(1).required()}),t.EIP712DomainTypeValidator=n.default.array().items(n.default.object({name:n.default.string().valid("name").required(),type:n.default.string().valid("string").required()}),n.default.object({name:n.default.string().valid("version").required(),type:n.default.string().valid("string").required()}),n.default.object({name:n.default.string().valid("chainId").required(),type:n.default.string().valid("uint256").required()}),n.default.object({name:n.default.string().valid("verifyingContract").required(),type:n.default.string().valid("address","string").required()}),n.default.object({name:n.default.string().valid("salt").required(),type:n.default.string().valid("bytes32","string").required()})).unique().min(1).custom(e=>{const t=["name","version","chainId","verifyingContract","salt"];return e.sort((e,i)=>t.indexOf(e.name)-t.indexOf(i.name))}),t.EIP712MessageValidator=n.default.object({types:n.default.object({EIP712Domain:t.EIP712DomainTypeValidator.required()}).unknown(!0).required(),primaryType:n.default.string().min(1).required(),domain:n.default.object().required(),message:n.default.object().required()})},797:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.messageHash=t.domainHash=void 0;const r=i(381);t.domainHash=e=>r._TypedDataEncoder.hashStruct("EIP712Domain",{EIP712Domain:e.types.EIP712Domain},e.domain);t.messageHash=e=>r._TypedDataEncoder.from((()=>{const t=Object.assign({},e.types);delete t.EIP712Domain;const i=t[e.primaryType];if(!i)throw new Error("No matched primary type: "+e.primaryType);return delete t[e.primaryType],Object.assign({[e.primaryType]:i},t)})()).hash(e.message)},798:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="keyring"},799:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LedgerError=t.AppHRP=t.AppCoinType=void 0,t.AppCoinType={Cosmos:118,Terra:330},t.AppHRP={Cosmos:"cosmos",Terra:"terra"};class r extends Error{constructor(e){super(e),this.name="LedgerError"}}t.LedgerError=r},800:function(e,t,i){"use strict";(function(e){var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KeystoneService=t.TYPE_KEYSTONE_SIGN=t.TYPE_KEYSTONE_GET_PUBKEY=void 0;const s=i(3),o=i(365),a=i(1390),c=i(97),d=i(1435),u=i(838),h=i(100),l=i(189),p=n(i(578)),g=i(9),f=i(1523);var y,v,m;t.TYPE_KEYSTONE_GET_PUBKEY="keystone-get-pubkey",t.TYPE_KEYSTONE_SIGN="keystone-sign",function(e){e.Amino="signAminoTransaction",e.Direct="signDirectTransaction",e.Message="signMessage"}(y||(y={})),function(e){e.Transaction="signTransaction",e.Message="signMessage",e.Data="signTypedData"}(v||(v={})),function(e){e.Amino="signCosmosAmino",e.Direct="signCosmosDirect",e.Message="signArbitrary"}(m||(m={}));t.KeystoneService=class{constructor(e){this.kvStore=e}init(e){this.interactionService=e}getPubkey(e,i){return r(this,void 0,void 0,(function*(){const n=a.useKeystoneCosmosKeyring({readUR:()=>r(this,void 0,void 0,(function*(){const r=yield this.interactionService.waitApprove(e,"/keystone/import-pubkey",t.TYPE_KEYSTONE_GET_PUBKEY,{bip44HDPath:i},{forceOpenWindow:!0,channel:"keystone"});if(r.abort)throw new s.KeplrError("keystone",301,"The process has been canceled.");if(!r.publicKey||!r.publicKey.cbor||!r.publicKey.type)throw new s.KeplrError("keystone",302,"Public key is empty.");return r.publicKey}))});return yield n.readKeyring(),n.getKeyringData()}))}sign(i,n,c,d,u,h,l){return r(this,void 0,void 0,(function*(){let p,g;const f=a.useKeystoneCosmosKeyring({keyringData:u,playUR:e=>r(this,void 0,void 0,(function*(){(()=>{r(this,void 0,void 0,(function*(){try{const r=yield this.interactionService.waitApprove(i,"/keystone/sign",t.TYPE_KEYSTONE_SIGN,{coinType:n,bip44HDPath:c,ur:e,message:h});if(r.abort)throw new s.KeplrError("keystone",301,"The process has been canceled.");if(!r.signature)throw new s.KeplrError("keystone",303,"Signature is empty.");p(r.signature)}catch(e){g(e)}}))})()})),readUR:()=>new Promise((e,t)=>{p=e,g=t})}),v={[o.SignMode.Amino]:y.Amino,[o.SignMode.Direct]:y.Direct,[o.SignMode.Message]:y.Message}[l];return(yield f[v](e.from(d.pubKey).toString("hex"),h,[e.from(d.address).toString("hex")],"Keplr")).signature}))}signEthereum(i,n,o,a,f,y,m,w){return r(this,void 0,void 0,(function*(){let S,b;const k=d.useKeystoneEthereumKeyring({keyringData:y,playUR:e=>r(this,void 0,void 0,(function*(){(()=>{r(this,void 0,void 0,(function*(){try{const r=yield this.interactionService.waitApprove(i,"/keystone/sign",t.TYPE_KEYSTONE_SIGN,{coinType:n,bip44HDPath:a,ur:e,message:m});if(r.abort)throw new s.KeplrError("keystone",301,"The process has been canceled.");if(!r.signature)throw new s.KeplrError("keystone",303,"Signature is empty.");S(r.signature)}catch(e){b(e)}}))})()})),readUR:()=>new Promise((e,t)=>{S=e,b=t})}),_={[c.EthSignType.TRANSACTION]:v.Transaction,[c.EthSignType.MESSAGE]:v.Message,[c.EthSignType.EIP712]:v.Data}[w];let E="";if(w===c.EthSignType.TRANSACTION){const t=JSON.parse(e.from(m).toString()),i=+t.type;if(2===i)E=new u.FeeMarketEIP1559Transaction(t);else if(1===i)E=new u.AccessListEIP2930Transaction(t);else{const e=g.EthermintChainIdHelper.parse(o);E=new u.Transaction(t,{common:p.default.custom({chainId:e.ethChainId})})}}else w===c.EthSignType.MESSAGE?E=e.from(m).toString("hex"):w===c.EthSignType.EIP712&&(E=JSON.parse(e.from(m).toString()));const P=yield k[_](h.computeAddress(l.publicKeyConvert(f.pubKey,!1)),E);if(w===c.EthSignType.TRANSACTION){return P.serialize()}return e.from(P.replace(/^0x/,""),"hex")}))}signEvm(i,n,a,c,d,u,h,l){return r(this,void 0,void 0,(function*(){let p,g;const y=new f.Keyring(Object.assign(Object.assign({},d),{keys:d.keys.map((e,t)=>({hdPath:`44'/${e.coinType}'/${e.bip44HDPath.account}'/${e.bip44HDPath.change}/${e.bip44HDPath.addressIndex}`,index:t,pubKey:e.pubKey}))}));y.onPlayQR(e=>r(this,void 0,void 0,(function*(){(()=>{r(this,void 0,void 0,(function*(){try{const r=yield this.interactionService.waitApprove(i,"/keystone/sign",t.TYPE_KEYSTONE_SIGN,{coinType:n,bip44HDPath:a,ur:e,message:u});if(r.abort)throw new s.KeplrError("keystone",301,"The process has been canceled.");if(!r.signature)throw new s.KeplrError("keystone",303,"Signature is empty.");p(r.signature)}catch(e){g(e)}}))})()}))),y.onReadQR(()=>new Promise((e,t)=>{p=e,g=t}));const v={[o.SignMode.Amino]:m.Amino,[o.SignMode.Direct]:m.Direct,[o.SignMode.Message]:m.Message}[h];return(yield y[v](e.from(c.pubKey).toString("hex"),u,l,e.from(c.address).toString("hex"),"Keplr")).signature}))}}}).call(this,i(2).Buffer)},846:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SecretWasmService=void 0;const n=i(1537),s=i(69),o=i(21),a=i(9),c=i(3),d=i(2);t.SecretWasmService=class{constructor(e){this.kvStore=e,this.debouncerMap=new Map,this.cacheEnigmaUtils=new Map,this.onChainRemoved=()=>{this.cacheEnigmaUtils=new Map}}init(e,t,i){this.chainsService=e,this.keyRingService=t,this.permissionService=i,this.chainsService.addChainRemovedHandler(this.onChainRemoved)}getPubkey(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.chainsService.getChainInfo(t);if("none"===(yield this.keyRingService.getKeyRingType()))throw new c.KeplrError("secret-wasm",130,"Key ring is not initialized");const r=yield this.getSeed(e,i);return this.getEnigmaUtils(i,r).pubkey}))}getTxEncryptionKey(e,t,i){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfo(t);if("none"===(yield this.keyRingService.getKeyRingType()))throw new c.KeplrError("secret-wasm",130,"Key ring is not initialized");const n=yield this.getSeed(e,r);return this.getEnigmaUtils(r,n).getTxEncryptionKey(i)}))}encrypt(e,t,i,n){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfo(t);if("none"===(yield this.keyRingService.getKeyRingType()))throw new c.KeplrError("secret-wasm",130,"Key ring is not initialized");const s=yield this.getSeed(e,r),o=this.getEnigmaUtils(r,s);return yield o.encrypt(i,n)}))}decrypt(e,t,i,n){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfo(t);if("none"===(yield this.keyRingService.getKeyRingType()))throw new c.KeplrError("secret-wasm",130,"Key ring is not initialized");const s=yield this.getSeed(e,r),o=this.getEnigmaUtils(r,s);return yield o.decrypt(i,n)}))}getEnigmaUtils(e,t){const i=`${e.chainId}-${d.Buffer.from(t).toString("hex")}`;if(this.cacheEnigmaUtils.has(i))return this.cacheEnigmaUtils.get(i);const r=new n.EnigmaUtils(e.rest,t);return this.cacheEnigmaUtils.set(i,r),r}getSeed(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.keyRingService.getKey(t.chainId),r=new a.Bech32Address(i.address).toBech32(t.bech32Config.bech32PrefixAccAddr),n=`${e.isInternalMsg}/${t.chainId}/${r}`;this.debouncerMap.has(n)||this.debouncerMap.set(n,o.Debouncer.promise(this.getSeedInner.bind(this)));const s=this.debouncerMap.get(n);return yield s(e,t,r)}))}getSeedInner(e,t,i){return r(this,void 0,void 0,(function*(){const r=`seed-${t.chainId}-${i}`,n=yield this.kvStore.get(r);if(n)return d.Buffer.from(n,"hex");const o=s.Hash.sha256(d.Buffer.from(yield this.keyRingService.sign(e,t.chainId,d.Buffer.from(JSON.stringify({account_number:0,chain_id:t.chainId,fee:[],memo:"Create Keplr Secret encryption key. Only approve requests by Keplr.",msgs:[],sequence:0})))));return yield this.kvStore.set(r,d.Buffer.from(o).toString("hex")),o}))}}},872:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="secret-wasm"},873:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BackgroundTxService=void 0;const s=n(i(89)),o=i(9),a=i(2);class c{constructor(e){this.notification=e}init(e,t){this.chainsService=e,this.permissionService=t}sendTx(e,t,i){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfo(e),n=s.default.create(Object.assign({baseURL:r.rest},r.restConfig));this.notification.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx is pending...",message:"Wait a second"});const d=a.Buffer.isBuffer(t)||t instanceof Uint8Array,u=d?{tx_bytes:a.Buffer.from(t).toString("base64"),mode:(()=>{switch(i){case"async":return"BROADCAST_MODE_ASYNC";case"block":return"BROADCAST_MODE_BLOCK";case"sync":return"BROADCAST_MODE_SYNC";default:return"BROADCAST_MODE_UNSPECIFIED"}})()}:{tx:t,mode:i};try{const e=yield n.post(d?"/cosmos/tx/v1beta1/txs":"/txs",u),t=d?e.data.tx_response:e.data;if(null!=t.code&&0!==t.code)throw new Error(t.raw_log);const i=a.Buffer.from(t.txhash,"hex"),s=new o.TendermintTxTracer(r.rpc,"/websocket");return s.traceTx(i).then(e=>{s.close(),c.processTxResultNotification(this.notification,e)}),i}catch(e){throw console.log(e),c.processTxErrorNotification(this.notification,e),e}}))}static processTxResultNotification(e,t){var i;try{if("commit"===t.mode){if(void 0!==t.checkTx.code&&0!==t.checkTx.code)throw new Error(t.checkTx.log);if(void 0!==t.deliverTx.code&&0!==t.deliverTx.code)throw new Error(t.deliverTx.log)}else if(null!=t.code&&0!==t.code){const e=null!==(i=t.log)&&void 0!==i?i:t.raw_log;throw new Error(e)}e.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx succeeds",message:"Congratulations!"})}catch(t){c.processTxErrorNotification(e,t)}}static processTxErrorNotification(e,t){console.log(t);let i=t.message;const r=/code:\s*(-?\d+),\s*message:\s*(.+),\sdata:\s(.+)/g.exec(t.message);r&&4===r.length&&(i=r[3]);try{const e=JSON.parse(t.message);(null==e?void 0:e.message)&&(i=e.message)}catch(e){}try{const e=JSON.parse(t.message);if(e&&e.length>0)for(const t of e)if(!t.success){const e=JSON.parse(t.log);if(null==e?void 0:e.message){i=e.message;break}}}catch(e){}e.create({iconRelativeUrl:"assets/logo-256.png",title:"Tx failed",message:i})}}t.BackgroundTxService=c},874:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="background-tx"},875:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ChainUpdaterService=void 0;const s=i(21),o=i(9),a=i(272),c=n(i(89));t.ChainUpdaterService=class{constructor(e,t){this.kvStore=e,this.communityChainInfoRepo=t}init(e){this.chainsService=e}replaceChainInfo(e){return r(this,void 0,void 0,(function*(){const t=o.ChainIdHelper.parse(e.chainId).identifier;let i=e;const r=yield this.kvStore.get("updated-chain-info/"+t);r&&(i=Object.assign(Object.assign({},r),{walletUrlForStaking:r.walletUrlForStaking||e.walletUrlForStaking,features:(()=>{var e,t;const n=null!==(e=i.features)&&void 0!==e?e:[];for(const e of null!==(t=r.features)&&void 0!==t?t:[])n.includes(e)||n.push(e);return n})(),beta:e.beta}));const n=yield this.kvStore.get(t);n&&(i=Object.assign(Object.assign({},i),{chainId:n.chainId||i.chainId,features:(()=>{var e;if(!n.features)return i.features;const t=null!==(e=i.features)&&void 0!==e?e:[];for(const e of n.features)t.includes(e)||t.push(e);return t})()})),118!==i.bip44.coinType&&60!==i.bip44.coinType&&(i=Object.assign(Object.assign({},i),{alternativeBIP44s:(()=>{var e;let t=null!==(e=i.alternativeBIP44s)&&void 0!==e?e:[];return t.find(e=>118===e.coinType)||(t=[...t,{coinType:118}]),t})()}));const s=yield this.getChainEndpoints(e.chainId);return Object.assign(Object.assign({},i),{rpc:s.rpc||i.rpc,rest:s.rest||i.rest})}))}tryUpdateChainInfo(e){var t;return r(this,void 0,void 0,(function*(){if((yield this.chainsService.getChainInfo(e)).updateFromRepoDisabled)return!1;try{const i=o.ChainIdHelper.parse(e).identifier;let r=!1;try{let t=(yield c.default.get(`/cosmos/${i}.json`,{baseURL:`https://raw.githubusercontent.com/${this.communityChainInfoRepo.organizationName}/${this.communityChainInfoRepo.repoName}/${this.communityChainInfoRepo.branchName}`})).data;const n=o.ChainIdHelper.parse(t.chainId).identifier;if(i!==n)return console.log(`The chainId is not valid.(${e} -> ${n})`),!1;const d=yield this.kvStore.get("updated-chain-info/"+i);d&&s.sortedJsonByKeyStringify(d)===s.sortedJsonByKeyStringify(t)||(r=!0,t=yield a.validateBasicChainInfoType(t),yield this.kvStore.set("updated-chain-info/"+i,t),this.chainsService.clearCachedChainInfos())}catch(e){console.log(e)}const n=yield this.chainsService.getChainInfo(e);let d=!1;const u=yield this.checkChainIdFromRPC(n.rpc);if(o.ChainIdHelper.parse(u).identifier!==i)throw new Error(`Chain id is different from rpc: (expected: ${e}, actual: ${u})`);if(n.chainId!==u){d=!0;const e=yield this.kvStore.get(i);yield this.kvStore.set(i,Object.assign(Object.assign({},e),{chainId:u}))}const h=yield a.checkChainFeatures(n),l=0!==h.length;if(l){const e=yield this.kvStore.get(i);yield this.kvStore.set(i,Object.assign(Object.assign({},e),{features:[...new Set([...h,...null!==(t=null==e?void 0:e.features)&&void 0!==t?t:[]])]}))}return(d||l)&&this.chainsService.clearCachedChainInfos(),r||d||l}catch(t){console.log("Failed to try to update chain info for "+e,t)}return!1}))}clearUpdatedProperty(e){return r(this,void 0,void 0,(function*(){yield this.kvStore.set(o.ChainIdHelper.parse(e).identifier,null),yield this.kvStore.set("updated-chain-info/"+o.ChainIdHelper.parse(e).identifier,null),this.chainsService.clearCachedChainInfos()}))}setChainEndpoints(e,t,i){return r(this,void 0,void 0,(function*(){return yield this.kvStore.set("chain-info-endpoints/"+o.ChainIdHelper.parse(e).identifier,{rpc:t,rest:i}),this.chainsService.clearCachedChainInfos(),yield this.chainsService.getChainInfos()}))}getChainEndpoints(e){return r(this,void 0,void 0,(function*(){const t=yield this.kvStore.get("chain-info-endpoints/"+o.ChainIdHelper.parse(e).identifier);return t||{rpc:void 0,rest:void 0}}))}resetChainEndpoints(e){return r(this,void 0,void 0,(function*(){return yield this.kvStore.set("chain-info-endpoints/"+o.ChainIdHelper.parse(e).identifier,null),this.chainsService.clearCachedChainInfos(),yield this.chainsService.getChainInfos()}))}checkChainIdFromRPC(e){return r(this,void 0,void 0,(function*(){const t=yield c.default.get("/status",{baseURL:e});return"result"in t.data?t.data.result.node_info.network:t.data.node_info.network}))}}},876:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="chain-updator"},877:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TokensService=void 0;const n=i(3),s=i(272),o=i(9),a=i(365),c=i(2),d=i(441),u=i(879);class h{constructor(e){this.kvStore=e,this.onChainRemoved=e=>{this.clearTokens(e)}}init(e,t,i,r){this.interactionService=e,this.permissionService=t,this.chainsService=i,this.keyRingService=r,this.chainsService.addChainRemovedHandler(this.onChainRemoved)}suggestToken(e,t,i,n){return r(this,void 0,void 0,(function*(){const r=yield this.chainsService.getChainInfo(t),s=(yield this.getTokens(t)).find(e=>"contractAddress"in e&&e.contractAddress===i);if(s)return n?void("type"in s&&"secret20"===s.type&&(yield this.addToken(t,Object.assign(Object.assign({},s),{viewingKey:n})))):void 0;o.Bech32Address.validate(i,r.bech32Config.bech32PrefixAccAddr);const a={chainId:t,contractAddress:i,viewingKey:n},c=yield this.interactionService.waitApprove(e,"/setting/token/add",d.SuggestTokenMsg.type(),a);yield this.addToken(t,c)}))}addToken(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.chainsService.getChainInfo(e);t=yield h.validateCurrency(i,t);const r=yield this.getTokens(e),n="type"in t&&"secret20"===t.type;let s=!1;for(const e of r)if(t.coinMinimalDenom===e.coinMinimalDenom){if(!n)return;s=!0}if(n){const i=yield this.getTokensFromChainAndAccount(e);if(s){const r=i.findIndex(e=>e.coinMinimalDenom===t.coinMinimalDenom);r>=0&&(i[r]=t,yield this.saveTokensToChainAndAccount(e,i))}else i.push(t),yield this.saveTokensToChainAndAccount(e,i)}else{const i=yield this.getTokensFromChain(e);i.push(t),yield this.saveTokensToChain(e,i)}}))}removeToken(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.chainsService.getChainInfo(e);t=yield h.validateCurrency(i,t);const r=yield this.getTokens(e),n="type"in t&&"secret20"===t.type;let s=!1;for(const e of r)if(t.coinMinimalDenom===e.coinMinimalDenom){s=!0;break}if(s)if(n){const i=(yield this.getTokensFromChainAndAccount(e)).filter(e=>e.coinMinimalDenom!==t.coinMinimalDenom);yield this.saveTokensToChainAndAccount(e,i)}else{const i=(yield this.getTokensFromChain(e)).filter(e=>e.coinMinimalDenom!==t.coinMinimalDenom);yield this.saveTokensToChain(e,i)}}))}getTokens(e){var t,i;return r(this,void 0,void 0,(function*(){const r=o.ChainIdHelper.parse(e),n=null!==(t=yield this.kvStore.get(r.identifier))&&void 0!==t?t:[];let s=[];if(this.keyRingService.keyRingStatus===a.KeyRingStatus.UNLOCKED){const t=yield this.keyRingService.getKey(e);s=null!==(i=yield this.kvStore.get(`${r.identifier}-${c.Buffer.from(t.address).toString("hex")}`))&&void 0!==i?i:[]}return n.concat(s)}))}clearTokens(e){return r(this,void 0,void 0,(function*(){const t=o.ChainIdHelper.parse(e);yield this.kvStore.set(t.identifier,null);const i=yield this.getTokensToAccountReverse(e);for(const e of i)yield this.kvStore.set(`${t.identifier}-${e}`,null);yield this.setTokensToAccountReverse(e,[])}))}getTokensFromChain(e){var t;return r(this,void 0,void 0,(function*(){const i=o.ChainIdHelper.parse(e);return null!==(t=yield this.kvStore.get(i.identifier))&&void 0!==t?t:[]}))}saveTokensToChain(e,t){return r(this,void 0,void 0,(function*(){const i=o.ChainIdHelper.parse(e);yield this.kvStore.set(i.identifier,t)}))}getTokensFromChainAndAccount(e){var t;return r(this,void 0,void 0,(function*(){const i=o.ChainIdHelper.parse(e),r=yield this.keyRingService.getKey(e);return null!==(t=yield this.kvStore.get(`${i.identifier}-${c.Buffer.from(r.address).toString("hex")}`))&&void 0!==t?t:[]}))}saveTokensToChainAndAccount(e,t){return r(this,void 0,void 0,(function*(){const i=o.ChainIdHelper.parse(e),r=yield this.keyRingService.getKey(e),n=c.Buffer.from(r.address).toString("hex");yield this.kvStore.set(`${i.identifier}-${n}`,t),yield this.insertTokensToAccountReverse(e,n)}))}getTokensToAccountReverse(e){var t;return r(this,void 0,void 0,(function*(){const i=o.ChainIdHelper.parse(e);return null!==(t=yield this.kvStore.get(i.identifier+"-addresses"))&&void 0!==t?t:[]}))}setTokensToAccountReverse(e,t){return r(this,void 0,void 0,(function*(){const i=o.ChainIdHelper.parse(e);yield this.kvStore.set(i.identifier+"-addresses",t)}))}insertTokensToAccountReverse(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.getTokensToAccountReverse(e);i.indexOf(t)<0&&(i.push(t),yield this.setTokensToAccountReverse(e,i))}))}getSecret20ViewingKey(e,t){return r(this,void 0,void 0,(function*(){const i=yield this.getTokens(e);for(const e of i)if("type"in e&&"secret20"===e.type&&e.contractAddress===t)return e.viewingKey;throw new n.KeplrError("tokens",111,"There is no matched secret20")}))}checkOrGrantSecret20ViewingKeyPermission(e,t,i,n){return r(this,void 0,void 0,(function*(){yield this.getSecret20ViewingKey(t,i);const r=u.getSecret20ViewingKeyPermissionType(i);this.permissionService.hasPermisson(t,r,n)||(yield this.permissionService.grantPermission(e,"/access/viewing-key",[t],r,[n])),this.permissionService.checkPermission(e,t,r,n)}))}static validateCurrency(e,t){return r(this,void 0,void 0,(function*(){if("type"in t)switch(t.type){case"cw20":t=yield h.validateCW20Currency(e,t);break;case"secret20":t=yield h.validateSecret20Currency(e,t);break;default:throw new n.KeplrError("tokens",110,"Unknown type of currency")}else t=yield s.CurrencySchema.validateAsync(t);return t}))}static validateCW20Currency(e,t){return r(this,void 0,void 0,(function*(){return t=yield s.CW20CurrencySchema.validateAsync(t),o.Bech32Address.validate(t.contractAddress,e.bech32Config.bech32PrefixAccAddr),t}))}static validateSecret20Currency(e,t){return r(this,void 0,void 0,(function*(){return t=yield s.Secret20CurrencySchema.validateAsync(t),o.Bech32Address.validate(t.contractAddress,e.bech32Config.bech32PrefixAccAddr),t}))}}t.TokensService=h},878:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="tokens"},879:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitSecret20ViewingKeyPermissionType=t.isSecret20ViewingKeyPermissionType=t.getSecret20ViewingKeyPermissionType=void 0,t.getSecret20ViewingKeyPermissionType=function(e){return"viewing-key/"+e},t.isSecret20ViewingKeyPermissionType=function(e){return e.startsWith("viewing-key/")},t.splitSecret20ViewingKeyPermissionType=function(e){return e.replace("viewing-key/","")}},880:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.InteractionService=void 0;const n=i(3),s=i(881);t.InteractionService=class{constructor(e,t){this.eventMsgRequester=e,this.rng=t,this.waitingMap=new Map,this.resolverMap=new Map}init(){}dispatchEvent(e,t,i){if(!t)throw new n.KeplrError("interaction",101,"Type should not be empty");const r=new s.PushEventDataMsg({type:t,data:i});this.eventMsgRequester.sendMessage(e,r).catch(t=>{console.log(`Failed to send the event to ${e}: ${t.message}`)})}waitApprove(e,t,i,o,a){return r(this,void 0,void 0,(function*(){if(!i)throw new n.KeplrError("interaction",101,"Type should not be empty");const r=yield this.addDataToMap(i,e.isInternalMsg,o),c=new s.PushInteractionDataMsg(r);return yield this.wait(c.data.id,()=>{e.requestInteraction(t,c,a)})}))}wait(e,t){return r(this,void 0,void 0,(function*(){if(this.resolverMap.has(e))throw new n.KeplrError("interaction",100,"Id is aleady in use");return new Promise((i,r)=>{this.resolverMap.set(e,{onApprove:i,onReject:r}),t()})}))}approve(e,t){this.resolverMap.has(e)&&(this.resolverMap.get(e).onApprove(t),this.resolverMap.delete(e)),this.removeDataFromMap(e)}reject(e){this.resolverMap.has(e)&&(this.resolverMap.get(e).onReject(new Error("Request rejected")),this.resolverMap.delete(e)),this.removeDataFromMap(e)}addDataToMap(e,t,i){return r(this,void 0,void 0,(function*(){const r=new Uint8Array(12),s=Array.from(yield this.rng(r)).map(e=>{let t=e.toString(16);return 1===t.length&&(t="0"+t),t}).join(""),o={id:s,type:e,isInternal:t,data:i};if(this.waitingMap.has(s))throw new n.KeplrError("interaction",100,"Id is aleady in use");return this.waitingMap.set(s,o),o}))}removeDataFromMap(e){this.waitingMap.delete(e)}}},881:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1634),t),n(i(604),t),n(i(1635),t),n(i(1636),t)},882:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="interaction-foreground"},883:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="interaction"},884:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PhishingListService=void 0;const s=n(i(89)),o=i(885);class a{constructor(e,t){this.opts=e,this.handler=t,this._hasInited=!1,this._hasStopped=!1}get hasInited(){return this._hasInited}start(){this.fetch()}stop(){null!=this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this._hasStopped=!0}fetch(){return r(this,void 0,void 0,(function*(){if(null!=this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0),this._hasStopped)return;let e=!1;try{const e=yield s.default.get(this.opts.url);this.handler(e),this._hasInited=!0}catch(t){e=!0,console.log(t)}this._hasStopped||(this.timeoutId=setTimeout(()=>{this.fetch()},e?this.opts.retryIntervalMs:this.opts.fetchingIntervalMs))}))}}t.PhishingListService=class{constructor(e){this.opts=e,this.urlMap=new Map,this.allowedUrlMap=new Map,this.twitterMap=new Map,this.urlFetcher=new a(Object.assign(Object.assign({},this.opts),{url:this.opts.blockListUrl}),e=>{const t=e.data.split(/(\r?\n)|,|;|\s|\t/).filter(e=>null!=e).map(e=>e.trim()).filter(e=>e.length>0),i=new Map;for(const e of t)try{i.set(o.parseDomainUntilSecondLevel(e),!0)}catch(e){console.log(e)}this.urlMap=i}),this.opts.twitterListUrl&&(this.twitterFetcher=new a(Object.assign(Object.assign({},this.opts),{url:this.opts.twitterListUrl}),e=>{const t=e.data.split(/(\r?\n)|,|;|\s|\t/).filter(e=>null!=e).map(e=>e.trim()).filter(e=>e.length>0),i=new Map;for(const e of t)i.set(e.replace("@","").toLowerCase(),!0);this.twitterMap=i}))}init(){this.urlFetcher.start(),this.twitterFetcher&&this.twitterFetcher.start()}get hasInited(){return this.urlFetcher.hasInited&&(!this.twitterFetcher||this.twitterFetcher.hasInited)}stop(){this.urlFetcher.stop(),this.twitterFetcher&&this.twitterFetcher.stop()}checkURLIsPhishing(e){const t=o.parseDomainUntilSecondLevel(new URL(e).origin);if(!0===this.urlMap.get(t)){const e=this.allowedUrlMap.get(t);return!(e&&e+this.opts.allowTimeoutMs>=(new Date).getTime())}return!1}allowUrlTemp(e){const t=new URL(e);this.allowedUrlMap.set(o.parseDomainUntilSecondLevel(t.origin),(new Date).getTime())}checkBadTwitterId(e){return!0===this.twitterMap.get(e.replace("@","").toLowerCase())}}},885:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDomainUntilSecondLevel=void 0,t.parseDomainUntilSecondLevel=function(e){let t=e;t.match(/^[a-zA-Z0-9-]+:\/\/.+$/)&&(t=t.replace(/^[a-zA-Z0-9-]+:\/\//,""));const i=t.indexOf("/");i>=0&&(t=t.slice(0,i));const r=t.indexOf("?");r>=0&&(t=t.slice(0,r));const n=t.split(".").map(e=>e.trim()).filter(e=>e.length>0);if(n.length<2)throw new Error("Invalid domain: "+e);const s=n[n.length-1].indexOf(":");return s>=0&&(n[n.length-1]=n[n.length-1].slice(0,s)),n[n.length-2]+"."+n[n.length-1]}},886:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="phishing-list"},887:function(e,t,i){"use strict";var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoLockAccountService=void 0;const n=i(365);t.AutoLockAccountService=class{constructor(e,t={monitoringInterval:1e4}){this.kvStore=e,this.opts=t,this.autoLockDuration=0,this.appStateCheckTimer=null,this.autoLockTimer=null}init(e){return r(this,void 0,void 0,(function*(){this.keyringService=e,browser.idle.onStateChanged.addListener(e=>{this.stateChangedHandler(e)}),yield this.loadDuration()}))}stateChangedHandler(e){this.autoLockDuration>0&&"locked"===e&&(this.stopAppStateCheckTimer(),this.stopAutoLockTimer(),this.lock())}startAppStateCheckTimer(){this.stopAppStateCheckTimer(),this.autoLockDuration>0&&this.keyRingIsUnlocked&&(this.appStateCheckTimer=setTimeout(()=>{this.checkAppIsActive()?(this.stopAutoLockTimer(),this.startAppStateCheckTimer()):(this.keyRingIsUnlocked&&this.startAutoLockTimer(),this.stopAppStateCheckTimer())},this.opts.monitoringInterval))}stopAppStateCheckTimer(){null!=this.appStateCheckTimer&&(clearTimeout(this.appStateCheckTimer),this.appStateCheckTimer=null)}checkAppIsActive(){const e=browser.extension.getBackgroundPage(),t=browser.extension.getViews();if(e){for(const i of t)if(e.location.href!==i.location.href)return!0}else if(t.length>0)return!0;return!1}startAutoLockTimer(){if(!this.keyRingIsUnlocked)throw new Error("Keyring is not unlocked");this.autoLockDuration<=0||(this.autoLockTimer=setTimeout(()=>{this.stopAppStateCheckTimer(),this.stopAutoLockTimer(),this.lock()},this.autoLockDuration))}stopAutoLockTimer(){null!=this.autoLockTimer&&(clearTimeout(this.autoLockTimer),this.autoLockTimer=null)}lock(){if(this.keyRingIsUnlocked){this.keyringService.lock();const e=browser.extension.getBackgroundPage(),t=browser.extension.getViews();for(const i of t)e&&e.location.href===i.location.href||i.close()}}get keyRingIsUnlocked(){if(null==this.keyringService)throw new Error("Keyring service is null");return this.keyringService.keyRingStatus===n.KeyRingStatus.UNLOCKED}getAutoLockDuration(){return this.autoLockDuration}setDuration(e){return this.autoLockDuration=e,e<=0&&(this.stopAppStateCheckTimer(),this.stopAutoLockTimer()),this.kvStore.set("autoLockDuration",e)}loadDuration(){return r(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("autoLockDuration");this.autoLockDuration=null==e?0:e}))}}},888:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ROUTE=void 0,t.ROUTE="auto-lock-account"},889:function(e,t,i){"use strict";(function(e){var r=this&&this.__awaiter||function(e,t,i,r){return new(i||(i=Promise))((function(n,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AnalyticsService=void 0;const s=n(i(89)),o=i(608);t.AnalyticsService=class{constructor(e,t,i){this.kvStore=e,this.rng=t,this.privilegedOrigins=i,this.analyticsId=""}init(){return r(this,void 0,void 0,(function*(){const e=yield this.kvStore.get("analyticsId");if(e)return void(this.analyticsId=e);const t=new Uint8Array(20),i=Array.from(yield this.rng(t)).map(e=>{let t=e.toString(16);return 1===t.length&&(t="0"+t),t}).join("");this.analyticsId=i,yield this.kvStore.set("analyticsId",i)}))}getAnalyticsIdOnlyIfPrivileged(e,t){return r(this,void 0,void 0,(function*(){if(!e.isInternalMsg&&!this.privilegedOrigins.includes(t))throw new Error("Rejected");return this.analyticsId}))}logEvent(t,i){return r(this,void 0,void 0,(function*(){if(!o.KEPLR_EXT_ANALYTICS_API_URL||!o.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN)return;const r=s.default.create({baseURL:o.KEPLR_EXT_ANALYTICS_API_URL}),n=e.from(JSON.stringify(Object.assign(Object.assign({},i),{event:t,analyticsId:this.analyticsId}))).toString("base64");yield r.get("/log?msg="+n,{headers:{Authorization:o.KEPLR_EXT_ANALYTICS_API_AUTH_TOKEN}})}))}logEventIgnoreError(e,t){this.logEvent(e,t).catch(e=>console.log(e))}}}).call(this,i(2).Buffer)},9:function(e,t,i){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,i,r){void 0===r&&(r=i),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,r){void 0===r&&(r=i),e[r]=t[i]}),n=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(i(1283),t),n(i(750),t),n(i(1287),t),n(i(1289),t),n(i(1291),t),n(i(768),t),n(i(769),t)}}]);